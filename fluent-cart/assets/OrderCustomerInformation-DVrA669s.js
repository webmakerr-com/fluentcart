var Fe=Object.defineProperty;var We=(s,e,l)=>e in s?Fe(s,e,{enumerable:!0,configurable:!0,writable:!0,value:l}):s[e]=l;var ce=(s,e,l)=>We(s,typeof e!="symbol"?e+"":e,l);import{i as S,m as K,p as le,j as pe,a as M,b as N,o as n,w as i,f as a,d as o,n as J,u as A,t as r,c,e as g,F,h as H,g as w,r as He,K as Ee,l as xe,I as Ke,x as qe,D as ze}from"./vue.esm-bundler-DZdE0M9V.js";import{_ as _e}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{B as Ze,I as fe}from"./Badge-CAEsoWyQ.js";import{_ as Qe}from"./Empty-aPQNCX5s.js";import{f as Ye}from"./common-D35bkMcN.js";import{b as Q,c as ve,a as re,C as Ge}from"./CopyToClipboard-BjLMcgNd.js";import{_ as j}from"./DynamicIcon-D-LZibaK.js";import{t as f,a as Se}from"./Translator-Bios5QX5.js";import{_ as Je,C as Te,c as Oe,d as Ue}from"./RouteCell-DrtjJJDU.js";import{A as Ne}from"./Arr-MwYQQ3qa.js";import{A as Xe}from"./Asset-DDfERlE5.js";import{n as O}from"./Notify-CV-A2uNH.js";import{R as q}from"./Rest-DEQMhckH.js";import{L as Pe,u as et}from"./NotFound-tC_jj0zn.js";import{e as Be}from"./index-DwF99AZu.js";import{f as tt}from"./productService-BVWCmR6j.js";const st={class:"fct-customer-edit-modal"},lt={class:"fct-compact-form"},at={class:"form-heading"},ot={class:"fct-compact-form fct-customer-address-section"},dt={key:0,class:"mt-5"},nt={key:1,class:"form-error-wrap"},rt={class:"dialog-footer"},it={__name:"NewCustomerModal",props:{customer_id:{type:[String,Number],default:null},customer:{type:Object,default:()=>({})},customerModalInfos:{type:Object,default:()=>({})}},emits:["close-modal","select-new-customer","update:customerModal"],setup(s,{emit:e}){const l=e,C=s,m=S({}),d=S(!1),v=S({}),$=()=>{l("close-modal")},P=()=>{d.value=!0,m.value.wp_user=C.customerModalInfos.manageWpUser,q.post("customers/",{...m.value}).then(p=>{l("select-new-customer",p.data),l("update:customerModal",!1),O.success(p.message),v.value={}}).catch(p=>{var h;p.status_code=="422"?(O.validationErrors(p),v.value=p.data):O.error((h=p.data)==null?void 0:h.message)}).finally(()=>{d.value=!1})},L=()=>{d.value=!0,m.value.wp_user=C.customerModalInfos.manageWpUser,q.put("customers/"+C.customer_id,{...m.value}).then(p=>{l("select-new-customer",p.data),l("update:customerModal",!1),O.success(p.message),v.value={}}).catch(p=>{var h;p.status_code=="422"?(O.validationErrors(p),v.value=p.data):O.error((h=p.data)==null?void 0:h.message)}).finally(()=>{d.value=!1})},U=K(()=>C.customerModalInfos.action==="create"?f("Create as wordpress user"):f("Update wordpress user profile")),V=K(()=>d.value?C.customerModalInfos.action==="edit"?f("Updating"):f("Creating"):C.customerModalInfos.action==="edit"?f("Update Customer"):f("Create Customer")),B=K(()=>{const p={};for(const h in v.value){const x=v.value[h];p[h]=Array.isArray(x)?x:Object.values(x)}return p});return le(()=>C.customer,p=>{m.value={id:p.id,email:p.email,full_name:p.full_name,state:p.state,city:p.city,country:p.country,postcode:p.postcode,country_name:p.country_name,contact_id:p.contact_id,user_id:p.user_id,wp_user:p.wp_user}},{deep:!0}),pe(()=>{m.value={id:C.customer.id,email:C.customer.email,full_name:C.customer.full_name,state:C.customer.state,city:C.customer.city,country:C.customer.country,postcode:C.customer.postcode,country_name:C.customer.country_name,contact_id:C.customer.contact_id,user_id:C.customer.user_id,wp_user:C.customer.wp_user}}),(p,h)=>{const x=M("el-checkbox"),u=M("el-button"),k=M("el-dialog");return n(),N(k,{modelValue:s.customerModalInfos.showModal,"onUpdate:modelValue":h[6]||(h[6]=I=>s.customerModalInfos.showModal=I),title:s.customerModalInfos.title,onClose:h[7]||(h[7]=()=>{v.value={}})},{default:i(()=>[a("div",st,[a("div",lt,[o(Q,{label:A(f)("Full Name *"),modelValue:m.value.full_name,"onUpdate:modelValue":h[0]||(h[0]=I=>m.value.full_name=I),class:J(v.value.full_name?"is-error":"")},null,8,["label","modelValue","class"]),o(Q,{type:"email",label:A(f)("Email *"),modelValue:m.value.email,"onUpdate:modelValue":h[1]||(h[1]=I=>m.value.email=I),disabled:s.customer.user_id&&s.customer.user_id!=0,class:J(v.value.email?"is-error":"")},null,8,["label","modelValue","disabled","class"])]),a("h4",at,r(A(f)("Address")),1),a("div",ot,[o(ve,{modelValue:m.value,"onUpdate:modelValue":h[2]||(h[2]=I=>m.value=I),validationErrors:v.value},null,8,["modelValue","validationErrors"]),s.customerModalInfos.action==="create"?(n(),c("div",dt,[o(x,{"true-value":"yes","false-value":"no",modelValue:s.customerModalInfos.manageWpUser,"onUpdate:modelValue":h[3]||(h[3]=I=>s.customerModalInfos.manageWpUser=I)},{default:i(()=>[o(Pe,{title:U.value,content:A(f)("We will create a new user for this customer. If a user with the same email already exists, we will associate the customer with that existing user.")},null,8,["title","content"])]),_:1},8,["modelValue"])])):g("",!0),Object.keys(v.value).length?(n(),c("div",nt,[(n(!0),c(F,null,H(B.value,(I,T)=>(n(),c("p",{key:T},[(n(!0),c(F,null,H(I,b=>(n(),c("span",{key:b},r(b),1))),128))]))),128))])):g("",!0)]),a("div",rt,[o(u,{onClick:$},{default:i(()=>[w(r(A(f)("Cancel")),1)]),_:1}),s.customerModalInfos.action==="edit"?(n(),N(u,{key:0,loading:d.value,type:"primary",onClick:h[4]||(h[4]=I=>L())},{default:i(()=>[w(r(V.value),1)]),_:1},8,["loading"])):(n(),N(u,{key:1,type:"primary",loading:d.value,onClick:h[5]||(h[5]=I=>P())},{default:i(()=>[w(r(V.value),1)]),_:1},8,["loading"]))])])]),_:1},8,["modelValue","title"])}}};class ut{constructor(){ce(this,"allPermissions",[]);this.allPermissions=Ne.get(window,"fluentCartAdminApp.app_config.permissions",[])}isSuperAdmin(){return this.allPermissions.includes("is_super_admin")}has(e){return this.isSuperAdmin()?!0:this.allPermissions.includes(e)}hasAny(e){return this.isSuperAdmin()?!0:Array.isArray(e)&&e.some(l=>this.allPermissions.includes(l))}hasAll(e){return this.isSuperAdmin()?!0:Array.isArray(e)&&e.every(l=>this.allPermissions.includes(l))}resolve({permission:e,permissionType:l}){const C=l==="all"?"all":"any",m=Array.isArray(e)?e:typeof e=="string"?e.split(",").map(d=>d.trim()):[];return C==="all"?this.hasAll(m):this.hasAny(m)}}const ct=new ut,De={__name:"UserCan",props:{permission:{type:[String,Array],required:!0},permissionType:{type:String,default:"any"}},setup(s){const e=s,l=K(()=>ct.resolve({permission:e.permission,permissionType:e.permissionType}));return(C,m)=>l.value?He(C.$slots,"default",{key:0}):g("",!0)}},mt={name:"OrderUpDownIndicator",props:{order:{type:Object,required:!0}},data(){var s,e;return{upgradeToId:((s=this.order.config)==null?void 0:s.upgraded_to)||null,upgradeFromId:((e=this.order.config)==null?void 0:e.upgraded_from)||null}}},pt={key:0,class:"ml-2"};function _t(s,e,l,C,m,d){const v=M("el-icon"),$=M("el-button"),P=M("router-link"),L=M("el-tooltip");return m.upgradeFromId||m.upgradeToId?(n(),c("span",pt,[m.upgradeFromId?(n(),N(L,{key:0,trigger:"click"},{content:i(()=>[w(r(s.$t("This order has been upgraded from"))+" ",1),o(P,{to:{name:"view_order",params:{order_id:m.upgradeFromId}}},{default:i(()=>[a("strong",null,"#"+r(m.upgradeFromId),1)]),_:1},8,["to"])]),default:i(()=>[o($,{text:""},{default:i(()=>[o(v,null,{default:i(()=>e[0]||(e[0]=[a("svg",{viewBox:"0 0 24 24",width:"24",height:"24",color:"currentColor",fill:"none"},[a("defs"),a("path",{fill:"currentColor",d:"M11.943,1.75 L12.057,1.75 C14.248,1.75 15.969,1.75 17.312,1.931 C18.689,2.116 19.781,2.503 20.639,3.361 C21.497,4.219 21.884,5.311 22.069,6.688 C22.25,8.031 22.25,9.752 22.25,11.943 L22.25,12.057 C22.25,14.248 22.25,15.969 22.069,17.312 C21.884,18.689 21.497,19.781 20.639,20.639 C19.781,21.497 18.689,21.884 17.312,22.069 C15.969,22.25 14.248,22.25 12.057,22.25 L11.943,22.25 C9.752,22.25 8.031,22.25 6.688,22.069 C5.311,21.884 4.219,21.497 3.361,20.639 C2.503,19.781 2.116,18.689 1.931,17.312 C1.75,15.969 1.75,14.248 1.75,12.057 L1.75,11.943 C1.75,9.752 1.75,8.031 1.931,6.688 C2.116,5.311 2.503,4.219 3.361,3.361 C4.219,2.503 5.311,2.116 6.688,1.931 C8.031,1.75 9.752,1.75 11.943,1.75 L11.943,1.75 Z M4.422,4.422 C3.889,4.955 3.58,5.678 3.417,6.888 C3.252,8.12 3.25,9.74 3.25,12 C3.25,14.26 3.252,15.88 3.417,17.112 C3.58,18.322 3.889,19.045 4.422,19.578 C4.955,20.111 5.678,20.42 6.888,20.583 C8.12,20.748 9.74,20.75 12,20.75 C14.26,20.75 15.88,20.748 17.112,20.583 C18.322,20.42 19.045,20.111 19.578,19.578 C20.111,19.045 20.42,18.322 20.583,17.112 C20.748,15.88 20.75,14.26 20.75,12 C20.75,9.74 20.748,8.12 20.583,6.888 C20.42,5.678 20.111,4.955 19.578,4.422 C19.045,3.889 18.322,3.58 17.112,3.417 C15.88,3.252 14.26,3.25 12,3.25 C9.74,3.25 8.12,3.252 6.888,3.417 C5.678,3.58 4.955,3.889 4.422,4.422 Z M10.038,11.023 C9.749,11.32 9.274,11.326 8.977,11.038 C8.68,10.749 8.673,10.274 8.962,9.977 C9.051,9.886 9.197,9.704 9.41,9.433 L9.457,9.373 C9.647,9.131 9.87,8.847 10.099,8.576 C10.346,8.285 10.621,7.983 10.897,7.749 C11.035,7.631 11.19,7.515 11.358,7.425 C11.519,7.339 11.742,7.25 12,7.25 C12.258,7.25 12.481,7.339 12.642,7.425 C12.81,7.515 12.965,7.631 13.103,7.749 C13.379,7.983 13.654,8.285 13.901,8.576 C14.13,8.847 14.353,9.131 14.543,9.373 L14.543,9.373 L14.59,9.433 C14.804,9.704 14.949,9.886 15.038,9.977 C15.326,10.274 15.32,10.749 15.023,11.038 C14.726,11.326 14.251,11.32 13.962,11.023 C13.805,10.861 13.603,10.604 13.411,10.359 L13.366,10.302 C13.173,10.057 12.967,9.794 12.756,9.545 L12.75,9.538 L12.75,16 C12.75,16.414 12.414,16.75 12,16.75 C11.586,16.75 11.25,16.414 11.25,16 L11.25,9.538 L11.244,9.545 C11.033,9.794 10.827,10.057 10.634,10.302 L10.634,10.302 L10.589,10.359 C10.397,10.604 10.195,10.861 10.038,11.023 Z"})],-1)])),_:1,__:[0]})]),_:1})]),_:1})):g("",!0),m.upgradeToId?(n(),N(L,{key:1,trigger:"click"},{content:i(()=>[w(r(s.$t("This order has been upgraded to"))+" ",1),o(P,{to:{name:"view_order",params:{order_id:m.upgradeToId}}},{default:i(()=>[a("strong",null,"#"+r(m.upgradeToId),1)]),_:1},8,["to"])]),default:i(()=>[o($,{text:""},{default:i(()=>[o(v,null,{default:i(()=>e[1]||(e[1]=[a("svg",{viewBox:"0 0 24 24",width:"24",height:"24",color:"currentColor",fill:"none"},[a("defs"),a("path",{fill:"currentColor",d:"M3.367,20.63 C1.756,19.02 1.756,16.672 1.756,11.995 L1.756,11.995 C1.756,7.317 1.756,4.97 3.367,3.359 C4.976,1.75 7.324,1.75 12.002,1.75 C16.68,1.75 19.026,1.75 20.637,3.359 C22.247,4.97 22.247,7.318 22.247,11.996 C22.247,16.674 22.247,19.022 20.637,20.631 C19.026,22.242 16.678,22.242 12,22.242 L12.003,22.241 C7.326,22.241 4.976,22.241 3.367,20.63 Z M4.427,4.418 C3.256,5.59 3.256,7.73 3.256,11.994 L3.256,11.995 C3.256,16.259 3.256,18.399 4.427,19.569 C5.597,20.741 7.738,20.741 12.003,20.741 C16.269,20.741 18.408,20.741 19.58,19.569 C20.75,18.399 20.75,16.259 20.75,11.993 L20.75,11.993 C20.75,7.727 20.75,5.588 19.58,4.417 C18.408,3.247 16.268,3.247 12.005,3.247 L12.003,3.248 C7.739,3.248 5.599,3.248 4.427,4.418 Z M12.024,8.951 C12.121,9.047 12.306,9.198 12.578,9.415 L12.654,9.476 L12.654,9.476 C12.894,9.667 13.172,9.888 13.437,10.117 C13.727,10.367 14.029,10.648 14.262,10.932 C14.432,11.139 14.661,11.456 14.726,11.834 C14.729,11.85 14.732,11.866 14.734,11.883 C14.741,11.94 14.745,11.999 14.745,12.059 C14.744,12.083 14.743,12.106 14.74,12.13 C14.693,12.568 14.41,12.933 14.199,13.168 C13.96,13.435 13.661,13.696 13.375,13.93 C13.152,14.112 12.918,14.292 12.71,14.452 C12.651,14.497 12.594,14.541 12.541,14.582 C12.277,14.786 12.109,14.923 12.027,15.007 C11.739,15.305 11.264,15.312 10.967,15.024 C10.669,14.735 10.662,14.26 10.95,13.963 C11.121,13.787 11.382,13.582 11.623,13.396 C11.684,13.349 11.745,13.302 11.807,13.254 C12.012,13.097 12.222,12.935 12.427,12.768 L12.483,12.722 L6.995,12.715 C6.581,12.715 6.246,12.379 6.246,11.964 C6.247,11.55 6.583,11.215 6.997,11.215 L12.422,11.222 C12.191,11.024 11.949,10.832 11.718,10.648 L11.718,10.648 L11.643,10.588 C11.396,10.391 11.134,10.181 10.965,10.012 C10.672,9.72 10.671,9.245 10.964,8.952 C11.257,8.659 11.731,8.658 12.024,8.951 Z M17.754,8.001 L17.745,15.993 C17.744,16.407 17.408,16.743 16.994,16.742 C16.58,16.742 16.244,16.405 16.245,15.991 L16.254,7.999 C16.255,7.585 16.591,7.25 17.005,7.25 C17.419,7.25 17.755,7.587 17.754,8.001 Z"})],-1)])),_:1,__:[1]})]),_:1})]),_:1})):g("",!0)])):g("",!0)}const aa=_e(mt,[["render",_t]]),ie=class ie{static emptyImage(e=!1){return ie.assetUrl()+(e?"images/empty-image-dark.svg":"images/empty-image.svg")}};ce(ie,"assetUrl",()=>Xe.url());let me=ie;const ft={components:{DynamicIcon:j},props:{product:{type:Object},hideProductId:{type:Boolean,default:!1},hideViewIcon:{type:Boolean,default:!1},hideImage:{type:Boolean,default:!1}},data(){return{}},methods:{translate:f,getImage(s,e=!1){return Ne.get(s,"featured_media.url")??me.emptyImage(e)}}},vt={class:"fct-product-info-card w-full"},ht={key:0,class:"fct-product-info-media"},gt=["src","alt"],yt=["src","alt"],bt={class:"fct-product-info-details"},Ct={class:"fct-product-info-name"},At={class:"product-name"},wt={class:"product-name-inner"},kt=["href"],$t={key:0,class:"product-id"},Mt={key:1,class:"product-sub-name"};function Lt(s,e,l,C,m,d){var $,P,L,U,V,B,p,h,x;const v=M("DynamicIcon");return n(),c("div",vt,[l.hideImage?g("",!0):(n(),c("div",ht,[a("span",null,[a("img",{class:"block dark:hidden",src:d.getImage(($=l.product)==null?void 0:$.detail),alt:(P=l.product)==null?void 0:P.post_title},null,8,gt),a("img",{class:"hidden dark:block",src:d.getImage((L=l.product)==null?void 0:L.detail,!0),alt:(U=l.product)==null?void 0:U.post_title},null,8,yt)])])),a("div",bt,[a("div",Ct,[a("span",At,[a("span",wt,r(((V=l.product)==null?void 0:V.post_title)||d.translate("No Name")),1),l.hideViewIcon?g("",!0):(n(),c("a",{key:0,class:"view-link right-1",target:"_blank",href:(B=l.product)==null?void 0:B.view_url,onClick:e[0]||(e[0]=Ee(()=>{},["stop"]))},[o(v,{class:"w-5 h-5",name:"Eye"})],8,kt))]),l.hideProductId?g("",!0):(n(),c("span",$t," #"+r((p=l.product)==null?void 0:p.ID),1)),(h=l.product)!=null&&h.variation_title?(n(),c("span",Mt," – "+r((x=l.product)==null?void 0:x.variation_title),1)):g("",!0)])])])}const It=_e(ft,[["render",Lt]]),Vt={name:"LicenseTable",components:{ProductInfo:It,UserCan:De,RouteCell:Je,DynamicIcon:j,IconButton:fe,CopyToClipboard:re,Empty:Qe,Badge:Ze},props:{licenses:{type:Array,required:!0},columns:{type:Array,default(){return["product","order_id","customer","date"]}}},computed:{Clipboard(){return Ge},formattedLicense(){return this.licenses.map(s=>{var e;return{...s,product:{...s.product,variation_title:((e=s.product_variant)==null?void 0:e.variation_title)||"n/a"}}})}},methods:{translate:f,formatDate:Ye,translateNumber:Se,getProductName(s){var e,l;return(e=s==null?void 0:s.product)!=null&&e.post_title?(l=s==null?void 0:s.product)==null?void 0:l.post_title:"n/a"},getProductVariationName(s){var e,l;return(e=s==null?void 0:s.product_variant)!=null&&e.variation_title?(l=s==null?void 0:s.product_variant)==null?void 0:l.variation_title:"n/a"}}},Et={class:"fct_licenses_table hide-on-mobile"},xt={class:"fct-license-key-wrap flex flex-col"},St={class:"fct-license-key max-w-full pr-1"},Tt={class:"fct-license-key-inner pr-2"},Ot={key:0},Ut={key:1},Nt={class:"fct_licenses_table_mobile"},Pt={class:"fct-table-mobile-wrap"},Bt=["onClick"],Dt={class:"fct-table-mobile-header-left"},jt={class:"fct-table-status-col"},Rt={class:"fct-table-activations-col"},Ft={class:"fct-table-mobile-body"},Wt=["onClick"],Ht={class:"fct-license-key-wrap has-bg"},Kt={class:"fct-license-key"},qt={class:"fct-license-key-inner pr-2"};function zt(s,e,l,C,m,d){const v=M("Badge"),$=M("router-link"),P=M("DynamicIcon"),L=M("el-tooltip"),U=M("el-table-column"),V=M("ProductInfo"),B=M("RouteCell"),p=M("Empty"),h=M("el-table"),x=M("UserCan");return n(),N(x,{permission:"licenses/view"},{default:i(()=>[a("div",Et,[o(h,{data:d.formattedLicense,class:"w-full compact-table"},{empty:i(()=>[o(p,{icon:"Empty/ListView","has-dark":!0,text:d.translate("No Licenses found based on your filter")},null,8,["text"])]),default:i(()=>[o(U,{label:d.translate("License Key"),width:200},{default:i(u=>{var k;return[a("div",xt,[a("span",null,[(n(),N(v,{status:u.row.status,key:u.row.id},null,8,["status"]))]),a("span",St,[a("span",Tt,[o($,{class:"link",to:{name:"view_license",params:{license_id:(k=u.row)==null?void 0:k.id}}},{default:i(()=>[w(r(u.row.license_key),1)]),_:2},1032,["to"])]),o(L,{content:u.row.license_key,placement:"top","popper-class":"fct-tooltip"},{default:i(()=>[o(P,{class:"cursor-pointer p-1 w-6 h-6 flex-none",name:"Copy",onClick:()=>{d.Clipboard.copy(u.row.license_key,{successMessage:d.translate("License Key copied to clipboard"),errorMessage:d.translate("Failed to copy License Key")})}},null,8,["onClick"])]),_:2},1032,["content"])])])]}),_:1},8,["label"]),l.columns.indexOf("product")!==-1?(n(),N(U,{key:0,width:200,label:d.translate("Product")},{default:i(u=>{var k;return[o(B,{class:"link block hover:no-underline",to:{name:"view_license",params:{license_id:(k=u.row)==null?void 0:k.id}}},{default:i(()=>[o(V,{product:u.row.product,hideProductId:!0,hideViewIcon:!0,hideImage:!0},null,8,["product"])]),_:2},1032,["to"])]}),_:1},8,["label"])):g("",!0),l.columns.indexOf("order_id")!==-1?(n(),N(U,{key:1,width:80,label:d.translate("Order ID")},{default:i(u=>[o(B,{class:"link order_id block hover:no-underline relative w-full",to:{name:"view_order",params:{order_id:u.row.order_id}}},{default:i(()=>[o($,{class:"link absolute left-1/2 top-1/2 translate-x-[calc(-50%-16px)] translate-y-[-50%]",to:{name:"view_order",params:{order_id:u.row.order_id}}},{default:i(()=>[w(" #"+r(u.row.order_id),1)]),_:2},1032,["to"])]),_:2},1032,["to"])]),_:1},8,["label"])):g("",!0),l.columns.indexOf("customer")!==-1?(n(),N(U,{key:2,width:100,label:d.translate("Customer")},{default:i(u=>[o($,{class:"link",to:{name:"view_customer",params:{customer_id:u.row.customer_id}}},{default:i(()=>{var k,I;return[w(r(((I=(k=u.row)==null?void 0:k.customer)==null?void 0:I.full_name)||d.translate("No Name")),1)]}),_:2},1032,["to"])]),_:1},8,["label"])):g("",!0),o(U,{width:90,label:d.translate("Activations")},{default:i(u=>{var k;return[o(B,{class:"link block hover:no-underline relative w-full",to:{name:"view_license",params:{license_id:(k=u.row)==null?void 0:k.id}}},{default:i(()=>[w(r(d.translateNumber(u.row.activation_count))+" / "+r(u.row.limit==0?"Unlimited":u.row.limit),1)]),_:2},1032,["to"])]}),_:1},8,["label"]),l.columns.indexOf("date")!==-1?(n(),N(U,{key:3,width:140,label:d.translate("Date")},{default:i(u=>{var k;return[o(B,{class:"block hover:no-underline w-full",to:{name:"view_license",params:{license_id:(k=u.row)==null?void 0:k.id}}},{default:i(()=>[a("div",null,[a("span",null,r(d.formatDate(u.row.created_at)),1),e[0]||(e[0]=a("span",{class:"text-gray-300 px-2"},"–",-1)),u.row.expiration_date?(n(),c("span",Ot,r(d.formatDate(u.row.expiration_date)),1)):(n(),c("span",Ut,r(d.translate("Lifetime")),1))])]),_:2},1032,["to"])]}),_:1},8,["label"])):g("",!0)]),_:1},8,["data"])]),a("div",Nt,[a("div",Pt,[(n(!0),c(F,null,H(d.formattedLicense,(u,k)=>(n(),c("div",{key:k,class:"fct-table-mobile-row"},[a("div",{class:"fct-table-mobile-header",onClick:I=>s.$router.push({name:"view_license",params:{license_id:u==null?void 0:u.id}})},[a("div",Dt,[a("div",jt,[(n(),N(v,{status:u.status,key:u.id},null,8,["status"]))]),a("div",Rt,r(u.activation_count)+" / "+r(u.limit==0?"Unlimited":u.limit),1)])],8,Bt),a("div",Ft,[a("div",{class:"fct-table-product-col",onClick:I=>s.$router.push({name:"view_license",params:{license_id:u==null?void 0:u.id}})},[o(V,{product:u.product,hideProductId:!0,hideViewIcon:!0,hideImage:!0},null,8,["product"])],8,Wt),a("div",Ht,[a("div",Kt,[a("div",qt,[o($,{class:"link",to:{name:"view_license",params:{license_id:u==null?void 0:u.id}}},{default:i(()=>[w(r(u.license_key),1)]),_:2},1032,["to"])]),o(P,{class:"cursor-pointer p-1 w-6 h-6",name:"Copy",onClick:()=>{d.Clipboard.copy(u.license_key,{successMessage:d.translate("License Key copied to clipboard"),errorMessage:d.translate("Failed to copy License Key")})}},null,8,["onClick"])])])])]))),128))])])]),_:1})}const oa=_e(Vt,[["render",zt]]),Zt={class:"fct_edit_customer_popup"},Qt={class:"form-error-wrap"},Yt=["innerHTML"],Gt={class:"dialog-footer"},je=Object.assign({name:"AddOrEditAddressModal"},{__name:"AddOrEditAddressModal",props:["customer_id","modalAction","address","showAddressModal","order_id","customerAddressModalInfos","showSetAsAlsoCheckbox","closing_modal"],emits:["close-modal","update:refresh-address"],setup(s,{emit:e}){const l=s,C=e;S([]);const m=S(!1),d=S({}),v=S(!1),$=S(!1),P=S(!1);S(null);const L=S({...l.address??{}}),U=xe().ctx;et().onSave(()=>{l.showAddressModal&&["billing","shipping"].includes(l.modalAction.type)&&(l.modalAction.action==="edit"&&U.address.id!==""?h():l.modalAction.action==="create"&&p())});const B=x=>{let u="";for(const k in x){const I=x[k],T=Object.values(I);u+=T+" </br>"}return u},p=()=>{v.value=!0;const x=L.value;let u={type:l.modalAction.type,customer_id:l.customer_id,order_id:l.order_id??null},k={...x,...u};k.sync=P.value,q.post("customers/"+l.customer_id+"/address",{...k}).then(I=>{C("update:refresh-address",!1,I.data),O.success(I.message),d.value={}}).catch(I=>{var T;I.status_code=="422"?(O.validationErrors(I),d.value=I.data):O.error((T=I.data)==null?void 0:T.message)}).finally(()=>{m.value=!1,v.value=!1})},h=()=>{$.value=!0,l.address;let u={...{type:l.modalAction.type,customer_id:l.customer_id,is_primary:l.address.is_primary,id:l.address.id,order_id:l.order_id&&l.address.is_primary==1?l.order_id:null},...L.value};q.put("customers/"+l.customer_id+"/address",{...u}).then(k=>{P.value,C("update:refresh-address",!1,k.data),O.success(k.message),d.value={}}).catch(k=>{var I;k.status_code=="422"?(O.validationErrors(k),d.value=k):O.error((I=k.data)==null?void 0:I.message)}).finally(()=>{m.value=!1,$.value=!1})};return le(()=>l.closing_modal,(x,u)=>{x&&(d.value={})}),(x,u)=>{const k=M("el-form"),I=M("el-checkbox"),T=M("el-button");return n(),c("div",Zt,[o(k,{"label-position":"top",class:"fct-compact-form","require-asterisk-position":"right"},{default:i(()=>[o(Q,{label:A(f)("Address Label"),class:J(d.value.hasOwnProperty("label")?"is-error":""),modelValue:L.value.label,"onUpdate:modelValue":u[0]||(u[0]=b=>L.value.label=b)},null,8,["label","class","modelValue"]),o(Q,{label:A(f)("Name"),required:"",class:J(d.value.hasOwnProperty("name")?"is-error":""),modelValue:L.value.name,"onUpdate:modelValue":u[1]||(u[1]=b=>L.value.name=b)},null,8,["label","class","modelValue"]),o(Q,{label:A(f)("Email"),required:"",class:J(d.value.hasOwnProperty("email")?"is-error":""),modelValue:L.value.email,"onUpdate:modelValue":u[2]||(u[2]=b=>L.value.email=b)},null,8,["label","class","modelValue"]),o(Q,{label:A(f)("Phone"),required:"",class:J(d.value.hasOwnProperty("phone")?"is-error":""),modelValue:L.value.phone,"onUpdate:modelValue":u[3]||(u[3]=b=>L.value.phone=b)},null,8,["label","class","modelValue"]),o(ve,{use_additional_address_fields:"",modelValue:L.value,"onUpdate:modelValue":u[4]||(u[4]=b=>L.value=b),validationErrors:d.value},null,8,["modelValue","validationErrors"])]),_:1}),a("div",Qt,[a("p",{class:"form-error-text",innerHTML:B(d.value)},null,8,Yt)]),a("div",Gt,[(s.showSetAsAlsoCheckbox,g("",!0)),s.address.id?(n(),N(T,{key:1,type:"primary",onClick:u[6]||(u[6]=b=>h()),loading:$.value,disabled:$.value},{default:i(()=>[w(r(A(f)("Update Address")),1)]),_:1},8,["loading","disabled"])):(n(),N(T,{key:2,type:"primary",onClick:u[7]||(u[7]=b=>p()),loading:v.value,disabled:v.value},{default:i(()=>[w(r(A(f)("Add Address")),1)]),_:1},8,["loading","disabled"]))])])}}}),Jt={class:"fct-manage-address-modal"},Xt={key:1,class:"fct-manage-address-wrap"},es=["onClick"],ts={class:"fct-address-action absolute top-0 right-0 pt-2"},ss={class:"more-btn"},ls={key:0,class:"empty-text"},as={key:2,class:"edit_address"},os={key:3,class:"dialog-footer"},ds={name:"ManageAddressModal",props:["showAddressModal","customer_id","modalAction","order_id"],expose:["editAddress"],data(){return{manageAddress:[],address:{},loading:!0,isEditAddress:!1,selectedAddressIndex:null}},computed:{showModal:{get(){return this.showAddressModal},set(s){this.$emit("update:showAddressModal",s)}}},methods:{handleAddressCommand(s){s.action==="edit"?this.editAddress(s.data):s.action==="use"?this.$emit("onAddressSelected",s.data):s.action==="set-as-also"?this.setAsAlso(s.data):s.action==="default"?this.setAddressPrimary(s.data):s.action==="remove"&&this.$confirm("Are you sure want to delete this address?","Warning",{confirmButtonText:this.$t("Yes, Delete!"),cancelButtonText:this.$t("Cancel"),cancelButtonClass:"el-button--small",confirmButtonClass:"el-button--small",type:"warning"}).then(()=>{this.removeAddress(s.data)}).catch(()=>{})},emitAddNewAddress(s,e=[]){this.$emit("addNewAddress",s,"create",e)},emitAddressSelected(){this.showModal=!1,this.$emit("onAddressSelected",this.manageAddress[this.selectedAddressIndex])},editAddress(s){this.address=s,this.isEditAddress=!0},removeAddress(s){let e=s.id;this.$del("customers/"+this.customer_id+"/address",{address:s}).then(l=>{this.getAddresses(),this.$emit("refresh-address"),this.handleSuccess(l.message),e===this.selectedAddressIndex&&(this.selectedAddressIndex=null)}).catch(l=>{var C;l.status_code=="422"?O.validationErrors(l):O.error((C=l.data)==null?void 0:C.message)}).finally(()=>{this.loading=!1})},setAddressPrimary(s){this.$post("customers/"+this.customer_id+"/address/make-primary",{addressId:s.id,type:s.type}).then(e=>{this.$emit("refresh-address"),this.getAddresses(),this.handleSuccess(e.message)}).catch(e=>{var l;e.status_code=="422"?O.validationErrors(e):O.error((l=e.data)==null?void 0:l.message)}).finally(()=>{this.loading=!1})},getTitle(){return this.modalAction.type==="billing"?this.$t("Manage billing address"):this.$t("Manage shipping address")},fetchAddresses(){this.getAddresses(this.modalAction.type)},getAddresses(s="billing"){this.loading=!0,this.selectedOrders=[],this.$get("customers/"+this.customer_id+"/address",{type:this.modalAction.type}).then(e=>{this.manageAddress=e.addresses}).catch(e=>{this.handleError(e)}).finally(()=>{this.loading=!1})},updateAddress(){this.fetchAddresses(),this.$emit("refresh-address")},setAsAlso(s){const e=this.modalAction.type==="billing"?"shipping":"billing",l={...s,type:e,customer_id:this.customer_id,is_primary:0};delete l.id,delete l.created_at,delete l.updated_at,this.emitAddNewAddress(e,l)}}},ns=Object.assign(ds,{setup(s){return(e,l)=>{const C=M("el-skeleton"),m=M("el-tag"),d=M("el-dropdown-item"),v=M("el-dropdown-menu"),$=M("el-dropdown"),P=M("el-icon"),L=M("el-button"),U=M("el-dialog");return n(),c("div",Jt,[o(U,{modelValue:e.showModal,"onUpdate:modelValue":l[5]||(l[5]=V=>e.showModal=V),onClose:l[6]||(l[6]=()=>{e.selectedAddressIndex=null,e.isEditAddress=!1}),onOpen:e.fetchAddresses,title:e.getTitle(),"append-to-body":!0},{default:i(()=>[e.loading?(n(),N(C,{key:0,animated:"",rows:4})):g("",!0),!e.loading&&!e.isEditAddress?(n(),c("div",Xt,[(n(!0),c(F,null,H(e.manageAddress,(V,B)=>(n(),c("div",{class:"fct-manage-address-block-wrap",key:V.id},[a("div",{class:J(`cursor-pointer fct-manage-address-block ${V.is_primary==="1"?"default-address":""}  ${B===e.selectedAddressIndex?"selected":""} `),onClick:()=>{e.selectedAddressIndex=B}},[V.is_primary==="1"?(n(),N(m,{key:0,type:"info",round:""},{default:i(()=>[w(r(e.$t("Default")),1)]),_:1})):g("",!0),a("p",null,[a("strong",null,r(V.name),1),w(" "+r(e.getOrderAddress(V,"",!0)),1)])],10,es),a("div",ts,[o($,{trigger:"click",class:"fct-more-option-wrap","popper-class":"fct-dropdown",onCommand:e.handleAddressCommand},{dropdown:i(()=>[o(v,null,{default:i(()=>[o(d,{command:{action:"edit",data:V}},{default:i(()=>[w(r(e.$t("Edit")),1)]),_:2},1032,["command"]),o(d,{command:{action:"use",data:V}},{default:i(()=>[w(r(e.$t("Use this address")),1)]),_:2},1032,["command"]),o(d,{command:{action:"set-as-also",data:V}},{default:i(()=>[w(r(s.modalAction.type==="billing"?e.$t("Copy to Shipping"):e.$t("Copy to Billing")),1)]),_:2},1032,["command"]),V.is_primary!=="1"?(n(),c(F,{key:0},[o(d,{command:{action:"default",data:V}},{default:i(()=>[w(r(e.$t("Set as default")),1)]),_:2},1032,["command"]),o(d,{command:{action:"remove",data:V},class:"item-destructive"},{default:i(()=>[w(r(e.$t("Delete")),1)]),_:2},1032,["command"])],64)):g("",!0)]),_:2},1024)]),default:i(()=>[a("span",ss,[o(j,{name:"More"})])]),_:2},1032,["onCommand"])])]))),128)),e.manageAddress.length==0?(n(),c("div",ls,r(s.modalAction.type==="billing"?e.$t("No billing address found."):e.$t("No shipping address found.")),1)):g("",!0)])):g("",!0),e.isEditAddress?(n(),c("div",as,[o(L,{text:"",onClick:l[0]||(l[0]=()=>e.isEditAddress=!1),style:{"margin-bottom":"16px"}},{default:i(()=>[o(P,null,{default:i(()=>[o(A(Be))]),_:1}),w(" "+r(e.$t("Manage address")),1)]),_:1}),o(je,{"onUpdate:refreshAddress":l[1]||(l[1]=V=>{e.isEditAddress=V,e.updateAddress()}),customer_id:s.customer_id,modalAction:s.modalAction,address:e.address,showAddressModal:e.isEditAddress,order_id:s.order_id,onCloseModal:l[2]||(l[2]=V=>e.showModal=!1)},null,8,["customer_id","modalAction","address","showAddressModal","order_id"])])):g("",!0),e.isEditAddress?g("",!0):(n(),c("div",os,[e.selectedAddressIndex!=null?(n(),N(L,{key:0,onClick:l[3]||(l[3]=V=>e.emitAddressSelected())},{default:i(()=>[o(j,{name:"LocationPin"}),w(" "+r(e.$t("Use this address")),1)]),_:1})):g("",!0),o(L,{onClick:l[4]||(l[4]=V=>e.emitAddNewAddress(s.modalAction.type)),type:"primary"},{default:i(()=>[o(j,{name:"Plus"}),w(" "+r(e.$t("Add new address")),1)]),_:1})]))]),_:1},8,["modelValue","onOpen","title"])])}}}),rs={class:"fct-term-container"},is={class:"fct-term-input-wrap"},us={key:0,class:"fct-term-search-result-button-wrap mb-1.5"},cs={class:"search-text"},ms={key:1,class:"fct-term-search-result-list is-scrollable"},ps=["value","checked","onChange"],_s={key:2,class:"empty-text"},fs={key:0,class:"fct-term-selected-list"},vs={class:"fct-term-selected"},hs={class:"text"},gs={class:"fct-term-list-header"},ys={class:"fct-term-input-inline-wrap"},bs={key:0,class:"fct-term-list-header-button-wrap"},Cs={class:"search-text"},As={class:"fct-term-list-wrap is-scrollable"},ws={key:0,class:"fct-term-list newly-added-list"},ks={class:"title"},$s={class:"fct-term-label"},Ms=["value","checked","onChange"],Ls={key:1,class:"fct-term-list to-add-list"},Is={class:"title"},Vs={class:"fct-term-label"},Es=["value","checked","onChange"],xs={key:2,class:"fct-term-list available-list"},Ss={class:"title"},Ts={class:"fct-term-label"},Os=["value","checked","onChange"],Us={key:3,class:"empty-text"},Ns={class:"dialog-footer"},Re={__name:"Modal",props:{bindToType:{type:String},bindToId:{type:[String,Number]},selected_labels:{type:Array,default:[]},labelModalIsOpen:{type:Boolean,default:!1},shouldEnableEditing:{type:Boolean,default:!0}},emits:["update:update-label","close-label-modal"],setup(s,{emit:e}){const l=xe().ctx,C=s,m=e,d=S([]),v=S([]),$=S([]),P=S(),L=S(""),U=S([]),V=S([]),B=S(!1),p=S(!1),h=S(C.labelModalIsOpen),x=S("");le(()=>C.labelModalIsOpen,t=>{h.value=t,t&&($.value=[...d.value])});const u=t=>{t.stopPropagation(),t.preventDefault(),I()},k=()=>{l.$get("labels").then(t=>{U.value=t.labels,d.value=C.selected_labels}).catch(t=>{var y;t.status_code=="422"?O.validationErrors(t):O.error((y=t.data)==null?void 0:y.message)}).finally(()=>{})},I=(t="")=>{const y=L.value||x.value;l.$post("labels",{value:y,bind_to_type:C.bindToType,bind_to_id:C.bindToId}).then(D=>{L.value="",x.value="",U.value.push(D.data),t!=="insideModal"?d.value.push(D.data.id):v.value.push(D.data.id),m("update:update-label",d.value)}).catch(D=>{O.error(D)})};le(L,t=>{t?(t=t.trim(),V.value=U.value.filter(y=>y.value.toLowerCase().includes(t.toLowerCase())),B.value=!0):(V.value=[],B.value=!1)});const T=t=>{const y=d.value.indexOf(t);y===-1?d.value.push(t):d.value.splice(y,1),m("update:update-label",d.value)},b=t=>{const y=$.value.indexOf(t);y===-1?$.value.push(t):$.value.splice(y,1)},ae=t=>{const y=v.value.indexOf(t);y===-1?v.value.push(t):v.value.splice(y,1)},ue=()=>{d.value=[...$.value,...v.value],v.value=[],m("update:update-label",d.value),ee()},oe=t=>{const y=d.value.indexOf(t);y!==-1&&(d.value.splice(y,1),m("update:update-label",d.value))},de=t=>{B.value&&!P.value.$el.contains(t.target)&&!p.value.contains(t.target)&&(B.value=!1,L.value="")},ne=K(()=>U.value.filter(t=>d.value.includes(t.id))),X=K(()=>U.value.filter(t=>v.value.includes(t.id))),Y=K(()=>U.value.filter(t=>$.value.includes(t.id)).filter(t=>t.value.toLowerCase().includes(x.value.trim().toLowerCase()))),G=K(()=>U.value.filter(t=>!$.value.includes(t.id)).filter(t=>!v.value.includes(t.id)).filter(t=>t.value.toLowerCase().includes(x.value.trim().toLowerCase())).sort((t,y)=>t.value.localeCompare(y.value))),ee=()=>{m("close-label-modal")},_=K(()=>{const t=x.value.trim().toLowerCase(),y=L.value.trim().toLowerCase();return(t||y)===""||V.value.some(D=>D.value.toLowerCase()===t||D.value.toLowerCase()===y)||Y.value.some(D=>D.value.toLowerCase()===t||D.value.toLowerCase()===y)||G.value.some(D=>D.value.toLowerCase()===t||D.value.toLowerCase()===y)});return pe(()=>{k(),document.addEventListener("click",de)}),Ke(()=>{document.removeEventListener("click",de)}),(t,y)=>{const D=M("el-input"),z=M("el-button"),Z=M("el-dialog");return n(),c("div",rs,[a("div",is,[s.shouldEnableEditing?(n(),N(D,{key:0,ref_key:"inputRef",ref:P,modelValue:L.value,"onUpdate:modelValue":y[0]||(y[0]=E=>L.value=E),onKeydown:qe(u,["enter"])},null,8,["modelValue"])):g("",!0),B.value?(n(),c("div",{key:1,class:"fct-term-search-result",ref_key:"suggestionsRef",ref:p,style:ze(L.value==""?"display: none":"")},[L.value!==""&&!_.value?(n(),c("div",us,[o(z,{type:"info",plain:"",onClick:I,size:"small"},{default:i(()=>[o(j,{name:"PlusCircle"}),w(" "+r(t.$t("Add"))+" ",1),a("span",cs,'"'+r(L.value)+'"',1)]),_:1})])):g("",!0),V.value.length>0?(n(),c("ul",ms,[(n(!0),c(F,null,H(V.value,(E,W)=>(n(),c("li",{key:W},[a("label",null,[a("input",{type:"checkbox",value:E.id,checked:d.value.includes(E.id),onChange:te=>T(E.id)},null,40,ps),w(" "+r(E.value),1)])]))),128))])):g("",!0),V.value.length===0?(n(),c("p",_s,r(t.$t("No labels found.")),1)):g("",!0)],4)):g("",!0)]),ne.value.length>0?(n(),c("ul",fs,[(n(!0),c(F,null,H(ne.value,E=>(n(),c("li",{key:E.id},[a("div",vs,[a("div",hs,r(E.value),1),s.shouldEnableEditing?(n(),N(j,{key:0,name:"Cross",onClick:W=>oe(E.id)},null,8,["onClick"])):g("",!0)])]))),128))])):g("",!0),o(Z,{"before-close":ee,"append-to-body":!0,width:"45%",modelValue:h.value,"onUpdate:modelValue":y[3]||(y[3]=E=>h.value=E),title:t.$t("Add labels"),class:"fct-add-labels-modal"},{default:i(()=>[a("div",gs,[a("div",ys,[o(D,{modelValue:x.value,"onUpdate:modelValue":y[1]||(y[1]=E=>x.value=E),placeholder:t.$t("Search to find or create labels")},{prefix:i(()=>[o(j,{name:"Search"})]),_:1},8,["modelValue","placeholder"])]),x.value!==""&&!_.value?(n(),c("div",bs,[o(z,{type:"info",plain:"",onClick:y[2]||(y[2]=E=>I("insideModal")),size:"small"},{default:i(()=>[o(j,{name:"PlusCircle"}),w(" "+r(t.$t("Add"))+" ",1),a("span",Cs,'"'+r(x.value)+'"',1)]),_:1})])):g("",!0)]),a("div",As,[X.value.length>0?(n(),c("ul",ws,[a("li",ks,r(t.$t("Newly added")),1),(n(!0),c(F,null,H(X.value,E=>(n(),c("li",{key:E.id},[a("label",$s,[a("input",{type:"checkbox",value:E.id,checked:v.value.includes(E.id),onChange:W=>ae(E.id)},null,40,Ms),w(" "+r(E.value),1)])]))),128))])):g("",!0),Y.value.length>0?(n(),c("ul",Ls,[a("li",Is,r(t.$t("To add")),1),(n(!0),c(F,null,H(Y.value,E=>(n(),c("li",{key:E.id},[a("label",Vs,[a("input",{type:"checkbox",value:E.id,checked:$.value.includes(E.id),onChange:W=>b(E.id)},null,40,Es),w(" "+r(E.value),1)])]))),128))])):g("",!0),G.value.length>0?(n(),c("ul",xs,[a("li",Ss,r(t.$t("Available")),1),(n(!0),c(F,null,H(G.value,E=>(n(),c("li",{key:E.id},[a("label",Ts,[a("input",{type:"checkbox",value:E.id,checked:$.value.includes(E.id),onChange:W=>b(E.id)},null,40,Os),w(" "+r(E.value),1)])]))),128))])):g("",!0),Y.value.length===0&&G.value.length===0&&X.value.length===0?(n(),c("p",Us,r(t.$t("No labels found.")),1)):g("",!0)]),a("div",Ns,[o(z,{onClick:ee},{default:i(()=>[w(r(t.$t("Cancel")),1)]),_:1}),o(z,{type:"primary",onClick:ue},{default:i(()=>[w(r(t.$t("Done")),1)]),_:1})])]),_:1},8,["modelValue","title"])])}}},Ps={class:"fct-admin-sidebar-item"},Bs={name:"Labels",props:{bindToType:{type:String},bindToId:{type:[String,Number]},selectedLabels:{type:Array,default:()=>[]},shouldEnableEditing:{type:Boolean,default:!0}},components:{IconButton:fe,LabelModal:Re,DynamicIcon:j},data(){return{labelModalIsOpen:!1}},methods:{openLabelModal(){this.labelModalIsOpen=!0},updateLabel(s){this.bindToId&&this.bindToType&&this.$post("labels/update-label-selections",{bind_to_type:this.bindToType,bind_to_id:this.bindToId,selectedLabels:s}).then(e=>{O.success(e.message)}).catch(e=>{O.error(e.message)}),this.$emit("update:update-label",s)},closeLabel(){this.labelModalIsOpen=!1}},mounted(){}},da=Object.assign(Bs,{setup(s){return(e,l)=>(n(),N(De,{permission:"labels/manage"},{default:i(()=>[a("div",null,[o(Ue,null,{default:i(()=>[o(Te,{title:e.$t("Labels"),border_bottom:"",title_size:"small"},{action:i(()=>[s.shouldEnableEditing?(n(),N(fe,{key:0,size:"x-small",bg:"transparent",tag:"button",border:"transparent",onClick:e.openLabelModal},{default:i(()=>[o(j,{name:"Edit"})]),_:1},8,["onClick"])):g("",!0)]),_:1},8,["title"]),o(Oe,null,{default:i(()=>[a("div",Ps,[o(Re,{bindToType:s.bindToType,bindToId:s.bindToId,labelModalIsOpen:e.labelModalIsOpen,selected_labels:s.selectedLabels,shouldEnableEditing:s.shouldEnableEditing,"onUpdate:updateLabel":e.updateLabel,onCloseLabelModal:l[0]||(l[0]=C=>e.labelModalIsOpen=!1)},null,8,["bindToType","bindToId","labelModalIsOpen","selected_labels","shouldEnableEditing","onUpdate:updateLabel"])])]),_:1})]),_:1})])]),_:1}))}}),Ds={class:"fct-customer-edit-modal"},js={key:1,class:"fct-form-group"},Rs={class:"label"},Fs={style:{display:"flex","align-items":"center",gap:"10px"}},Ws={class:"select-use-option"},Hs={class:"fct-compact-form"},Ks={class:"form-heading"},qs={class:"fct-compact-form fct-customer-address-section"},zs={style:{"margin-top":"20px"}},Zs={class:"form-error-wrap"},Qs={class:"form-error-text"},Ys={class:"dialog-footer"},Gs={key:3,class:"dialog-footer"},Js={__name:"ChangeOrderCustomer",props:{orderId:{type:[String,Number],default:null,required:!0}},setup(s){const e=s,l=S(null),C=S([]),m=S(!1),d=S(!1),v=S({}),$=S({id:"",email:"",full_name:"",state:"",city:"",country:"",postcode:"",country_name:"",contact_id:"",user_id:"",wp_user:""}),P=p=>{if(!p){C.value=[];return}q.get("customers/",{search:p}).then(h=>{C.value=h.customers.data}).finally(()=>{})},L=()=>{if(!l.value){O.error(f("Please select a customer"));return}q.post("orders/"+e.orderId+"/change-customer",{customer_id:l.value}).then(p=>{O.success(p.message),setTimeout(()=>{window.location.reload()},300)}).catch(p=>{if(p.message)return O.error(p.message);console.log("errors",p)}).finally(()=>{console.log("finally")})},U=()=>{q.post("orders/"+e.orderId+"/create-and-change-customer",$.value).then(p=>{O.success(p.message),setTimeout(()=>{window.location.reload()},300),v.value={},d.value=!1}).catch(p=>{if(p.message)return O.error(p.message);v.value=p}).finally(()=>{})},V=()=>{d.value=!0},B=()=>{d.value=!1};return(p,h)=>{const x=M("el-button"),u=M("el-option"),k=M("el-select"),I=M("el-checkbox");return n(),c("div",Ds,[d.value?(n(),c("div",{key:0,onClick:B,style:{"margin-bottom":"10px"}},[o(x,{text:"",style:{"margin-top":"0"}},{default:i(()=>[o(j,{name:"ArrowLeft"}),w(" "+r(A(f)("Back")),1)]),_:1})])):g("",!0),d.value?g("",!0):(n(),c("div",js,[a("label",Rs,[w(r(A(f)("Select Customer"))+" ",1),o(x,{text:"",class:"fct-create-customer-btn",onClick:Ee(V,["prevent"])},{default:i(()=>[o(j,{name:"Plus"}),w(" "+r(A(f)("Add New Customer")),1)]),_:1})]),a("div",Fs,[o(k,{modelValue:l.value,"onUpdate:modelValue":h[0]||(h[0]=T=>l.value=T),remote:!0,"remote-method":P,loading:m.value,filterable:"",clearable:"",placeholder:A(f)("Type to search user"),style:{width:"100%"}},{default:i(()=>[(n(!0),c(F,null,H(C.value,T=>(n(),N(u,{key:T.id,label:T.full_name,value:T.id},{default:i(()=>[a("div",Ws,[a("span",null,r(T.full_name),1),a("span",null,r(T.email),1)])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue","loading","placeholder"])])])),d.value?(n(),c(F,{key:2},[a("div",Hs,[o(Q,{label:A(f)("Full Name"),modelValue:$.value.full_name,"onUpdate:modelValue":h[1]||(h[1]=T=>$.value.full_name=T)},null,8,["label","modelValue"]),o(Q,{label:A(f)("Email"),modelValue:$.value.email,"onUpdate:modelValue":h[2]||(h[2]=T=>$.value.email=T)},null,8,["label","modelValue"])]),a("h4",Ks,r(A(f)("Address")),1),a("div",qs,[o(ve,{modelValue:$.value,"onUpdate:modelValue":h[3]||(h[3]=T=>$.value=T)},null,8,["modelValue"]),a("div",zs,[o(I,{"true-value":"yes","false-value":"no",modelValue:$.value.wp_user,"onUpdate:modelValue":h[4]||(h[4]=T=>$.value.wp_user=T)},{default:i(()=>[o(Pe,{title:A(f)("Create as wordpress user"),content:A(f)("We will create a new user for this customer. If a user with the same email already exists, we will associate the customer with that existing user.")},null,8,["title","content"])]),_:1},8,["modelValue"])]),a("div",Zs,[(n(!0),c(F,null,H(v.value,T=>(n(),c("p",Qs,r(T.required),1))),256))])]),a("div",Ys,[o(x,{onClick:h[5]||(h[5]=T=>p.$emit("close"))},{default:i(()=>[w(r(A(f)("Cancel")),1)]),_:1}),o(x,{type:"primary",onClick:U},{default:i(()=>[w(r(A(f)("Create & Attach Customer")),1)]),_:1})])],64)):g("",!0),d.value?g("",!0):(n(),c("div",Gs,[o(x,{type:"primary",onClick:L},{default:i(()=>[w(r(A(f)("Create & Attach Customer")),1)]),_:1})]))])}}},Xs={class:"fct-admin-sidebar"},el={class:"more-btn"},tl={key:0,class:"fct-admin-sidebar-item"},sl={class:"name"},ll={class:"email"},al={class:"fct-admin-sidebar-item"},ol={class:"fct-profile-card"},dl=["src","alt"],nl={key:0,class:"fct-profile-details"},rl={class:"title"},il={class:"text"},ul={key:0},cl={class:"text"},ml={key:0,class:"user-info mt-2"},pl=["href"],_l={class:"fct-admin-sidebar-item mt-5"},fl={class:"fct-contact-info-list"},vl={class:"flex items-center justify-between gap-2"},hl=["href"],gl={class:"fct-admin-sidebar-item mt-5"},yl={class:"sidebar-title"},bl={key:0,class:"fct-address-copy-wrap"},Cl={class:"text"},Al={key:0,class:"pr-1"},wl=["innerHTML"],kl={key:1,class:"mt-3"},$l={class:"pr-1"},Ml=["href"],Ll={key:1,class:"no-address-text"},Il={class:"fct-admin-sidebar-item mt-5"},Vl={class:"sidebar-title"},El={key:0,class:"fct-address-copy-wrap"},xl={class:"text"},Sl={key:0},Tl=["innerHTML"],Ol={key:1,class:"mt-3"},Ul={class:"pr-1"},Nl=["href"],Pl={key:2,class:"mt-3"},Bl={class:"pr-1"},Dl={key:1,class:"no-address-text"},jl={class:"fluent-cart-admin-pages"},na={__name:"OrderCustomerInformation",props:{order:{type:Object,default:()=>({})},shouldEnableEditing:{type:Boolean,default:!0}},emits:["onAddressSelected","onAddressRemove"],setup(s,{emit:e}){var X,Y,G,ee;const l=s,C=S([]),m=S((Y=(X=l.order)==null?void 0:X.customer)!=null&&Y.id?l.order.customer:null),d=S((G=l.order)!=null&&G.billing_address?l.order.billing_address:null),v=S((ee=l.order)!=null&&ee.shipping_address?l.order.shipping_address:null),$=e,P=S(!1),L=_=>{_==="remove_customer"&&U(),_==="change_customer"?P.value=!0:_==="edit_customer"?I("edit"):_==="manage_billing_address"?ae("billing"):_==="manage_shipping_address"&&ae("shipping")},U=()=>{l.order.customer_id="",l.order.customer={},m.value=null,d.value=null,v.value=null,$("onAddressRemove"),setTimeout(()=>{oe()},50)},V=(_,t)=>{q.get("customers/",{search:_,with:["shipping_address","billing_address"]}).then(y=>{let D=y.customers.data;C.value=D;let z=D.map(te=>({id:te.id,value:te.full_name,email:te.email})),Z=jQuery(".fct-customer-autocomplete-dropdown"),E=jQuery(".el-autocomplete-suggestion__list"),W="empty-text";D.length<1?Z.length>0&&(Z.addClass("is-empty-customer"),E.children(`.${W}`).length||E.prepend(`<li class="${W}">No customer found.</li>`)):Z.length>0&&(Z.removeClass("is-empty-customer"),E.children(`.${W}`).remove()),t(z)}).catch(y=>{O.error(y)})},B=_=>{const t=C.value.find(y=>y.id===_.id)??null;p(t)},p=_=>{m.value=_,l.order.customer=_,l.order.customer_id=_.id,m.value!==null&&(h(),x())},h=()=>{const _=m.value.billing_address;_&&(Array.isArray(_)&&_.length>0?(d.value=_[0],d.value=_.find(t=>t.is_primary.toString()==="1")??d.value):d.value=null,$("onAddressSelected",d.value))},x=()=>{const _=m.value.shipping_address;_&&(Array.isArray(_)&&_.length>0?(v.value=_[0],v.value=_.find(t=>t.is_primary.toString()==="1")??v.value):v.value=null,$("onAddressSelected",v.value))},u=_=>{_&&q.post(`orders/${l.order.id}/update-address-id`,{address_id:_.id,address_type:_.type}).then(t=>{O.success(t.message),_.type==="shipping"?v.value=_:d.value=_,b.value.showModal=!1,$("onAddressSelected",_)}).catch(t=>{O.error(t)})},k=S({showModal:!1,action:"create",title:f("Create New Customer"),customer:{},manageWpUser:"yes"}),I=(_="create")=>{const t=k.value;t.showModal=!0,t.action=_==="create"?"create":"edit",t.title=_==="create"?f("Create New Customer"):f("Edit Customer Information"),t.customer_id=_==="create"?null:m.value.id,t.customer=_==="create"?{}:m.value,t.manageWpUser=_==="create"?"yes":m.value.user_id==="0"?"no":"yes",k.value=t},T=S(!0),b=S({showManageAddressModal:!1,showModal:!1,modalAction:{type:"billing",action:"create"},title:"",customer_id:"",address_id:"",address:{},address_mock:{name:"",phone:"",email:"",address_1:"",address_2:"",city:"",state:"",postcode:"",country:"",is_primary:"0"}}),ae=(_="billing",t="edit")=>{b.value.showManageAddressModal=!0,b.value.modalAction.type=_,b.value.modalAction.action=t},ue=(_="billing",t="create",y={})=>{Object.keys(y).length>0?(b.value.address={...y},T.value=!1):b.value.address={...b.value.address_mock},b.value.showModal=!0,b.value.modalAction.type=_,b.value.modalAction.action=t,b.value.showManageAddressModal=!1},oe=()=>{let _=jQuery(".el-autocomplete-suggestion__wrap");if(_.length>0){let t=jQuery('<div class="fct-create-customer-button-wrap"><button class="el-button el-button--info el-button--small is-plain"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 14 14" fill="none"><path d="M1.5 7H12.5M7 1.5V12.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg> Create a new customer</button></div>').on("click",()=>{I()});_.prepend(t)}},de=()=>b.value.modalAction.action==="create"?b.value.modalAction.type==="billing"?f("Add new billing address"):f("Add new shipping Address"):b.value.modalAction.type==="billing"?f("Edit billing address"):f("Edit shipping address"),ne=(_,t)=>{b.value.modalAction.type==="billing"?d.value=t:v.value=t,b.value.showModal=_,b.value.showManageAddressModal=!0,u(t)};return le(l.order,(_,t)=>{_.customer_id!==t.customer_id&&U()}),pe(()=>{oe()}),(_,t)=>{var ge;const y=M("el-dropdown-item"),D=M("el-dropdown-menu"),z=M("el-dropdown"),Z=M("el-autocomplete"),E=M("router-link"),W=M("el-icon"),te=M("el-button"),he=M("el-dialog");return n(),c(F,null,[a("div",Xs,[o(Ue,null,{default:i(()=>[o(Te,{title:A(f)("Customer Information"),title_size:"small",border_bottom:""},{action:i(()=>[m.value&&s.shouldEnableEditing?(n(),N(z,{key:0,trigger:"click",class:"fct-more-option-wrap","popper-class":"fct-dropdown",onCommand:L},{dropdown:i(()=>[o(D,null,{default:i(()=>[o(y,{command:"edit_customer"},{default:i(()=>[w(r(A(f)("Edit customer information")),1)]),_:1}),o(y,{command:"manage_shipping_address"},{default:i(()=>[w(r(A(f)("Manage shipping address")),1)]),_:1}),o(y,{command:"manage_billing_address"},{default:i(()=>[w(r(A(f)("Manage billing address")),1)]),_:1}),s.order.id?(n(),N(y,{key:0,command:"change_customer"},{default:i(()=>[w(r(A(f)("Change customer")),1)]),_:1})):g("",!0),s.order.id?g("",!0):(n(),N(y,{key:1,command:"remove_customer"},{default:i(()=>[w(r(A(f)("Remove customer")),1)]),_:1}))]),_:1})]),default:i(()=>[a("span",el,[o(j,{name:"More"})])]),_:1})):g("",!0)]),_:1},8,["title"]),o(Oe,null,{default:i(()=>{var R,ye,be,Ce,Ae,we,ke,$e,Me,Le,Ie,Ve;return[m.value===null?(n(),c("div",tl,[o(Z,{"popper-class":"fct-customer-autocomplete-dropdown",clearable:"",modelValue:s.order.customer.full_name,"onUpdate:modelValue":t[0]||(t[0]=se=>s.order.customer.full_name=se),"fetch-suggestions":V,placeholder:A(f)("Search or create a customer"),disabled:!1,onSelect:B},{prefix:i(()=>[o(j,{name:"Search"})]),default:i(se=>[a("span",sl,r(se.item.value),1),a("span",ll,r(se.item.email),1)]),_:1},8,["modelValue","placeholder"])])):(n(),c(F,{key:1},[a("div",al,[a("div",ol,[a("div",{class:"fct-profile-image cursor-pointer",onClick:t[1]||(t[1]=se=>_.$router.push({name:"view_customer",params:{customer_id:m.value.id}}))},[a("img",{src:m.value.photo,alt:(R=m.value)==null?void 0:R.full_name},null,8,dl)]),m.value.id?(n(),c("div",nl,[a("div",rl,[o(E,{to:{name:"view_customer",params:{customer_id:m.value.id}}},{default:i(()=>[w(r(m.value.full_name),1)]),_:1},8,["to"])]),a("span",il,[m.value.purchase_count>0?(n(),c("span",ul,r(A(Se)(m.value.purchase_count)),1)):g("",!0),w(" "+r(_.$n("Order","Orders",m.value.purchase_count??0,"No Order")),1)]),a("span",cl,r(A(tt)((ye=m.value)==null?void 0:ye.ltv,!0))+" "+r(A(f)("Lifetime Value")),1)])):g("",!0)]),s.order.customer.user_link?(n(),c("div",ml,[w(r(A(f)("WP User:"))+" ",1),a("a",{href:s.order.customer.user_link,target:"_blank",class:"inline-flex items-center gap-1 dark:text-gray-100 text-primary-500 focus:shadow-none hover:!underline"},[w(" #"+r(s.order.customer.user_id)+" ",1),o(j,{name:"Redirect",class:"w-2.5 h-2.5 text-primary-500 dark:text-gray-200"})],8,pl)])):g("",!0)]),a("div",_l,[a("ul",fl,[a("li",null,[a("div",vl,[a("a",{class:"text",href:"mailto:"+((be=s.order.customer)==null?void 0:be.email)},r(m.value.email),9,hl),o(re,{text:m.value.email,showMode:"basic_copy_btn",tooltipText:A(f)("Copy email")},null,8,["text","tooltipText"])])])])]),a("div",gl,[a("h4",yl,r(A(f)("Shipping Address")),1),v.value!=null?(n(),c("div",bl,[a("span",Cl,[v.value.name?(n(),c("strong",Al,r(v.value.name),1)):g("",!0),a("span",{class:"break-all",innerHTML:_.getOrderAddress({...v.value},"shipping",!0)},null,8,wl),(we=(Ae=(Ce=v.value)==null?void 0:Ce.meta)==null?void 0:Ae.other_data)!=null&&we.phone?(n(),c("span",kl,[a("strong",$l,r(A(f)("Phone"))+":",1),a("a",{href:"tel:"+v.value.meta.other_data.phone,class:"text-system-mid dark:text-gray-50 hover:underline"},r(v.value.meta.other_data.phone),9,Ml)])):g("",!0)]),o(re,{text:_.getOrderAddress({...v.value},"shipping"),showMode:"basic_copy_btn",tooltipText:A(f)("Copy address")},null,8,["text","tooltipText"])])):(n(),c("p",Ll,r(A(f)("No shipping address provided")),1))]),a("div",Il,[a("h4",Vl,r(A(f)("Billing Address")),1),d.value!=null?(n(),c("div",El,[a("div",xl,[d.value.name?(n(),c("strong",Sl,r(d.value.name),1)):g("",!0),a("span",{class:"break-all",innerHTML:_.getOrderAddress({...d.value},"billing",!0)},null,8,Tl),(Me=($e=(ke=d.value)==null?void 0:ke.meta)==null?void 0:$e.other_data)!=null&&Me.phone?(n(),c("span",Ol,[a("strong",Ul,r(A(f)("Phone"))+":",1),a("a",{href:"tel:"+d.value.meta.other_data.phone,class:"text-system-mid dark:text-gray-50 hover:underline"},r(d.value.meta.other_data.phone),9,Nl)])):g("",!0),(Ve=(Ie=(Le=d.value)==null?void 0:Le.meta)==null?void 0:Ie.other_data)!=null&&Ve.company_name?(n(),c("span",Pl,[a("strong",Bl,r(A(f)("Company"))+":",1),a("span",null,r(d.value.meta.other_data.company_name),1)])):g("",!0)]),o(re,{text:_.getOrderAddress({...d.value},"billing"),showMode:"basic_copy_btn",tooltipText:A(f)("Copy address")},null,8,["text","tooltipText"])])):(n(),c("p",Dl,r(A(f)("No shipping address provided")),1))])],64))]}),_:1})]),_:1})]),o(it,{onSelectNewCustomer:t[2]||(t[2]=R=>{p(R),k.value.showModal=!1}),customerModalInfos:k.value,customer_id:k.value.customer_id,customer:k.value.customer,onCloseModal:t[3]||(t[3]=R=>k.value.showModal=!1)},null,8,["customerModalInfos","customer_id","customer"]),o(ns,{modalAction:b.value.modalAction,onOnAddressSelected:u,"onUpdate:showAddressModal":t[4]||(t[4]=R=>b.value.showManageAddressModal=R),showAddressModal:b.value.showManageAddressModal,customer_id:(ge=m.value)==null?void 0:ge.id,order_id:s.order.id,onAddNewAddress:ue},null,8,["modalAction","showAddressModal","customer_id","order_id"]),o(he,{"show-close":!0,modelValue:b.value.showModal,"onUpdate:modelValue":t[7]||(t[7]=R=>b.value.showModal=R),"append-to-body":!0,title:de()},{default:i(()=>{var R;return[a("div",jl,[o(te,{text:"",onClick:t[5]||(t[5]=()=>{b.value.showManageAddressModal=!0,b.value.showModal=!1}),class:"mb-4"},{default:i(()=>[o(W,null,{default:i(()=>[o(A(Be))]),_:1}),w(" "+r(_.$t("Manage address")),1)]),_:1}),o(je,{"onUpdate:refreshAddress":ne,customerAddressModalInfos:b.value,customer_id:m.value.id,modalAction:b.value.modalAction,address:b.value.address,showAddressModal:b.value.showModal,showSetAsAlsoCheckbox:T.value,order_id:(R=s.order)==null?void 0:R.id,onCloseModal:t[6]||(t[6]=()=>{b.value.showModal=!1,b.value.showManageAddressModal=!0})},null,8,["customerAddressModalInfos","customer_id","modalAction","address","showAddressModal","showSetAsAlsoCheckbox","order_id"])])]}),_:1},8,["modelValue","title"]),s.order.id?(n(),N(he,{key:0,modelValue:P.value,"onUpdate:modelValue":t[9]||(t[9]=R=>P.value=R),title:_.$t("Change Customer")},{default:i(()=>[o(Js,{"order-id":s.order.id,onClose:t[8]||(t[8]=R=>P.value=!1)},null,8,["order-id"])]),_:1},8,["modelValue","title"])):g("",!0)],64)}}};export{oa as L,aa as O,It as P,De as _,it as a,je as b,ns as c,da as d,na as e,Js as f,ct as p};
