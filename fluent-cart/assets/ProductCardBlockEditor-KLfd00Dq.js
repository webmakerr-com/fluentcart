import{j as r,b as c}from"./BlockEditorTranslator-Do4trUgb.js";import{g as E}from"./Icons-B2jBVdSk.js";import{C as x,a as F}from"./index-C7Ob1qfg.js";import{E as V}from"./EditorPanel-CY23VFza.js";import{E as m}from"./EditorPanelRow-4NClJhlp.js";import{S as $}from"./SelectProductModal-dWenDl2b.js";import{E as P}from"./ErrorBoundary-BPEJCTSJ.js";import{a as R}from"./add-query-args-COp5A_Oq.js";import"./index-CGoo2crO.js";import"./ProductListItem-ByOwLs0s.js";const{InspectorControls:q}=wp.blockEditor,{RangeControl:B}=wp.components,D=({attributes:a,setAttributes:s,selectedProduct:p,setSelectedProduct:e})=>r.jsx(q,{children:r.jsx("div",{className:"fct-inspector-control-wrap fct-inspector-control-wrap--product-card",children:r.jsx("div",{className:"fct-inspector-control-group",children:r.jsx("div",{className:"fct-inspector-control-body",children:r.jsxs(V,{title:c("Product"),children:[r.jsxs(m,{children:[r.jsx("span",{className:"fct-inspector-control-label",children:c("Query type")}),r.jsx("div",{className:"actions",children:r.jsx(x,{customKeys:{key:"value",label:"label"},defaultValue:a.query_type,options:[{label:c("Default"),value:"default"},{label:c("Custom"),value:"custom"}],onChange:function(t){s({query_type:t})}})})]}),a.query_type==="custom"&&r.jsxs(m,{className:"flex-col",children:[r.jsx($,{onModalClosed:t=>{s({product_id:t.ID||""}),e(t)}}),p&&r.jsxs("div",{className:"fct-selected-variation-info w-full",children:[r.jsx("strong",{children:c("Selected product:")}),r.jsx("p",{children:p.post_title})]})]}),r.jsxs(m,{children:[r.jsx("span",{className:"fct-inspector-control-label",children:c("Price Format")}),r.jsx("div",{className:"actions",children:r.jsx(x,{customKeys:{key:"value",label:"label"},defaultValue:a.price_format,options:[{label:c("Starts From"),value:"starts_from"},{label:c("Range"),value:"range"}],onChange:function(t){s({price_format:t})}})})]}),r.jsxs(m,{className:"flex-col",children:[r.jsx("span",{className:"fct-inspector-control-label",children:c("Card Sizing")}),r.jsxs("div",{className:"actions",children:[r.jsx(x,{defaultValue:typeof a.card_width=="string"?"full":"custom",options:[{label:c("Full Width"),value:"full"},{label:c("Custom Width"),value:"custom"}],onChange:t=>{s(t==="full"?{card_width:"100%"}:{card_width:216})}}),a.card_width!=="100%"&&r.jsx(B,{value:a.card_width,onChange:t=>s({card_width:t}),min:216,max:1e3,step:10})]})]})]})})})})}),I=""+new URL("assets/ProductCard-Cjop7KEd.png",import.meta.url).href,{useBlockProps:K}=wp.blockEditor,{registerBlockType:W}=wp.blocks,{useEffect:M,useState:Q}=wp.element,n=window.fluent_cart_product_card_data,w=window.fluentCartRestVars.rest,f=n.currency_sign,N=n.currency_position;W(n.slug+"/"+n.name,{title:n.title,description:n.description,example:{attributes:{},innerBlocks:[{name:"core/image",attributes:{url:I,alt:"Product Card Preview",style:{width:"100%",height:"auto"}}}]},icon:{src:E},category:"fluent-cart",attributes:{product_id:{type:["string","number"],default:""},price_format:{type:"string",default:"starts_from"},card_width:{type:["string","number"],default:216},query_type:{type:"string",default:"default"}},edit:({attributes:a,setAttributes:s})=>{const p=K(),[e,t]=Q({}),C=w.url+"/products/"+a.product_id,b=()=>{a.product_id&&F({path:R(C,{with:["variants"]}),headers:{"X-WP-Nonce":w.nonce}}).then(o=>{t(o.product||{})}).finally(()=>{})},k=()=>{var o;return((o=e==null?void 0:e.detail)==null?void 0:o.variation_type)==="simple_variations"};return M(()=>{b()},[a.product_id]),r.jsx("div",{...p,children:r.jsx(P,{children:r.jsxs("div",{className:"flex flex-col gap-4",children:[r.jsx(D,{attributes:a,setAttributes:s,selectedProduct:e,setSelectedProduct:t}),r.jsxs("div",{className:"fluent-cart-product-card-block-editor",children:[r.jsx("div",{className:"fluent-cart-product-card-block-editor-header",children:r.jsx("h4",{className:"fluent-cart-product-card-block-editor-title",children:c("Product Card")})}),r.jsxs("div",{className:"fct-product-card",style:{width:a.card_width==="100%"?"100%":`${a.card_width}px`},children:[r.jsx("div",{className:"fct-product-card-head",children:r.jsx("img",{className:"fct-product-card-image",src:(e==null?void 0:e.thumbnail)??n.placeholder_image,alt:e==null?void 0:e.post_title})}),r.jsxs("div",{className:"fct-product-card-body",children:[r.jsx("h5",{className:"fct-product-card-title",children:(e==null?void 0:e.post_title)??c("Select a Product")}),r.jsx("div",{className:"fct-product-card-price-wrap",children:(()=>{var j,_,g,v;const o=a.price_format,S=((j=e==null?void 0:e.detail)==null?void 0:j.variation_type)==="simple";let l=(_=e==null?void 0:e.detail)==null?void 0:_.min_price,u=(g=e==null?void 0:e.detail)==null?void 0:g.max_price,h=0;if(S){const i=(v=e==null?void 0:e.variants)==null?void 0:v[0];i&&(l=i.item_price,i.compare_price>l&&(h=i.compare_price))}const d=i=>{if(!i&&i!==0)return N==="after"?`0.00${f}`:`${f}0.00`;const y=(i/100).toFixed(2);return N==="after"?`${y}${f}`:`${f}${y}`};return h?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"fc_compare_price",children:r.jsx("del",{children:d(h)})}),r.jsx("span",{className:"fct-item-price",children:d(l)})]}):u&&u>l?o==="range"?r.jsx(r.Fragment,{children:r.jsxs("span",{className:"fct-item-price",children:[d(l)," - ",d(u)]})}):r.jsx(r.Fragment,{children:r.jsxs("span",{className:"fct-item-price",children:["From ",d(l)]})}):r.jsx(r.Fragment,{children:r.jsx("span",{className:"fct-item-price",children:d(l)})})})()})]}),r.jsx("div",{className:"fct-product-card-footer",children:r.jsx("button",{className:"fluent-cart-shop-app-view-product-button",children:r.jsx("span",{children:c(k()?"View Options":"Add to Cart")})})})]})]})]})})})},save:function(a){return null}});
