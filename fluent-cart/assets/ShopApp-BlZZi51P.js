var ot=Object.defineProperty;var z=p=>{throw TypeError(p)};var nt=(p,r,t)=>r in p?ot(p,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):p[r]=t;var c=(p,r,t)=>nt(p,typeof r!="symbol"?r+"":r,t),O=(p,r,t)=>r.has(p)||z("Cannot "+t);var l=(p,r,t)=>(O(p,r,"read from private field"),t?t.call(p):r.get(p)),d=(p,r,t)=>r.has(p)?z("Cannot add the same private member more than once"):r instanceof WeakSet?r.add(p):r.set(p,t),f=(p,r,t,e)=>(O(p,r,"write to private field"),e?e.call(p,t):r.set(p,t),t),g=(p,r,t)=>(O(p,r,"access private method"),t);var P;class lt{constructor(r,t,e,i,a,n){c(this,"filterForm");c(this,"filterListener");d(this,P);c(this,"filterContainer");c(this,"appContainer");c(this,"sidebarFilterItemCollapse");c(this,"liveFilter");c(this,"shopAppWrapper");c(this,"activeSortBy");c(this,"setActiveSortOption",()=>{this.shopAppWrapper.querySelectorAll("[data-sort-item]").forEach(t=>t.classList.remove("selected"));const r=this.shopAppWrapper.querySelector(`input[name="sort_by"][value="${this.activeSortBy}"]`);r&&(r.checked=!0,r.closest("[data-sort-item]").classList.add("selected"))});var h;this.filterForm=r,this.filterListener=n,f(this,P,t),this.appContainer=e.closest("[data-fluent-cart-product-wrapper]"),this.filterContainer=i,this.liveFilter=a,this.isReseting=!1,this.debouncedFilterApply=null,this.searchClear=null,this.shopAppWrapper=this.appContainer,this.activeSortBy=((h=this.shopAppWrapper.querySelector("[data-sort-by]"))==null?void 0:h.getAttribute("data-sort-by"))||"name-asc",typeof this.filterForm>"u"||this.filterForm,this.searchClear=this.filterContainer.querySelector("[data-fluent-cart-search-clear]"),this.filterForm.addEventListener("submit",s=>{s.preventDefault(),this.applyFilter()}),this.setupResetButton(),this.prepareFilterContainer(),this.handleCollapsibleFilter(),this.handleSidebarItemCollapsible(),this.loadSlider(),this.listenForResize(),this.listenForFilterValueChange(),this.handleSorting(),this.debouncedFilterApply=this.debounce(()=>{this.liveFilter&&this.applyFilter()},300);let o=this.appContainer.querySelector("[data-fluent-cart-product-wrapper-inner]");this.appContainer.offsetWidth>=767?(this.appContainer.querySelector("[data-fluent-cart-shop-app-filter-wrapper]").classList.remove("is-collapsed"),this.appContainer.querySelector("[data-fluent-cart-shop-app-filter-toggle-button]")&&this.appContainer.querySelector("[data-fluent-cart-shop-app-filter-toggle-button]").classList.add("hide"),o&&o.classList.remove("fct-full-container-width")):(this.appContainer.querySelector("[data-fluent-cart-shop-app-filter-toggle-button]")&&this.appContainer.querySelector("[data-fluent-cart-shop-app-filter-toggle-button]").classList.remove("hide"),this.appContainer.querySelector("[data-fluent-cart-shop-app-filter-wrapper]").classList.add("is-collapsed"),o&&o.classList.add("fct-full-container-width"))}handleSorting(){this.setActiveSortOption();const r=this.shopAppWrapper.querySelector("[data-sort-toggle]"),t=this.shopAppWrapper.querySelector("[data-sort-dropdown]"),e=this.shopAppWrapper.querySelectorAll('input[name="sort_by"]');r&&(r.addEventListener("click",()=>{r.classList.toggle("active"),t.classList.toggle("active")}),e.forEach(i=>{i.addEventListener("change",()=>{this.activeSortBy=i.value,this.setActiveSortOption();let a=this.getState();this.appendSearchParamToUrl(a),this.showLoading(),this.applyFilter(),setTimeout(()=>{this.hideLoading()},500)})}),document.addEventListener("click",i=>{t&&!t.contains(i.target)&&!r.contains(i.target)&&(t.classList.remove("active"),r.classList.remove("active"))}))}showLoading(){const r=this.shopAppWrapper.querySelector("[data-shop-loading]");r&&r.classList.add("active")}hideLoading(){const r=this.shopAppWrapper.querySelector("[data-shop-loading]");r&&r.classList.remove("active")}setupResetButton(){this.filterForm.querySelectorAll('input[type="reset"], button[type="reset"]').forEach(t=>{t.addEventListener("click",e=>{e.preventDefault(),this.resetFilterData()})}),this.searchClear&&this.searchClear.addEventListener("click",t=>{t.preventDefault(),this.resetFilterData(),this.searchClear.classList.add("hide")}),document.addEventListener("click",t=>{t.target.matches("[data-fluent-cart-shop-app-reset-button]")&&this.resetFilterData()})}resetFilterData(){setTimeout(()=>{this.isReseting=!0,this.filterListener.setFilters({}),this.filterListener.onFilterApplied(),this.filterForm.querySelectorAll('input[type="checkbox"]').forEach(e=>e.checked=!1),this.filterForm.querySelectorAll('input[type="text"]').forEach(e=>e.value=""),this.resetSlider(),this.appendSearchParamToUrl(),this.applyFilter(),setTimeout(()=>{this.isReseting=!1},100)},100)}listenForFilterValueChange(){typeof this.filterForm<"u"&&(this.filterForm.querySelectorAll("input").forEach(e=>{e.addEventListener("change",i=>{var a;if(e.matches("[data-fluent-cart-search-bar]")&&this.searchClear&&(i.target.value.trim()!==""?this.searchClear.classList.remove("hide"):this.searchClear.classList.add("hide")),this.isReseting){(a=i.preventDefault)==null||a.call(i);return}this.liveFilter&&this.applyFilter(),setTimeout(()=>{this.appendSearchParamToUrl()},100)})}),this.filterForm.querySelectorAll("input[data-parent-checkbox]").forEach(e=>{e.addEventListener("change",i=>{var o;if(this.isReseting){(o=i.preventDefault)==null||o.call(i);return}const a=e.checked,n=e.closest("[data-fluent-cart-shop-app-filter-checkbox-child-group]");n&&n.querySelectorAll('input[type="checkbox"]').forEach(s=>s.checked=a)})}))}applyFilter(){const r=this.getState();this.filterListener.setFilters(r),this.filterListener.onFilterApplied()}getState(){const r=this.getFormDataAsObject(this.filterForm);return this.activeSortBy&&(r.sort_by=this.activeSortBy),r}appendSearchParamToUrl(){let r=this.getState();const t=new URL(window.location.href),e=t.searchParams;this.filterForm.querySelectorAll("input").forEach(n=>{const o=n.getAttribute("name");typeof o<"u"&&(e.delete("filters["+o+"]"),e.delete("filters["+o+"][]"))});let a="";if(this.isReseting){[...e.entries()].length?a=`${t.origin}${t.pathname}?${e.toString()}${t.hash}`:a=`${t.origin}${t.pathname}${t.hash}`,history.pushState({path:a},"",a);return}for(const n of Object.keys(r))e.delete("filters["+n+"]"),e.delete("filters["+n+"][]");for(const[n,o]of Object.entries(r))o!=null&&o!==""&&(Array.isArray(o)?o.forEach(h=>e.append("filters["+n+"][]",h)):e.append("filters["+n+"]",o));a=`${t.origin}${t.pathname}?${e.toString()}${t.hash}`,history.pushState({path:a},"",a)}clearUrlFilters(){new URL(window.location.href).searchParams}listenForResize(){window.addEventListener("resize",()=>{this.appContainer.offsetWidth>=767?(this.appContainer.querySelector("[data-fluent-cart-shop-app-filter-wrapper]").classList.remove("is-collapsed"),this.appContainer.querySelector("[data-fluent-cart-shop-app-filter-toggle-button]")&&this.appContainer.querySelector("[data-fluent-cart-shop-app-filter-toggle-button]").classList.add("hide"),this.filterContainer.appendChild(this.filterForm),document.querySelectorAll(".fluent-cart-shop-app-responsive-filter-wrapper").forEach(t=>t.remove())):(this.appContainer.querySelector("[data-fluent-cart-shop-app-filter-toggle-button]")&&this.appContainer.querySelector("[data-fluent-cart-shop-app-filter-toggle-button]").classList.remove("hide"),this.appContainer.querySelector("[data-fluent-cart-shop-app-filter-wrapper]").classList.add("is-collapsed"))})}prepareFilterContainer(){this.filterContainer&&this.filterContainer.setAttribute("data-accessor-id",l(this,P))}handleCollapsibleFilter(){this.appContainer.querySelectorAll("[data-fluent-cart-shop-app-filter-toggle-button]").forEach(t=>{t.addEventListener("click",()=>{this.handleFilterPosition(!0)})})}handleFilterPosition(r=!1){if(document.querySelectorAll(".fluent-cart-shop-app-responsive-filter-wrapper").forEach(i=>i.remove()),this.appContainer.offsetWidth<window.fluentcart_shop_vars.responsive_filter_breakpoint){const i=document.createElement("div");i.innerHTML=window.fluentcart_shop_vars.responsive_filter_wrapper;const a=i.firstElementChild;a.setAttribute("data-description-id",l(this,P)),a.classList.add("fluent-cart-default-product-page-style","fluent-cart-shop-app-wrapper"),window.fluentcart_shop_vars.is_admin_bar_showing&&a.classList.add("admin_bar_enabled"),document.body.appendChild(a);const n=a.querySelector("[data-fluent-cart-shop-app-responsive-filter-container]"),o=a.querySelector("[data-fluent-cart-shop-app-responsive-filter-close-button]");o&&o.addEventListener("click",()=>{this.hideResponsiveFilter(a)}),r&&this.showResponsiveFilter(a),n&&(n.appendChild(this.filterForm),a.appendChild(n))}else this.filterContainer.appendChild(this.filterForm)}handleSidebarItemCollapsible(){this.filterForm.querySelectorAll("[data-fluent-cart-shop-app-filter-form-item-collapse]").forEach(t=>{t.addEventListener("click",function(){const e=this.parentElement;e.classList.toggle("is-collapsed"),Array.from(e.children).filter(a=>a!==this).forEach(a=>{a.style.display==="none"?a.style.display="":a.style.display="none"})})})}showResponsiveFilter(r){r.classList.add("show")}hideResponsiveFilter(r){r.classList.remove("show")}resetSlider(){this.filterForm.querySelectorAll('[data-filter-type="range"]').forEach(t=>{const e=t.querySelector("[data-range-slider-wrapper]"),i=t.querySelector("input[data-range-slider-from-value]"),a=t.querySelector("input[data-range-slider-to-value]");i&&a&&e&&e.noUiSlider&&(i.value=i.dataset.value,a.value=a.dataset.value,e.noUiSlider.set([i.dataset.value,a.dataset.value]))})}loadSlider(){const r=this.filterForm.querySelectorAll('[data-filter-type="range"]');r.length>0&&r.forEach(t=>{t.dataset.filterName;let e=1;const i=t.querySelector("input[data-range-slider-from-value]"),a=t.querySelector("input[data-range-slider-to-value]");if(!i||!a)return;const n=parseFloat(i.value)||0,o=parseFloat(a.value)||0,h=parseFloat(i.dataset.value)||0,s=parseFloat(a.dataset.value)||0,u=t.querySelector("[data-range-slider-wrapper]");if(typeof u<"u"){const T=u.querySelector(".noUi-base");T&&T.remove(),typeof noUiSlider<"u"&&(noUiSlider.create(u,{start:[n,o],connect:!0,step:.1,range:{min:h,max:s},format:{from:function(y){return parseFloat(y).toFixed(1)},to:function(y){return parseFloat(y).toFixed(1)}}}),u.noUiSlider.on("update",(y,F)=>{if(e===3){if(i.value=y[0],a.value=y[1],this.isReseting)return;this.liveFilter&&this.debouncedFilterApply(),this.appendSearchParamToUrl()}else e+=1}),i.addEventListener("change",y=>{u.noUiSlider.set([y.target.value,null])}),a.addEventListener("change",y=>{u.noUiSlider.set([null,y.target.value])}))}})}getFormDataAsObject(r){const t=new FormData(r),e={};for(const[i,a]of t.entries())e[i]===void 0?e[i]=a:(e[i]instanceof Array||(e[i]=[e[i]]),e[i].push(a));return e}debounce(r,t){let e;return function(...i){clearTimeout(e),e=setTimeout(()=>r.apply(this,i),t)}}}P=new WeakMap;var b,q,_,R,x;class Y{constructor(r,t,e=1){c(this,"container");c(this,"filterContainer");c(this,"productView");c(this,"productList");c(this,"productGridParentDiv");c(this,"filter");c(this,"filterForm");c(this,"filters",[]);d(this,b,{});d(this,q,!1);c(this,"applyingFilter",!1);c(this,"placeholderImage");c(this,"perPage");d(this,_);c(this,"loading");d(this,R,window.fluentCartRestVars.rest.url+"/public/product-views");c(this,"paginator",{currentPage:1,perPage:10,total:0,lastPage:0,from:0,to:0});d(this,x,1);c(this,"usingCursor",!1);c(this,"cursor",null);c(this,"priceFormat","starts_from");c(this,"orderType","DESC");c(this,"liveFilter",!1);c(this,"productLoaderElement");f(this,_,t),this.container=r,this.filterContainer=r.querySelector("[data-fluent-cart-shop-app-filter-wrapper]"),this.productView=r.querySelectorAll("[data-fluent-cart-shop-app-single-product]"),this.productList=r.querySelector("[data-fluent-cart-shop-app-product-list]"),this.placeholderImage=r.getAttribute("data-placeholder"),this.productGridParentDiv=r.querySelector(".fluent-cart-shop-app-products"),this.perPage=r.getAttribute("data-per-page"),this.paginator.currentPage=e,this.productLoaderElement=r.querySelector("[data-fluent-cart-product-loader]"),r.removeAttribute("data-per-page"),this.priceFormat=r.getAttribute("data-price-format")||"starts_from",this.orderType=r.getAttribute("data-order-type")||"DESC",this.liveFilter=!!r.getAttribute("data-live-filter"),r.removeAttribute("data-price-format"),r.removeAttribute("data-order-type"),this.bindFilter(),this.handleDefaultFilters(),window.addEventListener("fluentCartNotifyCartDrawerItemChanged",()=>this.notifyDataSetChanged()),this.reRenderAddToCartButton();let i=this.parseDefaultUrlFilters(window.location);i.hasOwnProperty("filters")&&this.setFilters(i.filters)}parseDefaultUrlFilters(r){const t=new URL(r).searchParams,e={};for(const[i,a]of t.entries()){const n=i.split(/\[|\]/).filter(Boolean);let o=e;for(let h=0;h<n.length;h++){const s=n[h];h===n.length-1?o[s]===void 0?o[s]=a:Array.isArray(o[s])?o[s].push(a):o[s]=[o[s],a]:(o[s]||(o[s]={}),o=o[s])}}return e}handleDefaultFilters(){const r=this.container.getAttribute("data-default-filters");if(r){const t=JSON.parse(r);t.enabled&&f(this,b,{...t}),f(this,q,l(this,b).allow_out_of_stock===!0),delete l(this,b).allow_out_of_stock,this.container.removeAttribute("data-default-filters")}}bindFilter(){this.filterForm=this.container.querySelector("form[data-fluent-cart-product-filter-form]"),!(!this.filterForm||this.filterForm.nodeName!=="FORM")&&(this.filter=new lt(this.filterForm,l(this,_),this.container,this.filterContainer,this.liveFilter,this))}setFilters(r){this.filters=r}onFilterApplied(){this.showProductLoader(),this.beforeFiltering(),this.addSkeletonLoader(),this.loadData(!0).then(()=>{this.productList.scrollIntoView({behavior:"smooth"}),this.hideProductLoader()})}beforeFiltering(){this.paginator.currentPage=0,this.applyingFilter=!0}appendParams(r,t,e){Array.isArray(e)?e.forEach(i=>{r.append(`${t}[]`,i)}):typeof e=="object"&&e!==null?Object.keys(e).forEach(i=>{this.appendParams(r,`${t}[${i}]`,e[i])}):r.append(t,e)}getFilterState(){return this.filters}loadData(r=!1){const t=this.container.querySelector("[data-fluent-cart-shop-no-result-found]");return new Promise((e,i)=>{if(!this.shouldLoadData()&&!this.applyingFilter){e("");return}this.applyingFilter=!1,this.loading=!0,this.onLoadingData();const a=this.getQueryParams();a.with=["licensesMeta","detail","variants","categories",...a.with??[]];const n={...a,filters:this.filters,default_filters:{...l(this,b)},per_page:this.paginator.perPage||10,price_format:this.priceFormat,order_type:this.orderType,template_provider:""},o=this.container.querySelector("[data-fct-product-card]");if(o){const s=o.getAttribute("data-fluent-client-id"),u=o.getAttribute("data-template-provider");s&&(n.client_id=s),u&&(n.template_provider=u)}l(this,q)&&(n.allow_out_of_stock=!0);const h=new URL(l(this,R));Object.keys(n).forEach(s=>{this.appendParams(h.searchParams,s,n[s])}),fetch(h).then(s=>s.json()).then(s=>{const u=s.products.views;u.length>0?(this.paginator={currentPage:s.products.current_page,perPage:s.products.per_page,next_cursor:s.products.next_cursor,total:s.products.total,lastPage:s.products.last_page,from:s.products.from,to:s.products.current_page},t&&setTimeout(()=>{},200)):t&&setTimeout(()=>{},200),r&&this.clearContainer(),this.onDataLoaded(s,u),e(!0)}).catch(s=>{this.onDataLoadError(s),i(s)}).finally(()=>{this.onApiCallFinished()})})}addSkeletonLoader(r=null){}notifyDataSetChanged(){this.reRenderAddToCartButton()}renderNewProducts(r,t=!1){f(this,x,this.paginator.total),t&&this.clearContainer(),this.productList.querySelector("[data-fluent-cart-shop-app-no-products]")&&this.clearContainer();const i=this.container.querySelector("[data-fluent-cart-shop-no-result-found]");r.includes("fluent-cart-shop-no-result-found")?i?(i.outerHTML=r,setTimeout(()=>{i.classList.remove("hide")},300)):this.productList.insertAdjacentHTML("beforebegin",r):this.productList.insertAdjacentHTML("beforeend",r),this.reRenderAddToCartButton()}reRenderAddToCartButton(){if(!window.fluentCartCart)return;const r=window.fluentCartCart.getState();document.querySelectorAll("[data-cart-item-count]").forEach(t=>{t.classList.add("is-cart-count-hidden")}),Object.keys(r).forEach(t=>{const e=r[t].object_id;document.querySelectorAll(`[data-fluent-cart-shop-app-add-to-cart-button][data-product-id="${e}"]`).forEach(a=>{const n=a.querySelector("[data-cart-item-count]");n&&(n.classList.remove("is-cart-count-hidden"),n.textContent=r[t].quantity)})})}clearContainer(){this.productList.innerHTML=""}getQueryParams(){throw new Error("You should override `getQueryParams` method...")}onLoadingData(){}onDataLoaded(r){throw new Error("You should override `onDataLoaded` method...")}onDataLoadError(r){throw new Error("You should override `onDataLoadError` method...")}onApiCallFinished(){throw new Error("You should override `onApiCallFinished` method...")}shouldLoadData(){throw new Error("You should override `shouldLoadData` method...")}showProductLoader(){this.productList&&this.productList.classList.add("product-list-hide");const r=this.container.querySelector("[data-fluent-cart-shop-no-result-found]");r&&r.classList.add("hide"),this.productLoaderElement&&this.productLoaderElement.classList.remove("loader-hidden")}hideProductLoader(){this.productList&&this.productList.classList.remove("product-list-hide"),this.productLoaderElement&&this.productLoaderElement.classList.add("loader-hidden")}}b=new WeakMap,q=new WeakMap,_=new WeakMap,R=new WeakMap,x=new WeakMap;var A,W,I,w,B,M,N,S,L,Q,G,J,j;class ct extends Y{constructor(t,e,i,a,n=10){super(t,a);d(this,L);d(this,A);d(this,W,{});d(this,I,500);d(this,w,!0);d(this,B,1e3*60*5);d(this,M,2);d(this,N);d(this,S,null);c(this,"cursor");c(this,"templateProvider");c(this,"lastCursor",null);this.container=t,f(this,W,e),f(this,A,i),this.paginator.perPage=n,g(this,L,G).call(this),g(this,L,Q).call(this),g(this,L,J).call(this)}beforeFiltering(){this.paginator.currentPage=0,this.applyingFilter=!0,this.cursor=null,this.templateProvider=null}getQueryParams(){return this.usingCursor?{template_provider:this.templateProvider,cursor:this.cursor,per_page:this.paginator.perPage,paginate_using:"cursor",search:""}:{template_provider:this.templateProvider,current_page:this.paginator.currentPage,per_page:this.paginator.perPage,search:""}}parseCursorFromResponse(t){const a=new DOMParser().parseFromString(t.products.views,"text/html").querySelector("[data-fct-product-card]");if(a){const n=a.getAttribute("data-fluent-cart-cursor"),o=a.getAttribute("data-template-provider");if(o&&(this.templateProvider=o),n)return n}return null}onDataLoaded(t,e){var n,o;const i=this.container.querySelector("[data-fluent-cart-shop-no-result-found]");this.lastCursor=this.cursor,this.cursor=this.parseCursorFromResponse(t),typeof l(this,A).onProductFetched=="function"&&l(this,A).onProductFetched(e),e.length>0?(f(this,w,!0),this.renderNewProducts(e),g(this,L,j).call(this),i&&setTimeout(()=>{i.classList.add("hide")},200)):(f(this,w,!1),setTimeout(()=>{f(this,w,!0)},l(this,B)),((n=t==null?void 0:t.products)==null?void 0:n.current_page)<=((o=t==null?void 0:t.products)==null?void 0:o.last_page)&&(i&&setTimeout(()=>{i.classList.remove("hide")},200),f(this,w,!1)));const a=this.container.querySelector(".fluent-cart-shop-app .scroll-loader-container");a&&a.remove()}isCursorValidated(){return this.usingCursor?this.cursor!==void 0&&this.cursor!==null&&this.cursor.length>0:!0}onDataLoadError(t){console.error(t)}onApiCallFinished(){setTimeout(()=>{this.loading=!1;const t=document.querySelector(".loader-container");t&&t.remove()},l(this,I))}shouldLoadData(){return this.isCursorValidated()&&this.productView!==null&&!this.loading&&l(this,w)}loadNextPage(t=!1){this.paginator.currentPage+=1,this.addSkeletonLoader("onPageScroll"),this.loadData(t)}destroy(){l(this,S)&&l(this,S).disconnect()}}A=new WeakMap,W=new WeakMap,I=new WeakMap,w=new WeakMap,B=new WeakMap,M=new WeakMap,N=new WeakMap,S=new WeakMap,L=new WeakSet,Q=function(){const t=this.container.querySelector("[data-fct-product-card]");if(t){const e=t.getAttribute("data-fluent-cart-cursor"),i=t.getAttribute("data-template-provider");e&&(this.cursor=e),i&&(this.templateProvider=i)}this.lastCursor=this.cursor,this.cursor&&(this.usingCursor=!0)},G=function(){this.placeholderImage=this.container.getAttribute("data-placeholder"),typeof this.productView=="object"&&typeof this.productList=="object"?(Array.isArray(this.productList)&&(this.productList=this.productList[0]),Array.isArray(this.productView)&&(this.productView=this.productView[0])):(this.productView=null,this.productList=null)},J=function(){if(this.productView===null)return;const t={root:null,rootMargin:"0px",threshold:1};f(this,S,new IntersectionObserver(e=>{e.forEach(i=>{i.isIntersecting&&this.shouldLoadData()&&this.loadNextPage()})},t)),g(this,L,j).call(this)},j=function(){if(!l(this,S)||!this.productList)return;const t=this.productList.children,e=t[t.length-1];e&&(l(this,S).disconnect(),l(this,S).observe(e))};var E,D,C,V,m,X,Z,K,$,tt,dt;class pt extends Y{constructor(t,e,i,a,n=10){let o=1;const s=new URL(window.location.href).searchParams;s.has("current_page")&&(o=isNaN(s.get("current_page"))?1:s.get("current_page"));super(t,a,o);d(this,m);d(this,E);d(this,D,{});d(this,C,{});c(this,"paginatorWrapper");c(this,"paginatorPageSelector");c(this,"paginatorItem");c(this,"paginationFrom");c(this,"paginationTo");c(this,"paginationTotal");d(this,V,!1);c(this,"paginationJump",5);this.container=t.closest("[data-fluent-cart-product-wrapper]"),f(this,D,e),f(this,E,i),this.paginator.perPage=n,g(this,m,X).call(this),g(this,m,Z).call(this)}getQueryParams(){return{current_page:this.paginator.currentPage,per_page:this.paginator.perPage,search:""}}onDataLoaded(t,e){const i=this.container.querySelector("[data-fluent-cart-shop-no-result-found]");if(f(this,V,!0),f(this,C,{...t.products}),delete l(this,C).data,typeof l(this,E).onProductFetched=="function"&&(l(this,E).onProductFetched(e),this.productList)){const a=this.productList.getBoundingClientRect().top+window.scrollY;window.scrollTo({top:a-50,behavior:"smooth"})}e.length>0?(this.renderNewProducts(e,!0),g(this,m,K).call(this),i&&setTimeout(()=>{i.classList.add("hide")},200)):i&&setTimeout(()=>{i.classList.remove("hide")},200)}onDataLoadError(t){console.log(t)}onApiCallFinished(){this.loading=!1}shouldLoadData(){return this.productView!==null||!this.loading}}E=new WeakMap,D=new WeakMap,C=new WeakMap,V=new WeakMap,m=new WeakSet,X=function(){this.paginatorWrapper=this.container.querySelector("[data-fluent-cart-shop-app-paginator-items-wrapper]"),this.paginatorItem=this.container.querySelector("[data-fluent-cart-shop-app-paginator-item]"),this.paginatorPageSelector=this.container.querySelector("[data-fluent-cart-shop-app-paginator-per-page-selector]"),this.paginationFrom=this.container.querySelector("[data-fluent-cart-shop-app-paginator-info-pagination-from]"),this.paginationTo=this.container.querySelector("[data-fluent-cart-shop-app-paginator-info-pagination-to]"),this.paginationTotal=this.container.querySelector("[data-fluent-cart-shop-app-paginator-info-pagination-total]"),this.productView&&this.productList?Array.isArray(this.productList)&&(this.productList=this.productList[0],this.productView=this.productView[0],this.paginatorWrapper=this.paginatorWrapper[0],this.paginatorItem=this.paginatorItem[0],this.paginatorPageSelector=this.paginatorPageSelector[0]):(this.productView=null,this.productList=null,this.paginatorWrapper=null,this.paginatorItem=null)},Z=function(){const t=this;this.paginatorWrapper&&this.paginatorWrapper.addEventListener("click",function(e){var a;const i=e.target.closest("[data-fluent-cart-shop-app-paginator-item]");if(i){e.preventDefault();const n=i.getAttribute("data-page");g(a=t,m,$).call(a,n)}}),this.paginatorPageSelector&&this.paginatorPageSelector.addEventListener("change",function(){var a;const e=this.value;t.container.querySelectorAll("[data-fluent-cart-shop-app-paginator-per-page-selector]").forEach(n=>{n.value=e}),g(a=t,m,tt).call(a,e)})},K=function(){if(!this.paginator||!this.paginatorWrapper)return;const t=this.paginator.lastPage,e=parseInt(this.paginator.currentPage),i=this.paginationJump||3,a=(s,u,T=!1,y=!1)=>{const F=this.paginatorItem.cloneNode(!0);return F.classList.remove("active","arrow"),F.innerHTML=s,F.setAttribute("data-page",u),T&&F.classList.add("active"),y&&F.classList.add("arrow"),F},n='<svg width="16" height="16" viewBox="0 0 20 20" fill="none"><path d="M12.9168 15.8333L7.7906 10.7071C7.40008 10.3166 7.40008 9.68342 7.7906 9.29289L12.9168 4.16667" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>',o='<svg width="16" height="16" viewBox="0 0 20 20" fill="none"><path d="M7.91667 4.16666L13.0429 9.29289C13.4334 9.68341 13.4334 10.3166 13.0429 10.7071L7.91667 15.8333" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>';this.paginatorWrapper.innerHTML="",this.paginationFrom&&(this.paginationFrom.textContent=l(this,C).from),this.paginationTo&&(this.paginationTo.textContent=l(this,C).to),this.paginationTotal&&(this.paginationTotal.textContent=l(this,C).total);const h=this.paginatorWrapper;if(e>1&&h.appendChild(a(n,e-1,!1,!0)),h.appendChild(a("1",1,e===1)),e>i+1){const s=Math.max(2,e-i);h.appendChild(a("«",s,!1,!0))}for(let s=e-2;s<e;s++)s>1&&h.appendChild(a(s,s));e!==1&&e!==t&&h.appendChild(a(e,e,!0));for(let s=e+1;s<=e+2;s++)s<t&&h.appendChild(a(s,s));if(e<t-i){const s=Math.min(t-1,e+i);h.appendChild(a("»",s,!1,!0))}t>1&&h.appendChild(a(t,t,e===t)),e<t&&h.appendChild(a(o,e+1,!1,!0))},$=function(t){if(this.productView===null||this.loading)return;this.paginator.currentPage=t;const e=new URL(window.location.href),i=e.searchParams;i.delete("current_page"),i.append("current_page",t);const a=`${e.origin}${e.pathname}?${i.toString()}${e.hash}`;history.pushState({path:a},"",a),this.addSkeletonLoader(),this.loadData()},tt=function(t){this.productView===null||this.loading||(this.paginator.perPage=t,this.paginator.currentPage=1,g(this,m,$).call(this,this.paginator.currentPage))},dt=function(t){Object.entries(t).forEach(([e,i])=>{l(this,D)[i.ID]=i})};document.addEventListener("DOMContentLoaded",()=>{var r,t,e,i,a,n,o,h,s,u,et,rt,it,at;const k=class k{constructor(){d(this,u);d(this,t);d(this,e);d(this,i);d(this,a,{});d(this,n,window.fluentCartCart);d(this,o,"open");d(this,h,"active");d(this,s)}init(v){return g(this,u,et).call(this,v),g(this,u,rt).call(this),g(this,u,it).call(this),g(this,u,at).call(this),f(k,r,this),this}getCurrentFilterState(){return l(this,s).getFilterState()}applyFilters(v){l(this,s).setFilters(v),l(this,s).onFilterApplied()}onProductFetched(v){}};r=new WeakMap,t=new WeakMap,e=new WeakMap,i=new WeakMap,a=new WeakMap,n=new WeakMap,o=new WeakMap,h=new WeakMap,s=new WeakMap,u=new WeakSet,et=function(v){var H;f(this,i,v);const U=v.closest("[data-fluent-cart-product-wrapper]");f(this,t,U.querySelector("[data-fluent-cart-shop-app-grid-view-button]")),f(this,e,U.querySelector("[data-fluent-cart-shop-app-list-view-button]")),(H=window.fluentcart_shop_vars)!=null&&H.is_admin_bar_showing&&l(this,i)&&l(this,i).classList.add("admin_bar_enabled")},rt=function(){!l(this,e)||!l(this,t)||(l(this,e).addEventListener("click",()=>{l(this,i).classList.add("mode-list"),l(this,i).classList.remove("mode-grid"),l(this,e).classList.add("active"),l(this,t).classList.remove("active")}),l(this,t).addEventListener("click",()=>{l(this,i).classList.remove("mode-list"),l(this,t).classList.add("active"),l(this,e).classList.remove("active")}))},it=function(){l(this,i).removeAttribute("data-products")},at=function(){const v=parseInt(l(this,i).dataset.perPage);l(this,i).dataset.priceFormat,l(this,i).dataset.paginator==="numbers"?f(this,s,new pt(l(this,i),l(this,a),this,0,v)):f(this,s,new ct(l(this,i),l(this,a),this,0,v))},d(k,r,null);let p=k;window.fluentCartShopApps=[],document.querySelectorAll("[data-fluent-cart-product-wrapper-inner]").forEach(function(st){const v=new p().init(st);window.fluentCartShopApps.push(v)})});
