import{a as h,c,o as l,f as a,d,F as T,h as V,t as o,w as m,u as A,b as M,e as g,g as w,r as gt,S as Y,R,x as yt,T as vt,n as H,m as wt,l as kt,i as N,p as ne,j as ie,aE as Ct,aF as Pt,y as $t,z as At,a2 as St,q as Mt}from"./vue.esm-bundler-DZdE0M9V.js";import{d as le}from"./dayjs.min-2rai63wT.js";import{u as Dt,t as Tt}from"./timezone-C2U15obx.js";import{f as Et}from"./common-D35bkMcN.js";import{_ as U}from"./DynamicIcon-D-LZibaK.js";import{B,I as ee,S as Lt}from"./Badge-CAEsoWyQ.js";import{S as q,u as It,c as Vt,d as xt}from"./Str-Ckn63bs5.js";import{_ as E}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{a as ot,C as Bt,d as _e,b as O,_ as Nt,c as Ut}from"./CopyToClipboard-BjLMcgNd.js";import{b as dt,E as oe,o as G,v as pe,x as fe,y as be,A as ge,B as ye,q as Ht}from"./index-DwF99AZu.js";import Ft from"./ArrowDown-PHrv2PTZ.js";import Ot from"./ArrowUp-B1vbZroT.js";import{R as j}from"./Rest-DEQMhckH.js";import{n as L}from"./Notify-CV-A2uNH.js";import{a as ve,b as we,c as ke,d as Ce,E as Pe,e as $e,f as Ae,g as Se,h as Me,i as De,j as Te,k as Ee,l as Le,m as Ie,n as Ve,o as xe,p as Be,q as Ne,r as Ue,s as He,t as Fe,u as Oe,v as qe,w as Re,x as ze,y as je,B as Ye,C as Ke,D as We,F as Ze,G as Ge,H as Je,I as Qe,J as Xe,K as et,L as tt,N as st,O as at,P as it,Q as rt,R as nt,S as lt}from"./index-CL2oGAAm.js";import{v as qt,i as Rt}from"./defaults-BcSgDByC.js";import"./Translator-Bios5QX5.js";import"./Arr-MwYQQ3qa.js";import"./index-C83b7x36.js";le.extend(Dt);le.extend(Tt);function n(e){var t;e=((t=window.fluentcart_customer_profile_vars)==null?void 0:t.trans[e])||e;const s=Array.prototype.slice.call(arguments,1);if(s.length===0)return e;const r=/%(\d*\$?)s|%d/g;let b=0;return e=e.replace(r,(i,u)=>{if(u){const p=parseInt(u,10)-1;return p<s.length?s[p]:i}else return b<s.length?s[b++]:i}),e}function J(e,s,r,b=null){let t=parseInt(r.toString().replace(/,/g,""),10);return t>1?n(s,r):n(t===0?b??e:e,r)}function Q(e){const s=window.fluentcart_customer_profile_vars.datei18;e=e.toString();const b=(s.numericSystem||"0_1_2_3_4_5_6_7_8_9").split("_");return e.split("").map(i=>b[i]||i).join("")}function z(e,s="MMM DD"){const r=window.fluentcart_customer_profile_vars.datei18,b=le(e).locale({name:"fluent_date_time",weekdays:Object.values(r.weekdays),weekdaysShort:Object.values(r.weekdaysShort),months:Object.values(r.months),monthsShort:Object.values(r.monthsShort),meridiem:(t,i,u)=>{const p=r.am||"AM",_=r.pm||"PM",y=t<12?p:_;return u?y.toLowerCase():y}}).format(s);return zt(b)}const zt=function(e,s){return e&&(window.fluentcart_customer_profile_vars.datei18,e=e.toString(),e.split("").map(b=>b!==" "?Q(b):b).join(""))},jt={class:"fct-customer-dashboard-table"},Yt={class:"order-content-only-mobile",role:"list"},Kt=["aria-label"],Wt={class:"item-header"},Zt={class:"sr-only"},Gt={class:"block truncate max-w-[100px]"},Jt={class:"text-system-light text-sm"},Qt={class:"item-body"},Xt={class:"fct-customer-orders-items fct-customer-orders-items-2"},es={key:0},ts={class:"text-gray-800 text-sm"},ss={key:0,class:"fct-customer-orders-items-sub-title !max-w-full"},as={class:"fct-popover-content"},is={class:"fct-product-orders-items"},rs={class:"variation-title"},ns={key:0},ls=["aria-label"],os={class:"item-footer"},ds={class:"item-footer-content"},cs=["innerHTML"],us={key:1,class:"text-center p-5",role:"note"},ms={class:"invoice-id-date"},hs={class:"block truncate max-w-[100px]"},_s={class:"text"},ps={class:"fct-customer-orders-items"},fs={key:0,class:"fct-customer-orders-items-sub-title"},bs={class:"fct-popover-content"},gs={class:"fct-product-orders-items"},ys={class:"variation-title"},vs={key:0},ws=["aria-label"],ks=["innerHTML"],ct={__name:"OrderTable",props:{orders:{type:Array,required:!0},showTableHeader:{type:Boolean,default:!1},itemsColumnWidth:{type:Number,default:300},showInvoiceButton:{type:Boolean,default:!0}},setup(e){const s=i=>{const u=i.order_items.find(_=>_.payment_type==="subscription"),p=i.order_items.some(_=>_.payment_type==="adjustment");return i.order_items.filter(_=>!(_.payment_type==="signup_fee"||(_.payment_type==="adjustment"&&u&&(_.product.detail.featured_media=r(u)),p&&_.payment_type==="subscription")))},r=i=>{var u,p;return i.variants&&i.variants.media?(p=(u=i==null?void 0:i.variants)==null?void 0:u.media)==null?void 0:p.meta_value[0].url:i.variants&&!i.variants.media&&i.product.detail&&i.product.detail.featured_media&&i.product.detail.featured_media!==null&&typeof i.product.detail.featured_media=="object"?i.product.detail.featured_media.url:b},b=fluentcart_customer_profile_vars.placeholder_image,t=i=>{switch(i){case"completed":return n("Completed");case"paid":return n("Paid");case"active":return n("Active");case"publish":return n("Published");case"draft":return n("Draft");case"shipped":return n("Shipped");case"success":return n("Success");case"licensed":return n("Licensed");case"succeeded":return n("Succeeded");case"failed":return n("Failed");case"error":return n("Error");case"canceled":return n("Canceled");case"expired":return n("Expired");case"partially_paid":return n("Partially Paid");case"intended":return n("Intended");case"scheduled":return n("Scheduled");case"on-hold":return n("On Hold");case"pending":return n("Pending");case"unpaid":return n("Unpaid");case"warning":return n("Warning");case"processing":return n("Processing");case"future":return n("Future");case"inactive":return n("Inactive");case"dispute":return n("Dispute");case"disabled":return n("Disabled");case"beta":return n("Beta");default:return q.headline(i)}};return(i,u)=>{const p=h("router-link"),_=h("el-popover"),y=h("el-table-column"),k=h("el-table");return l(),c("div",jt,[a("div",Yt,[e.orders.length>0?(l(!0),c(T,{key:0},V(e.orders,f=>(l(),c("div",{class:"order-content-only-mobile-item",key:f.id,role:"listitem","aria-label":i.$t("Order summary for order number %s",f.invoice_no)},[a("div",Wt,[a("h3",Zt,o(i.$t("Order Number")),1),d(p,{class:"link text-sm",to:{name:"view_order",params:{order_id:f.uuid}},"aria-label":i.$t("View order")+" #"+f.invoice_no},{default:m(()=>[a("span",Gt,"#"+o(f.invoice_no),1)]),_:2},1032,["to","aria-label"]),a("span",Jt,o(A(z)(f.created_at)),1)]),a("div",Qt,[a("div",Xt,[s(f).length===1?(l(),c("div",es,[d(p,{to:{name:"view_order",params:{order_id:f.uuid}},class:"fct-customer-orders-items-title"},{default:m(()=>{var v,C;return[w(o((v=s(f)[0])==null?void 0:v.post_title)+" ",1),a("span",ts," – "+o((C=s(f)[0])==null?void 0:C.title),1)]}),_:2},1032,["to"]),f.renewals_count>0?(l(),c("span",ss,o(A(J)("%s Renewal","%s Renewals",f.renewals_count)),1)):g("",!0)])):(l(),M(p,{key:1,to:{name:"view_order",params:{order_id:f.uuid}},"aria-label":i.$t("View order")+" #"+f.invoice_no},{default:m(()=>[w(o(A(n)("%s items",s(f).length)),1)]),_:2},1032,["to","aria-label"])),s(f).length>1?(l(),M(_,{key:2,placement:"top",width:360,trigger:"click"},{reference:m(()=>[a("div",{class:"fct-action-link-btn","aria-expanded":!1,"aria-label":i.$t("Show items for order %s",[f.invoice_no]),role:"button"},[d(U,{name:"ChevronDown"})],8,ls)]),default:m(()=>[a("div",as,[a("div",is,[(l(!0),c(T,null,V(s(f),v=>(l(),c("p",{key:v.id},[d(p,{to:{name:"view_order",params:{order_id:f.uuid}},class:"title"},{default:m(()=>[w(o(v.post_title),1)]),_:2},1032,["to"]),a("span",rs,[a("b",null,o(v.quantity),1),w(" x "+o(v.title),1)])]))),128)),s(f).length===0?(l(),c("p",ns,o(A(n)("No products found!")),1)):g("",!0)])])]),_:2},1024)):g("",!0)])]),a("div",os,[a("div",ds,[d(B,{type:f.status,size:"small"},{default:m(()=>[w(o(f.status),1)]),_:2},1032,["type"]),a("span",{innerHTML:i.formatNumber(f.total_amount,!0,!1,f.currency)},null,8,cs)])])],8,Kt))),128)):(l(),c("div",us,o(A(n)("Your purchases will be shown here!")),1))]),d(k,{class:"order-content-only-desktop","empty-text":i.$t("Your purchases will be shown here!"),data:e.orders,"show-header":e.showTableHeader,role:"table","aria-label":i.$t("Customer order history")},{default:m(()=>[d(y,{label:"#",width:120},{default:m(f=>[a("div",ms,[d(p,{class:"link text-sm",to:{name:"view_order",params:{order_id:f.row.uuid}}},{default:m(()=>[a("span",hs,"#"+o(f.row.invoice_no),1)]),_:2},1032,["to"]),a("span",_s,o(A(z)(f.row.created_at)),1)])]),_:1}),d(y,{width:e.itemsColumnWidth,label:A(n)("Items"),"aria-label":i.$t("Order items")},{default:m(f=>[a("div",ps,[s(f.row).length===1?(l(),c(T,{key:0},[d(p,{to:{name:"view_order",params:{order_id:f.row.uuid}},class:"fct-customer-orders-items-title","aria-label":i.$t("View single item for this order")},{default:m(()=>{var v,C;return[w(o((v=s(f.row)[0])==null?void 0:v.post_title)+" ",1),a("span",null," – "+o((C=s(f.row)[0])==null?void 0:C.title),1)]}),_:2},1032,["to","aria-label"]),f.row.renewals_count>0?(l(),c("span",fs,o(A(J)("%s Renewal","%s Renewals",A(Q)(f.row.renewals_count))),1)):g("",!0)],64)):(l(),M(p,{key:1,to:{name:"view_order",params:{order_id:f.row.uuid}},"aria-label":A(n)("%s items in this order")+s(f.row).length},{default:m(()=>[w(o(A(n)("%s items",s(f.row).length)),1)]),_:2},1032,["to","aria-label"])),s(f.row).length>1?(l(),M(_,{key:2,placement:"top",width:360,trigger:"click"},{reference:m(()=>[a("div",{class:"fct-action-link-btn",role:"button","aria-expanded":!1,"aria-label":i.$t("Show all items for this order")},[d(U,{name:"ChevronDown"})],8,ws)]),default:m(()=>[a("div",bs,[a("div",gs,[(l(!0),c(T,null,V(s(f.row),v=>(l(),c("p",{key:v.id},[d(p,{to:{name:"view_order",params:{order_id:f.row.uuid}},class:"title","aria-label":i.$t("View item details:")+v.post_title},{default:m(()=>[w(o(v.post_title),1)]),_:2},1032,["to","aria-label"]),a("span",ys,[a("b",null,o(v.quantity),1),w(" x "+o(v.title),1)])]))),128)),s(f.row).length===0?(l(),c("p",vs,o(A(n)("No products found!")),1)):g("",!0)])])]),_:2},1024)):g("",!0)])]),_:1},8,["width","label","aria-label"]),d(y,{label:A(n)("Status"),width:"120","aria-label":i.$t("Order status")},{default:m(f=>[d(B,{type:f.row.status,size:"small"},{default:m(()=>[w(o(t(f.row.status)),1)]),_:2},1032,["type"])]),_:1},8,["label","aria-label"]),d(y,{label:A(n)("Amount"),width:"90","aria-label":i.$t("Total amount")},{default:m(f=>[a("span",{class:"text",innerHTML:i.formatNumber(f.row.total_amount,!0,!1,f.row.currency)},null,8,ks)]),_:1},8,["label","aria-label"])]),_:1},8,["empty-text","data","show-header","aria-label"])])}}},Cs={name:"OrderTableLoader",props:{rowsRange:{type:Array,default:[1,2]}}},Ps={class:"fct-customer-dashboard-table"};function $s(e,s,r,b,t,i){const u=h("el-skeleton-item"),p=h("el-skeleton"),_=h("el-table-column"),y=h("el-table");return l(),c("div",Ps,[d(y,{data:r.rowsRange,"show-header":!1},{default:m(()=>[d(_,{label:"#",width:150},{default:m(()=>[d(p,{animated:"",class:"py-3"},{template:m(()=>[d(u,{varient:"p",class:"w-3/5"})]),_:1})]),_:1}),d(_,{width:300,label:e.$t("Items")},{default:m(()=>[d(p,{animated:""},{template:m(()=>[d(u,{varient:"p",class:"w-3/5"})]),_:1})]),_:1},8,["label"]),d(_,{label:e.$t("Status"),width:"120"},{default:m(()=>[d(p,{animated:""},{template:m(()=>[d(u,{varient:"p",class:"w-3/5"})]),_:1})]),_:1},8,["label"]),d(_,{label:e.$t("Amount"),width:"90"},{default:m(()=>[d(p,{animated:""},{template:m(()=>[d(u,{varient:"p",class:"w-3/5"})]),_:1})]),_:1},8,["label"])]),_:1},8,["data"])])}const K=E(Cs,[["render",$s]]),As={name:"Dashboard",components:{OrderTable:ct,OrderTableLoader:K},data(){return{recentPurchasesTitleId:"recent-purchases-title",dashboardData:{orders:[],subscriptions:[],licenses:[]},sectionParts:{},loading:!1}},methods:{fetchDashboardData(){this.loading=!0,this.$get("customer-profile").then(e=>{this.dashboardData=e.dashboard_data,e.section_parts&&(this.sectionParts=e.section_parts)}).finally(()=>{this.loading=!1})}},mounted(){this.fetchDashboardData()}},Ss=["aria-labelledby","aria-busy"],Ms={class:"fct-customer-dashboard-header"},Ds=["id"],Ts={class:"actions"},Es={key:0,"aria-live":"polite"},Ls=["innerHTML"],Is=["innerHTML"];function Vs(e,s,r,b,t,i){const u=h("router-link"),p=h("OrderTableLoader"),_=h("OrderTable");return l(),c("div",{class:"fct-customer-dashboard fct-customer-dashboard-layout-width",role:"region","aria-labelledby":t.recentPurchasesTitleId,"aria-busy":t.loading},[a("div",null,[a("div",Ms,[a("h4",{id:t.recentPurchasesTitleId,class:"fct-customer-dashboard-title"},o(e.$t("Your Recent Purchases")),9,Ds),a("div",Ts,[t.dashboardData.orders.length?(l(),M(u,{key:0,class:"is-link",to:{name:"purchase-history"},"aria-label":e.$t("View all purchases")},{default:m(()=>[w(o(e.$t("View all")),1)]),_:1},8,["aria-label"])):g("",!0)])]),t.loading?(l(),c("div",Es,[d(p,{"rows-range":[1,2]})])):g("",!0),t.sectionParts.before_orders_table?(l(),c("div",{key:1,innerHTML:t.sectionParts.before_orders_table},null,8,Ls)):(l(),M(_,{key:2,orders:t.dashboardData.orders},null,8,["orders"])),t.sectionParts.after_orders_table?(l(),c("div",{key:3,innerHTML:t.sectionParts.after_orders_table},null,8,Is)):g("",!0)])],8,Ss)}const xs=E(As,[["render",Vs]]),Bs={name:"EmptyState",props:["title","text"],data(){var e,s;return{shop_url:(s=(e=window.fluentcart_customer_profile_vars)==null?void 0:e.shop)==null?void 0:s.shop_url}}},Ns={class:"fct-customer-dashboard-empty-state",role:"status","aria-live":"polite","aria-atomic":"true"},Us={class:"fct-customer-dashboard-empty-state-inner"},Hs={class:"fct-empty-icon-box","aria-hidden":"true"};function Fs(e,s,r,b,t,i){const u=h("el-button");return l(),c("div",Ns,[a("div",Us,[a("div",Hs,[gt(e.$slots,"icon")]),a("h4",null,o(r.title),1),a("p",null,o(r.text),1),d(u,{tag:"a",href:t.shop_url,rel:"noopener noreferrer","aria-label":e.$t("Back to Shopping Now")},{default:m(()=>[w(o(e.$t("Back to Shopping Now")),1)]),_:1},8,["href","aria-label"])])])}const te=E(Bs,[["render",Fs]]),Os={props:{table:{type:Object,required:!1},pagerSizes:{type:Boolean,default:!0},pagination:{required:!0,type:Object},extra_sizes:{required:!1,type:Array,default(){return[]}},hide_on_single:{required:!1,type:Boolean,default(){return!0}},background:{type:Boolean,default:!0},layout:{type:String,default:"prev, pager, next, slot"},pager_count:{type:Number,default:5}},data(){return{currentPage:1,pickerObserver:null}},computed:{page_sizes(){const e=[];this.pagination.per_page<10&&e.push(this.pagination.per_page);const s=[10,20,50,80,100,120,150];return[...e,...s,...this.extra_sizes]},totalPage(){const e=this.pagination.per_page,s=this.pagination.total;return isNaN(s)||s<=0?0:Math.ceil(s/e)}},watch:{pagination:{immediate:!0,handler(e,s){setTimeout(()=>{this.translatePickerElements()},400)}}},methods:{translateNumber:Q,translate:n,changePage(e){var r;let s=this.getCurrentPageCount(e,this.pagination.per_page);this.currentPage=e,this.pagination.current_page=e,this.$emit("currentPageChanged",{page:e,currentPageCount:s}),this.$emit("fetch"),(r=this.table)==null||r.handlePageChange(),setTimeout(()=>{this.translatePickerElements()},300)},changeSize(e){var s;this.currentPage=1,this.pagination.current_page=1,this.$emit("onPerPageChanged",e),this.$emit("fetch"),(s=this.table)==null||s.handlePerPageChange()},getCurrentPageCount(e,s){return(e<this.pagination.last_page?s:this.pagination.total%s)||s},translatePickerElements(){const e=document.querySelector(".el-pagination.is-background");if(!e)return;e.querySelectorAll("li.number").forEach(b=>{const t=b.textContent.trim();if(t&&/\d/.test(t)&&!b.dataset.translated){const i=Q(t);b.style.setProperty("--translated-number",`"${i}"`),b.dataset.translated="1"}})}},mounted(){this.translatePickerElements()}},qs={class:"pagination-wrap"},Rs={key:0,class:"pager-wrap"},zs={class:"text"},js={class:"el-pagination"},Ys={class:"text"};function Ks(e,s,r,b,t,i){const u=h("el-option"),p=h("el-select"),_=h("el-pagination");return l(),c("div",qs,[r.pagerSizes?(l(),c("div",Rs,[a("span",zs,o(i.translate("Page %1$s of %2$s",i.translateNumber(t.currentPage),i.translateNumber(i.totalPage))),1),a("div",js,[d(p,{onChange:i.changeSize,modelValue:r.pagination.per_page,"onUpdate:modelValue":s[0]||(s[0]=y=>r.pagination.per_page=y),placeholder:i.translate("Select")},{default:m(()=>[(l(!0),c(T,null,V(i.page_sizes,y=>(l(),M(u,{key:y,label:i.translate("%s / page",i.translateNumber(y)),value:y},null,8,["label","value"]))),128))]),_:1},8,["onChange","modelValue","placeholder"])]),a("span",Ys,o(i.translate("Total %s",i.translateNumber(r.pagination.total))),1)])):g("",!0),d(_,{ref:"paginationRef","hide-on-single-page":r.hide_on_single,background:r.background,"current-page":r.pagination.current_page,layout:r.layout,onCurrentChange:i.changePage,"page-sizes":i.page_sizes,total:r.pagination.total,"page-count":r.pagination.last_page,"pager-count":r.pager_count,"page-size":r.pagination.per_page,"onUpdate:pageSize":s[1]||(s[1]=y=>r.pagination.per_page=y)},{default:m(y=>[w(o(y),1)]),_:1},8,["hide-on-single-page","background","current-page","layout","onCurrentChange","page-sizes","total","page-count","pager-count","page-size"])])}const se=E(Os,[["render",Ks]]),Ws={name:"PurchaseHistory",components:{OrderTable:ct,Pagination:se,IconButton:ee,DynamicIcon:U,OrderTableLoader:K,EmptyState:te},data(){var e,s;return{purchaseHistoryTitleId:"purchase-history-title",search:"",showSearch:!1,orders:[],paginate:{current_page:1,per_page:10,total:0},loading:!0,app_loaded:!1,purchaseHistoryTitle:(s=(e=window.fluentcart_customer_profile_vars)==null?void 0:e.section_titles)==null?void 0:s.purchaseHistory}},methods:{fetchOrders(){this.loading=!0,this.$get("customer-profile/orders",{per_page:this.paginate.per_page,page:this.paginate.current_page,search:this.search}).then(e=>{this.orders=e.orders.data,this.paginate.total=e.orders.total}).catch(e=>{this.handleError(e)}).finally(()=>{this.loading=!1,this.app_loaded=!0})}},mounted(){this.fetchOrders()}},Zs=["aria-labelledby","aria-busy"],Gs={class:"fct-customer-purchase-history-inner"},Js={class:"fct-customer-dashboard-header"},Qs=["id"],Xs={class:"actions"},ea={class:"fct-collapsible-search-wrap"},ta={for:"purchase-search-input",class:"sr-only"},sa={id:"search-help",class:"sr-only"},aa={key:0,"aria-live":"polite"},ia={key:1,"aria-live":"polite"};function ra(e,s,r,b,t,i){const u=h("el-input"),p=h("DynamicIcon"),_=h("IconButton"),y=h("OrderTableLoader"),k=h("OrderTable"),f=h("EmptyState"),v=h("pagination"),C=Y("loading");return l(),c("div",{class:"fct-customer-purchase-history",role:"region","aria-labelledby":t.purchaseHistoryTitleId,"aria-busy":t.loading},[a("div",Gs,[a("div",null,[a("div",Js,[a("h4",{id:t.purchaseHistoryTitleId,class:"fct-customer-dashboard-title"},o(e.$t(t.purchaseHistoryTitle)),9,Qs),a("div",Xs,[a("div",ea,[a("label",ta,o(e.$t("Search orders")),1),d(vt,{name:"fade-slide"},{default:m(()=>[t.showSearch?(l(),M(u,{key:0,id:"purchase-search-input",modelValue:t.search,"onUpdate:modelValue":s[0]||(s[0]=S=>t.search=S),onKeyup:yt(i.fetchOrders,["enter"]),onClear:i.fetchOrders,placeholder:e.$t("Search and hit enter..."),clearable:"",size:"small","aria-describedby":"search-help"},null,8,["modelValue","onKeyup","onClear","placeholder"])):g("",!0)]),_:1}),a("small",sa,o(e.$t("Press Enter to search")),1),d(_,{tag:"button",size:"small",onClick:s[1]||(s[1]=S=>t.showSearch=!t.showSearch),"aria-expanded":t.showSearch,"aria-label":t.showSearch?e.$t("Close search"):e.$t("Open search"),"aria-controls":"purchase-search-input"},{default:m(()=>[t.showSearch?(l(),M(p,{key:0,name:"Cross","aria-hidden":"true"})):(l(),M(p,{key:1,name:"Search","aria-hidden":"true"}))]),_:1},8,["aria-expanded","aria-label"])])])]),t.loading&&!t.app_loaded?(l(),c("div",aa,[d(y,{rowsRange:[1,2,3,4,5]})])):t.app_loaded?R((l(),c("div",ia,[t.orders.length>0?(l(),M(k,{key:0,orders:t.orders,showTableHeader:!0},null,8,["orders"])):(l(),M(f,{key:1,title:e.$t("No purchases yet"),text:e.$t("Your purchases will be shown here!")},{icon:m(()=>s[2]||(s[2]=[a("svg",{xmlns:"http://www.w3.org/2000/svg",width:"40",height:"40",viewBox:"0 0 40 40",fill:"none","aria-hidden":"true"},[a("path",{opacity:"0.4",d:"M35 28.6021C35 30.9063 31.7573 32.2761 25.2718 35.0158C22.6663 36.1163 21.3637 36.6666 20 36.6666C18.6363 36.6666 17.3337 36.1163 14.7282 35.0158C8.24273 32.2761 5 30.9063 5 28.6021V11.6666L20 18.9246L35 11.6666V28.6021Z",fill:"#758195"}),a("path",{d:"M20 36.6666C18.6363 36.6666 17.3337 36.1163 14.7282 35.0158C8.24273 32.2761 5 30.9063 5 28.6021C5 27.957 5 16.7741 5 11.6666M20 36.6666C21.3637 36.6666 22.6663 36.1163 25.2718 35.0158C31.7573 32.2761 35 30.9063 35 28.6021V11.6666M20 36.6666V18.9246",stroke:"#758195","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),a("path",{d:"M13.8765 16.1523L9.00787 13.7965C6.33595 12.5035 5 11.8571 5 10.8334C5 9.80966 6.33595 9.16321 9.00787 7.87029L13.8765 5.51441C16.8813 4.06039 18.3838 3.33337 20 3.33337C21.6162 3.33337 23.1187 4.06037 26.1235 5.51441L30.9922 7.87029C33.664 9.16321 35 9.80966 35 10.8334C35 11.8571 33.664 12.5035 30.9922 13.7965L26.1235 16.1523C23.1187 17.6064 21.6162 18.3334 20 18.3334C18.3838 18.3334 16.8813 17.6064 13.8765 16.1523Z",stroke:"#758195","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),a("path",{d:"M10 20L13.3333 21.6667",stroke:"#758195","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),a("path",{d:"M28.3327 6.66663L11.666 15",stroke:"#758195","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])),_:1},8,["title","text"]))])),[[C,t.loading]]):g("",!0)]),t.paginate&&t.paginate.total!==0?(l(),M(v,{key:0,hide_on_single:!0,pagination:t.paginate,onFetch:i.fetchOrders},null,8,["pagination","onFetch"])):g("",!0)])],8,Zs)}const na=E(Ws,[["render",ra]]),la={name:"LicenseKey",methods:{translate:n},props:{license_key:String,show_mode:{type:String,default:"icon_with_text"},tooltip_text:{type:String,default:"Copy License Key"}},components:{CopyToClipboard:ot,IconButton:ee,DynamicIcon:U},computed:{Clipboard(){return Bt}},data(){return{}}},oa=["aria-label"],da={class:"license-key"},ca={class:"block",id:"license-key-value"};function ua(e,s,r,b,t,i){const u=h("CopyToClipboard");return l(),c("div",{class:"fct-license-key-wrap",role:"group","aria-label":i.translate("License Key")},[a("div",da,[a("span",ca,o(r.license_key),1)]),d(u,{text:r.license_key,showMode:r.show_mode,tooltipText:r.tooltip_text,"button-text":i.translate("Copy"),"aria-label":i.translate("Copy license key to clipboard"),"aria-describedby":"license-key-value"},null,8,["text","showMode","tooltipText","button-text","aria-label"])],8,oa)}const re=E(la,[["render",ua]]),ma={class:"fct-customer-dashboard-table"},ha={class:"license-only-mobile"},_a={class:"item-header"},pa={key:0,class:"fct-expiration-info"},fa={key:0,class:"text-meta"},ba={key:1,class:"text-meta"},ga=["onClick","aria-label"],ya={class:"fct-customer-orders-items-title"},va={class:"item-body"},wa={class:"fct-customer-payment-meta-info"},ka={class:"item-footer"},Ca={class:"fct-customer-orders-items-meta-wrap"},Pa={key:1,class:"text-meta"},$a={key:1,role:"alert",class:"text-center p-5"},Aa=["onClick","aria-label"],Sa={class:"fct-customer-orders-items-title"},Ma={class:"fct-customer-orders-items-meta-wrap"},Da={key:0,class:"text-meta"},Ta={key:1,class:"fct-btn-group pt-1"},Ea={class:"fct-customer-payment-meta-info"},La={key:0,class:"text-meta"},Ia={key:1,class:"text-meta"},de={__name:"LicenseTable",props:{licenses:{type:Array,required:!0},showTableHeader:{type:Boolean,default:!1},itemsColumnWidth:{type:Number,default:300},is_simple:{type:Boolean,default:!1}},setup(e){const s=It(),r=b=>{switch(b){case"completed":return n("Completed");case"paid":return n("Paid");case"active":return n("Active");case"publish":return n("Published");case"draft":return n("Draft");case"shipped":return n("Shipped");case"success":return n("Success");case"licensed":return n("Licensed");case"succeeded":return n("Succeeded");case"failed":return n("Failed");case"error":return n("Error");case"canceled":return n("Canceled");case"expired":return n("Expired");case"partially_paid":return n("Partially Paid");case"intended":return n("Intended");case"scheduled":return n("Scheduled");case"on-hold":return n("On Hold");case"pending":return n("Pending");case"unpaid":return n("Unpaid");case"warning":return n("Warning");case"processing":return n("Processing");case"future":return n("Future");case"inactive":return n("Inactive");case"dispute":return n("Dispute");case"disabled":return n("Disabled");case"beta":return n("Beta");case"subscription":return n("Subscription");case"renewal":return n("Renewal");case"payment":return n("Payment");case"unshipped":return n("Unshipped");default:return q.headline(b)}};return(b,t)=>{const i=h("el-button"),u=h("el-table-column"),p=h("el-table");return l(),c("div",ma,[a("div",ha,[e.licenses.length>0?(l(!0),c(T,{key:0},V(e.licenses,_=>(l(),c("div",{class:"license-only-mobile-item",key:_.id},[a("div",_a,[(_==null?void 0:_.status)!=="disabled"&&!e.is_simple?(l(),c("div",pa,[_.expiration_date?(l(),c("div",fa,[(_==null?void 0:_.status)==="expired"?(l(),c(T,{key:0},[w(o(A(n)("Expired at: %s",A(z)(_.expiration_date,"MMM DD, YYYY"))),1)],64)):(l(),c(T,{key:1},[w(o(A(n)("Expires on: %s",A(z)(_.expiration_date,"MMM DD, YYYY"))),1)],64))])):(l(),c("div",ba,o(A(n)("Never Expires")),1))])):g("",!0),a("div",{class:"fct-customer-orders-items fct-customer-license-orders-items cursor-pointer",onClick:y=>A(s).push({name:"manage_license",params:{license_key:_.license_key}}),"aria-label":b.$t("View details for license: %s",_.title)},[a("div",ya,o(_.title),1)],8,ga)]),a("div",va,[a("div",wa,[d(re,{license_key:_==null?void 0:_.license_key,show_mode:"basic_copy_btn",tooltip_text:A(n)("Copy Key")},null,8,["license_key","tooltip_text"])])]),a("div",ka,[a("div",Ca,[d(B,{type:_.status,"hide-icon":!0,"aria-label":b.$t("License status: %s",_.status)},{default:m(()=>[w(o(r(_.status)),1)]),_:2},1032,["type","aria-label"]),_.renewal_url?(l(),M(i,{key:0,link:"",tag:"a",href:_.renewal_url,target:"_blank",rel:"noopener noreferrer","aria-label":b.$t("Renew license: %s",_.title)},{default:m(()=>[w(o(A(n)("Renew License")),1)]),_:2},1032,["href","aria-label"])):g("",!0),_.status!=="expired"?(l(),c("div",Pa,o(_.subtitle),1)):g("",!0)])])]))),128)):(l(),c("div",$a,o(A(n)("No Licenses found")),1))]),d(p,{class:"license-only-desktop",data:e.licenses,"show-header":e.showTableHeader,role:"grid","aria-label":b.$t("Licenses table")},{default:m(()=>[d(u,{label:A(n)("Items"),width:e.itemsColumnWidth},{default:m(_=>[a("div",{class:"fct-customer-orders-items fct-customer-license-orders-items cursor-pointer",onClick:y=>A(s).push({name:"manage_license",params:{license_key:_.row.license_key}}),"aria-label":b.$t("View details for license: %s",_.row.title)},[a("div",Sa,o(_.row.title),1),a("div",Ma,[_.row.status!=="expired"?(l(),c("div",Da,o(_.row.subtitle),1)):g("",!0),d(B,{type:_.row.status,"hide-icon":!0,"aria-label":b.$t("License status: %s",_.row.status)},{default:m(()=>[w(o(r(_.row.status)),1)]),_:2},1032,["type","aria-label"]),_.row.renewal_url?(l(),c("div",Ta,[d(i,{link:"",tag:"a",href:_.row.renewal_url,target:"_blank",rel:"noopener noreferrer","aria-label":b.$t("Renew license: %s",_.row.title)},{default:m(()=>[w(o(A(n)("Renew License")),1)]),_:2},1032,["href","aria-label"])])):g("",!0)])],8,Aa)]),_:1},8,["label","width"]),d(u,{width:400,label:A(n)("License Info"),align:"right","class-name":"license-info-column"},{default:m(_=>{var y;return[a("div",Ea,[_.row.status!=="disabled"&&!e.is_simple?(l(),c(T,{key:0},[_.row.expiration_date?(l(),c("div",La,[_.row.status==="expired"?(l(),c(T,{key:0},[w(o(A(n)("Expired at: %s",A(z)(_.row.expiration_date,"MMM DD, YYYY"))),1)],64)):(l(),c(T,{key:1},[w(o(A(n)("Expires on: %s",A(z)(_.row.expiration_date,"MMM DD, YYYY"))),1)],64))])):(l(),c("div",Ia,o(A(n)("Never Expires")),1))],64)):g("",!0),d(re,{license_key:(y=_.row)==null?void 0:y.license_key,show_mode:"basic_copy_btn",tooltip_text:A(n)("Copy Key")},null,8,["license_key","tooltip_text"])])]}),_:1},8,["label"])]),_:1},8,["data","show-header","aria-label"])])}}},Va={name:"Licenses",components:{LicenseTable:de,Pagination:se,OrderTableLoader:K,EmptyState:te},data(){var e,s;return{licensesTitleId:"licenses-title",licenses:[],loading:!1,skeletonRowCount:10,paginate:{current_page:1,total:0,per_page:10},search:"",appLoaded:!1,licensesTitle:(s=(e=window.fluentcart_customer_profile_vars)==null?void 0:e.section_titles)==null?void 0:s.licenses}},methods:{fetchLicenses(){this.loading=!0,this.paginate.per_page,this.paginate.current_page,this.$get("customer-profile/licenses",{per_page:this.paginate.per_page,page:this.paginate.current_page,search:this.search}).then(e=>{this.licenses=e.licenses.data,this.paginate.total=e.licenses.total}).catch(e=>{this.handleError(e)}).finally(()=>{this.loading=!1,this.appLoaded=!0})}},mounted(){this.fetchLicenses()}},xa=["aria-labelledby","aria-busy"],Ba={class:"fct-customer-dashboard-license-inner"},Na={class:"fct-customer-dashboard-header"},Ua=["id"],Ha={key:0,"aria-live":"polite"};function Fa(e,s,r,b,t,i){const u=h("OrderTableLoader"),p=h("LicenseTable"),_=h("EmptyState"),y=h("pagination"),k=Y("loading");return l(),c("div",{class:"fct-customer-dashboard-license",role:"region","aria-labelledby":t.licensesTitleId,"aria-busy":t.loading},[a("div",Ba,[a("div",null,[a("div",Na,[a("h4",{id:t.licensesTitleId,class:"fct-customer-dashboard-title"},o(t.licensesTitle),9,Ua)]),t.loading&&!t.appLoaded?(l(),c("div",Ha,[d(u,{"rows-range":[1,2,3,4]})])):t.appLoaded&&t.paginate.total?R((l(),M(p,{key:1,licenses:t.licenses,showTableHeader:!0},null,8,["licenses"])),[[k,t.loading]]):(l(),M(_,{key:2,title:e.$t("No licenses yet"),text:e.$t("Looks like no licenses yet. Purchase something to view data.")},{icon:m(()=>s[0]||(s[0]=[a("svg",{"aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",width:"40",height:"40",viewBox:"0 0 40 40",fill:"none"},[a("path",{opacity:"0.4",d:"M20.928 2.08337C23.9908 2.08334 26.4168 2.08332 28.3157 2.33861C30.2697 2.60131 31.8512 3.15484 33.0985 4.40211C34.3458 5.64939 34.8993 7.23097 35.162 9.18501C35.4173 11.0837 35.4172 13.5097 35.4172 16.5726V23.4274C35.4172 26.4902 35.4173 28.9164 35.162 30.815C34.8993 32.769 34.3458 34.3507 33.0985 35.598C31.8512 36.8452 30.2697 37.3987 28.3157 37.6615C26.4168 37.9167 23.9908 37.9167 20.928 37.9167H19.0733C16.0105 37.9167 13.5843 37.9167 11.6856 37.6615C9.7315 37.3987 8.14992 36.8452 6.90264 35.5979C5.65537 34.3507 5.10185 32.769 4.83915 30.815C4.58389 28.9164 4.58394 26.4902 4.58399 23.4274L4.58405 16.5726C4.58405 13.5096 4.58405 11.0836 4.83934 9.18494C5.10207 7.23091 5.6556 5.64934 6.90287 4.40209C8.15014 3.15482 9.7317 2.60131 11.6857 2.33859C13.5844 2.08332 16.0104 2.08334 19.0733 2.08337H20.928Z",fill:"#758195"}),a("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M11.666 11.6667C11.666 10.7462 12.4122 10 13.3327 10H26.666C27.5865 10 28.3327 10.7462 28.3327 11.6667C28.3327 12.5871 27.5865 13.3333 26.666 13.3333H13.3327C12.4122 13.3333 11.666 12.5871 11.666 11.6667ZM11.666 20C11.666 19.0795 12.4122 18.3333 13.3327 18.3333H26.666C27.5865 18.3333 28.3327 19.0795 28.3327 20C28.3327 20.9205 27.5865 21.6667 26.666 21.6667H13.3327C12.4122 21.6667 11.666 20.9205 11.666 20ZM11.666 28.3333C11.666 27.4128 12.4122 26.6667 13.3327 26.6667H19.9993C20.9198 26.6667 21.666 27.4128 21.666 28.3333C21.666 29.2538 20.9198 30 19.9993 30H13.3327C12.4122 30 11.666 29.2538 11.666 28.3333Z",fill:"#758195"})],-1)])),_:1},8,["title","text"]))]),t.paginate&&t.paginate.total!==0?(l(),M(y,{key:0,hide_on_single:!0,pagination:t.paginate,onFetch:i.fetchLicenses},null,8,["pagination","onFetch"])):g("",!0)])],8,xa)}const Oa=E(Va,[["render",Fa]]),qa={props:{downloads:{type:Array,default:()=>[]},showTableHeader:{type:Boolean,default:!0}},components:{DynamicIcon:U},methods:{translate:n,readableFileSize(e){return Lt.readableFileSizeFromBytes(e)}}},Ra={class:"fct-customer-dashboard-table"},za={class:"fct-customer-downloads-file-info"},ja=["aria-label"],Ya=["aria-label"],Ka=["href","aria-label"];function Wa(e,s,r,b,t,i){const u=h("el-table-column"),p=h("DynamicIcon"),_=h("el-table");return l(),c("div",Ra,[d(_,{data:r.downloads,"show-header":r.showTableHeader,role:"grid","aria-label":e.$t("Downloads table")},{default:m(()=>[d(u,{label:e.$t("File Name")},{default:m(y=>{var k,f,v,C;return[a("div",za,[a("div",{class:"filename",role:"status","aria-label":`${i.translate("File name: %s",((k=y.row)==null?void 0:k.title)||"N/A")}`},o(((f=y.row)==null?void 0:f.title)||"N/A"),9,ja),y.row.file_size?(l(),c("div",{key:0,class:"text",role:"status","aria-label":`${i.translate("File size: %s",i.readableFileSize((v=y.row)==null?void 0:v.file_size))}`},o(i.readableFileSize((C=y.row)==null?void 0:C.file_size)),9,Ya)):g("",!0)])]}),_:1},8,["label"]),d(u,{align:"right"},{default:m(y=>{var k;return[a("a",{target:"_blank",class:"el-button el-button--info is-plain el-button--x-small",href:y.row.download_url,"aria-label":`Download ${((k=y.row)==null?void 0:k.title)||"file"}`,rel:"noopener noreferrer"},[d(p,{name:"Download","aria-hidden":"true",role:"presentation"}),w(" "+o(e.$t("Download")),1)],8,Ka)]}),_:1})]),_:1},8,["data","show-header","aria-label"])])}const ut=E(qa,[["render",Wa]]),Za={components:{OrderTableLoader:K,Pagination:se,DownloadsTable:ut,EmptyState:te},props:{isLimited:{type:Boolean,default:!1},per_page:{type:Number,default:10}},data(){var e,s;return{downloadsTitleId:"downloads-title",downloads:[],loading:!1,appLoaded:!1,paginate:{current_page:1,per_page:this.per_page,total:0},downloadsTitle:(s=(e=window.fluentcart_customer_profile_vars)==null?void 0:e.section_titles)==null?void 0:s.downloads}},methods:{fetchFiles(){this.loading=!0,this.$get("customer-profile/downloads",{per_page:this.paginate.per_page,page:this.paginate.current_page}).then(e=>{var s,r;this.downloads=(s=e.downloads)==null?void 0:s.data,this.paginate.total=(r=e.downloads)==null?void 0:r.total}).catch(e=>{this.handleError(e)}).finally(()=>{this.loading=!1,this.appLoaded=!0})}},mounted(){this.fetchFiles()}},Ga=["aria-labelledby","aria-busy"],Ja={class:"fct-customer-dashboard-header"},Qa=["id"],Xa={key:0,class:"actions"},ei={key:0,"aria-live":"polite"},ti={key:1,class:"fct-customer-dashboard-downloads-table","aria-live":"polite"};function si(e,s,r,b,t,i){var v;const u=h("router-link"),p=h("order-table-loader"),_=h("DownloadsTable"),y=h("EmptyState"),k=h("pagination"),f=Y("loading");return l(),c("div",{class:"fct-customer-dashboard-download",role:"region","aria-labelledby":t.downloadsTitleId,"aria-busy":t.loading||!t.appLoaded},[a("div",Ja,[a("h4",{id:t.downloadsTitleId,class:"fct-customer-dashboard-title"},o(t.downloadsTitle),9,Qa),r.isLimited?(l(),c("div",Xa,[d(u,{class:"is-link",to:{name:"downloads"},"aria-label":e.$t("View all downloads")},{default:m(()=>[w(o(e.$t("View all")),1)]),_:1},8,["aria-label"])])):g("",!0)]),t.appLoaded?t.appLoaded?R((l(),c("div",ti,[((v=t.downloads)==null?void 0:v.length)>0?(l(),M(_,{key:0,downloads:t.downloads},null,8,["downloads"])):(l(),M(y,{key:1,title:e.$t("No downloads yet"),text:e.$t("Your valid downloads will be shown here.")},{icon:m(()=>s[0]||(s[0]=[a("svg",{"aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",width:"40",height:"40",viewBox:"0 0 40 40",fill:"none"},[a("path",{opacity:"0.4",d:"M18.3328 5.41667C18.3328 4.49618 19.079 3.75 19.9995 3.75C20.92 3.75 21.6661 4.49618 21.6661 5.41667V22.998C22.0163 22.6323 22.378 22.2345 22.734 21.8245C23.4321 21.0203 24.0816 20.2106 24.5585 19.5996C24.796 19.2953 24.9885 19.0418 25.1216 18.8656C25.1881 18.7775 25.2401 18.7083 25.2746 18.6621C25.2916 18.6393 25.3036 18.6213 25.312 18.61C25.316 18.6046 25.3198 18.6013 25.3218 18.5986L25.3235 18.5953C25.8693 17.8541 26.913 17.6963 27.6541 18.2421C28.395 18.788 28.5541 19.8301 28.009 20.5713H28.0073V20.5745C28.0065 20.5756 28.0038 20.576 28.0025 20.5778C27.9996 20.5816 27.9961 20.5873 27.9911 20.5941C27.9808 20.608 27.9663 20.6285 27.9471 20.6543C27.9088 20.7058 27.8523 20.7798 27.7811 20.874C27.639 21.0623 27.4353 21.3301 27.1855 21.6503C26.6868 22.2893 25.9988 23.1465 25.2501 24.0088C24.5085 24.863 23.6738 25.76 22.8853 26.4566C22.4931 26.8031 22.0738 27.1363 21.6515 27.391C21.2748 27.618 20.6833 27.9166 19.9995 27.9166C19.3158 27.9166 18.7241 27.618 18.3475 27.391C17.9253 27.1363 17.506 26.8031 17.1138 26.4566C16.3253 25.76 15.4905 24.863 14.7489 24.0088C14.0002 23.1465 13.3122 22.2893 12.8137 21.6503C12.5637 21.3301 12.3601 21.0623 12.2179 20.874C12.1468 20.7798 12.0903 20.7058 12.0519 20.6543C12.0327 20.6285 12.0183 20.608 12.008 20.5941C12.0029 20.5871 11.9978 20.5816 11.995 20.5778C11.9939 20.5763 11.9924 20.5755 11.9917 20.5745V20.5713C11.4464 19.8301 11.6039 18.7863 12.3449 18.2406C13.086 17.6953 14.1299 17.8545 14.6756 18.5953L14.6773 18.5986C14.6792 18.6013 14.6831 18.6046 14.687 18.61C14.6954 18.6213 14.7074 18.6393 14.7245 18.6621C14.7589 18.7083 14.8109 18.7775 14.8775 18.8656C15.0106 19.0418 15.2031 19.2953 15.4406 19.5996C15.9174 20.2106 16.5669 21.0203 17.2651 21.8245C17.621 22.2345 17.9828 22.6323 18.3328 22.998V5.41667Z",fill:"black"}),a("path",{d:"M3.75 23.75V20.415L3.7614 19.987C3.98537 15.5864 7.6225 12.086 12.0785 12.0834H12.0833C13.0036 12.0834 13.7496 12.8299 13.75 13.75C13.75 14.6705 13.0038 15.4167 12.0833 15.4167H12.0801C9.32045 15.4185 7.08403 17.657 7.08333 20.4167V23.75C7.08333 25.7243 7.08512 27.1007 7.17612 28.1707C7.26538 29.2198 7.43154 29.8213 7.67417 30.2752C8.14029 31.1468 8.85484 31.8615 9.72657 32.3275C10.1803 32.5698 10.7808 32.7363 11.8294 32.8255C12.8993 32.9165 14.2758 32.9167 16.25 32.9167H23.75C25.7242 32.9167 27.1007 32.9148 28.1705 32.824C29.2195 32.7347 29.8197 32.5683 30.2734 32.3258C31.1455 31.8597 31.8597 31.1455 32.3259 30.2735C32.5684 29.8198 32.7347 29.2195 32.8239 28.1707C32.9149 27.1008 32.9167 25.7242 32.9167 23.75V20.4167C32.9167 17.6553 30.678 15.4167 27.9167 15.4167C26.9962 15.4167 26.25 14.6705 26.25 13.75C26.25 12.8296 26.9962 12.0834 27.9167 12.0834C32.519 12.0834 36.25 15.8143 36.25 20.4167V23.75C36.25 25.6665 36.2515 27.2083 36.1459 28.4522C36.0384 29.7167 35.8099 30.8252 35.2654 31.8442C34.4885 33.2973 33.2989 34.4883 31.8457 35.2653C30.8267 35.81 29.7167 36.0383 28.4522 36.1458C27.8305 36.1987 27.1344 36.2242 26.3542 36.237L23.75 36.25H16.25C14.3335 36.25 12.7917 36.2517 11.5479 36.1458C10.2831 36.0383 9.17335 35.8117 8.1543 35.267C6.70118 34.4902 5.51155 33.2988 4.7347 31.8457C4.19002 30.8268 3.96177 29.7183 3.85417 28.4538C3.74833 27.2097 3.75 25.6672 3.75 23.75Z",fill:"black"})],-1)])),_:1},8,["title","text"]))])),[[f,t.loading]]):g("",!0):(l(),c("div",ei,[d(p,{"rows-range":[1,2,3,4]})])),t.paginate.total>0?(l(),M(k,{key:2,hide_on_single:!0,pagination:t.paginate,onFetch:i.fetchFiles},null,8,["pagination","onFetch"])):g("",!0)],8,Ga)}const ai=E(Za,[["render",si]]),ii={props:["license_key"],components:{Badge:B,DynamicIcon:U,IconButton:ee},data(){return{loading:!1,activations:[],activatedSitesModal:!1}},methods:{showActivatedSitesModal(){this.activatedSitesModal=!0,this.fetchActivatedSites()},fetchActivatedSites(){this.loading=!0,this.$get(`customer-profile/licenses/${this.license_key}/activations`).then(e=>{this.activations=e.activations}).catch(e=>{this.handleError(e)}).finally(()=>{this.loading=!1})},deactivate(e){this.$post(`customer-profile/licenses/${this.license_key}/deactivate_site`,{site_url:e.site_url}).then(s=>{this.$notify.success(s.message),this.activations=this.activations.filter(r=>r.site_url!==e.site_url)}).catch(s=>{this.handleError(s)})}}},ri={id:"activated-sites-title",class:"sr-only"},ni={id:"activated-sites-description",class:"sr-only"},li=["aria-label"],oi=["id"],di={id:"delete-confirm-title",class:"sr-only"},ci={role:"alert"};function ui(e,s,r,b,t,i){const u=h("el-button"),p=h("Badge"),_=h("el-table-column"),y=h("DynamicIcon"),k=h("IconButton"),f=h("el-popconfirm"),v=h("el-table"),C=h("el-dialog"),S=Y("loading");return l(),c(T,null,[d(u,{text:"",class:"underline-link-button",onClick:i.showActivatedSitesModal,"aria-label":e.$t("View list of activated sites")},{default:m(()=>[w(o(e.$t("View List")),1)]),_:1},8,["onClick","aria-label"]),d(C,{modelValue:t.activatedSitesModal,"onUpdate:modelValue":s[0]||(s[0]=D=>t.activatedSitesModal=D),"append-to-body":!0,title:e.$t("License Activations"),"modal-class":"fct-activated-sites-modal",role:"dialog","aria-labelledby":"activated-sites-title","aria-describedby":"activated-sites-description"},{default:m(()=>{var D;return[a("h2",ri,o(e.$t("License Activations")),1),a("p",ni,o(e.$t("List of sites where the license is activated")),1),R((l(),c("div",{class:H(["fct-table-style-two fct-activated-sites-table",((D=t.activations)==null?void 0:D.length)>10?"scrollable":""]),"aria-live":"polite",id:"activated-sites-description"},[d(v,{data:t.activations,stripe:"",role:"grid","aria-label":e.$t("Table of activated sites")},{empty:m(()=>[a("span",ci,o(e.$t("No activations found for this license")),1)]),default:m(()=>[d(_,{label:e.$t("Site"),"min-width":270},{default:m($=>[a("span",null,o($.row.site_url),1),$.row.is_local!="0"?(l(),c("span",{key:0,style:{"margin-left":"10px"},role:"status","aria-label":e.$t("local")},[d(p,{status:"warning",size:"small","hide-icon":!0,text:e.$t("local")},null,8,["text"])],8,li)):g("",!0)]),_:1},8,["label"]),d(_,{label:e.$t("Status"),width:100},{default:m($=>[d(p,{status:$.row.status,size:"small","hide-icon":!0,"aria-label":`${e.$t("Status")}: ${e.$t($.row.status)}`},null,8,["status","aria-label"])]),_:1},8,["label"]),d(_,{width:60},{default:m($=>[a("span",null,[d(f,{width:235,"confirm-button-text":e.$t("Confirm"),"cancel-button-text":e.$t("No, Thanks"),"icon-color":"red",title:e.$t("Are you sure to disconnect?"),onConfirm:I=>i.deactivate($.row),"aria-labelledby":"delete-confirm-title"},{reference:m(()=>[d(k,{tag:"a",size:"x-small",hover:"danger","aria-label":e.$t("Delete activation for site"),"aria-describedby":`site-${$.$index}`},{default:m(()=>[d(y,{name:"TrashIcon"})]),_:2},1032,["aria-label","aria-describedby"])]),_:2},1032,["confirm-button-text","cancel-button-text","title","onConfirm"]),a("span",{id:`site-${$.$index}`,class:"sr-only"},o($.row.site_url),9,oi),a("span",di,o(e.$t("Are you sure to disconnect the site"))+" "+o($.row.site_url)+"? ",1)])]),_:1})]),_:1},8,["data","aria-label"])],2)),[[S,t.loading]])]}),_:1},8,["modelValue","title"])],64)}const mi=E(ii,[["render",ui]]),hi={name:"UpgradePlan",components:{CopyToClipboard:ot,DynamicIcon:U},props:{variation_id:{type:[String,Number],required:!0},order_hash:{type:String,required:!0},buttonText:{type:String,default:"Upgrade"},buttonType:{type:String,default:"default"}},data(){return{upgradePlanModal:!1,selectedUpgradePath:"",upgradePaths:[],loading:!1}},computed:{currencySign(){return this.appVars.shop.currency_sign}},methods:{translate:n,showUpgradePlanModal(){this.fetchPaths(),this.upgradePlanModal=!0},fetchPaths(){this.loading=!0,this.$get(`customer-profile/orders/${this.order_hash}/upgrade-paths`,{variation_id:this.variation_id}).then(e=>{this.upgradePaths=e.upgradePaths}).catch(e=>{this.handleError(e)}).finally(()=>{this.loading=!1})},closeUpgradePlanModal(){this.upgradePlanModal=!1}}},_i={class:"fct-upgrade-plan"},pi={id:"upgrade-dialog-title",class:"sr-only"},fi={key:0,class:"fct-upgrade-variation-table pb-10"},bi={class:"upgrade-title"},gi={class:"plan-price"},yi={class:"plan-price"},vi={class:"upgrade-cost"},wi={class:"upgrade-title"},ki=["innerHTML"],Ci={class:"upgrade-action"},Pi={key:1,role:"status","aria-live":"polite"},$i={key:2,role:"alert","aria-live":"assertive"};function Ai(e,s,r,b,t,i){const u=h("el-button"),p=h("el-table-column"),_=h("el-table"),y=h("el-skeleton"),k=h("el-dialog");return l(),c("div",_i,[d(u,{type:r.buttonType,size:"small",onClick:i.showUpgradePlanModal,"aria-label":r.buttonText},{default:m(()=>[w(o(r.buttonText),1)]),_:1},8,["type","onClick","aria-label"]),d(k,{modelValue:t.upgradePlanModal,"onUpdate:modelValue":s[0]||(s[0]=f=>t.upgradePlanModal=f),"append-to-body":!0,title:e.$t("Upgrade Options"),class:"fct-upgrade-plan-dialog fluent-cart-customer-profile-app",role:"dialog","aria-modal":"true","aria-labelledby":"upgrade-dialog-title"},{default:m(()=>[a("h2",pi,o(e.$t("Upgrade Options")),1),t.upgradePaths.length>0?(l(),c("div",fi,[d(_,{data:t.upgradePaths,"aria-label":i.translate("Upgrade options table")},{default:m(()=>[d(p,{label:i.translate("Package"),width:290,"aria-label":i.translate("Package")},{default:m(f=>[a("div",bi,o(f.row.title),1)]),_:1},8,["label","aria-label"]),d(p,{label:i.translate("Price"),width:100,"aria-label":i.translate("Price")},{default:m(f=>[a("div",gi,[a("div",yi,o(e.formatNumber(f.row.original_price,f.row.currency)),1)])]),_:1},8,["label","aria-label"]),d(p,{label:i.translate("Amount to pay"),width:200,"aria-label":i.translate("Amount to pay")},{default:m(f=>[a("div",vi,[a("div",wi,[a("span",{innerHTML:f.row.payment_summary},null,8,ki)])])]),_:1},8,["label","aria-label"]),d(p,{label:i.translate("Action"),width:110,"aria-label":i.translate("Action")},{default:m(f=>[a("div",Ci,[d(u,{class:"el-button--x-small",tag:"a",href:f.row.upgrade_url,target:"_blank",rel:"noopener noreferrer","aria-label":e.$t("Upgrade to")+" "+f.row.title},{default:m(()=>[w(o(e.$t("Upgrade")),1)]),_:2},1032,["href","aria-label"])])]),_:1},8,["label","aria-label"])]),_:1},8,["data","aria-label"])])):t.loading?(l(),c("div",Pi,[d(y,{animated:!0,rows:2})])):(l(),c("div",$i,o(i.translate("No upgrade found for this purchase")),1))]),_:1},8,["modelValue","title"])])}const mt=E(hi,[["render",Ai]]),Si={name:"LicenseDetails",components:{UpgradePlan:mt,Badge:B,LicenseKey:re,ActivatedSites:mi},data(){return{licenseDetailsTitleId:"license-details-title",license:null,loading:!1,sectionParts:{}}},props:{license_key:{type:String,required:!0}},methods:{fetchLicense(){this.loading=!0,this.$get("customer-profile/licenses/"+this.license_key).then(e=>{this.license=e.license,e.section_parts&&(this.sectionParts=e.section_parts)}).catch(e=>{this.$notify.error(e)}).finally(()=>{this.loading=!1})}},mounted(){this.fetchLicense()}},Mi=["aria-labelledby","aria-busy"],Di={class:"fct-customer-dashboard-single-subscription"},Ti=["aria-label"],Ei=["aria-labelledby"],Li={key:0,class:"fct-renew-box mb-4"},Ii={class:"text-center p-4"},Vi={class:"p-0 m-0 mb-3"},xi=["href","aria-label"],Bi=["innerHTML"],Ni={class:"fct-single-order-box"},Ui={class:"fct-single-order-header"},Hi=["id"],Fi={class:"fct-single-order-body"},Oi={class:"fct-single-order-box-inner"},qi={class:"fct-customer-dashboard-content-table-item border-0 pb-0"},Ri={class:"left-content"},zi={class:"fct-product-info-card"},ji={class:"fct-product-info-card-inner"},Yi={class:"product-info-content"},Ki={class:"title truncate-none"},Wi={class:"variation-title"},Zi={class:"right-content"},Gi={class:"fct-customer-dashboard-content-table-item border-0 pb-0"},Ji={class:"left-content"},Qi={class:"title"},Xi={class:"fct-customer-dashboard-content-table-item border-0 pb-0"},er={class:"left-content"},tr={class:"title"},sr={class:"flex items-center gap-2"},ar={key:0,class:"text"},ir={key:1,class:"text"},rr={class:"fct-customer-dashboard-content-table-item border-0 pb-0"},nr={class:"left-content"},lr={class:"title"},or={class:"text"},dr=["innerHTML"],cr={class:"fct-single-order-footer mt-3"},ur={class:"flex items-center gap-3"},mr=["innerHTML"],hr=["innerHTML"],_r={key:1,class:"fct-customer-dashboard-loader","aria-live":"polite"},pr={key:2,class:"fct-customer-dashboard-no-data",role:"alert"};function fr(e,s,r,b,t,i){var D,$,I,P,x,F;const u=h("el-breadcrumb-item"),p=h("el-breadcrumb"),_=h("el-alert"),y=h("Badge"),k=h("LicenseKey"),f=h("ActivatedSites"),v=h("UpgradePlan"),C=h("router-link"),S=h("el-skeleton");return l(),c("div",{class:"fct-customer-dashboard-manage-license-wrap fct-customer-dashboard-layout-width",role:"main","aria-labelledby":t.licenseDetailsTitleId,"aria-busy":t.loading},[a("div",Di,[a("div",{class:"fct-customer-dashboard-breadcrumb mb-8",role:"navigation","aria-label":e.$t("Breadcrumb")},[d(p,null,{default:m(()=>[d(u,{class:"cursor-pointer",to:{path:"/licenses"}},{default:m(()=>[w(o(e.$t("Licenses")),1)]),_:1}),d(u,null,{default:m(()=>[w(o(r.license_key),1)]),_:1})]),_:1})],8,Ti),t.license?(l(),c("div",{key:0,"aria-labelledby":t.licenseDetailsTitleId},[t.license.renewal_url&&t.license.status==="expired"?(l(),c("div",Li,[d(_,{type:"error",closable:!1,role:"alert","aria-live":"assertive"},{default:m(()=>[a("div",Ii,[a("p",Vi,"Your license has been expired at "+o(e.formatDate(t.license.expiration_date))+". Please renew the license for getting updates and support.",1),a("a",{href:t.license.renewal_url,class:"el-button el-button--primary","aria-label":e.$t("Renew License")},o(e.$t("Renew License")),9,xi)])]),_:1})])):g("",!0),t.sectionParts.before_summary?(l(),c("div",{key:1,innerHTML:t.sectionParts.before_summary},null,8,Bi)):g("",!0),a("article",Ni,[a("header",Ui,[a("h1",{id:t.licenseDetailsTitleId,class:"title"},o(e.$t("License Details")),9,Hi)]),a("div",Fi,[a("div",Oi,[a("div",qi,[a("div",Ri,[a("div",zi,[a("div",ji,[a("div",Yi,[a("div",Ki,o(t.license.title),1),a("div",Wi,o(t.license.subtitle),1)])])])]),a("div",Zi,[d(y,{status:t.license.status},null,8,["status"])])]),a("div",Gi,[a("div",Ji,[a("div",Qi,o(e.$t("License Key")),1),d(k,{license_key:r.license_key},null,8,["license_key"])])]),a("div",Xi,[a("div",er,[a("div",tr,o(e.$t("Activations")),1),a("div",sr,[!((D=t.license)!=null&&D.limit)||Number(($=t.license)==null?void 0:$.limit)===0?(l(),c("span",ar,o(e.$t("%s / Unlimited",(I=t.license)==null?void 0:I.activation_count)),1)):(l(),c("span",ir,o(e.$t("%1$s / %2$s",(P=t.license)==null?void 0:P.activation_count,(x=t.license)==null?void 0:x.limit)),1)),t.license.license_key?(l(),M(f,{key:2,license_key:(F=t.license)==null?void 0:F.license_key},null,8,["license_key"])):g("",!0)])]),s[0]||(s[0]=a("div",{class:"right-content"},null,-1))]),a("div",rr,[a("div",nr,[a("div",lr,o(e.$t("Expiration Date")),1),a("div",or,o(t.license.expiration_date?e.formatDate(t.license.expiration_date,!0):e.$t("Never Expires")),1)])]),t.sectionParts.end_of_details?(l(),c("div",{key:0,innerHTML:t.sectionParts.end_of_details},null,8,dr)):g("",!0)])]),a("footer",cr,[a("div",ur,[t.license.has_upgrades?(l(),M(v,{key:0,"button-type":"primary","button-text":e.$t("Upgrade Plan"),variation_id:t.license.variation_id,order_hash:t.license.order.uuid,"aria-label":e.$t("Upgrade Plan")},null,8,["button-text","variation_id","order_hash","aria-label"])):g("",!0),d(C,{class:"underline-link-button",to:{name:"view_order",params:{order_id:t.license.order.uuid}},"aria-label":e.$t("View Order")},{default:m(()=>[w(o(e.$t("View Order")),1)]),_:1},8,["to","aria-label"]),t.sectionParts.additional_actions?(l(),c("span",{key:1,innerHTML:t.sectionParts.additional_actions},null,8,mr)):g("",!0)])])]),t.sectionParts.after_summary?(l(),c("div",{key:2,innerHTML:t.sectionParts.after_summary},null,8,hr)):g("",!0)],8,Ei)):t.loading?(l(),c("div",_r,[d(S,{rows:5,animated:""})])):(l(),c("div",pr,[a("p",null,o(e.$t("License could not be loaded. Please try again.")),1)]))])],8,Mi)}const br=E(Si,[["render",fr]]),gr={name:"PaymentInfo",props:{data:Object}},yr={"aria-labelledby":"payment-info-heading",role:"region"},vr={id:"payment-info-heading",class:"sr-only"},wr=["innerHTML"];function kr(e,s,r,b,t,i){var u,p;return l(),c("div",yr,[a("h2",vr,o(e.$t("Payment details")),1),(u=r.data)!=null&&u.payment_info?(l(),c("div",{key:0,class:"fct-customer-payment-info",innerHTML:(p=r.data)==null?void 0:p.payment_info},null,8,wr)):g("",!0)])}const Cr=E(gr,[["render",kr]]),Pr=["aria-label"],$r=["src","alt"],Ar=["src","alt"],Sr=["aria-label"],Mr=["aria-label"],Dr={__name:"CardInfo",props:{data:Object,showPaymentInfo:Boolean},setup(e){const s=wt(()=>window.fluentcart_customer_profile_vars.assets_path);return(r,b)=>{var t,i,u,p,_,y,k,f,v,C,S,D,$,I,P,x,F,W,Z;return e.data?(l(),c("div",{key:0,class:"fct-card-info",role:"status","aria-label":r.$t("Payment method information")},[((t=e.data)==null?void 0:t.current_payment_method)==="paypal"||((i=e.data)==null?void 0:i.payment_method)==="paypal"?(l(),c("img",{key:0,src:`${s.value}images/payment-methods/paypal-icon.svg`,alt:r.$t("PayPal logo"),role:"presentation"},null,8,$r)):(_=(p=(u=e.data)==null?void 0:u.billing_info)==null?void 0:p.details)!=null&&_.last_4||(y=e.data)!=null&&y.card_last_4?(l(),c(T,{key:1},[a("img",{src:`${s.value}images/credit-card/card.svg`,alt:r.$t("Credit card icon"),role:"presentation","aria-hidden":"true"},null,8,Ar),a("div",{class:"text","aria-label":r.$t("Credit card number")+" "+(((v=(f=(k=e.data)==null?void 0:k.billing_info)==null?void 0:f.details)==null?void 0:v.last_4)||((C=e.data)==null?void 0:C.card_last_4))}," **** "+o((($=(D=(S=e.data)==null?void 0:S.billing_info)==null?void 0:D.details)==null?void 0:$.last_4)||((I=e.data)==null?void 0:I.card_last_4)),9,Sr)],64)):((P=e.data)==null?void 0:P.current_payment_method)=="offline_payment"?(l(),c("div",{key:2,class:"text",role:"status","aria-label":`${A(q).headline((x=e.data)==null?void 0:x.current_payment_method)||A(q).headline((F=e.data)==null?void 0:F.payment_method)} payment method`},o(A(q).headline((W=e.data)==null?void 0:W.current_payment_method)||A(q).headline((Z=e.data)==null?void 0:Z.payment_method)),9,Mr)):g("",!0)],8,Pr)):g("",!0)}}},Tr={name:"SubscriptionTable",components:{PaymentInfo:Cr,CardInfo:Dr,Badge:B},props:{subscriptions:{type:Array,required:!0},hideHeader:{type:Boolean,default:!1}},methods:{dateTimeI18:z,translate:n,subscriptionStatus(e){return e!=null&&e.overridden_status?e==null?void 0:e.overridden_status:e==null?void 0:e.status},getStatusText(e){switch(e){case"completed":return n("Completed");case"paid":return n("Paid");case"active":return n("Active");case"publish":return n("Published");case"draft":return n("Draft");case"shipped":return n("Shipped");case"success":return n("Success");case"licensed":return n("Licensed");case"succeeded":return n("Succeeded");case"failed":return n("Failed");case"error":return n("Error");case"canceled":return n("Canceled");case"expired":return n("Expired");case"partially_paid":return n("Partially Paid");case"intended":return n("Intended");case"scheduled":return n("Scheduled");case"on-hold":return n("On Hold");case"pending":return n("Pending");case"unpaid":return n("Unpaid");case"warning":return n("Warning");case"processing":return n("Processing");case"future":return n("Future");case"inactive":return n("Inactive");case"dispute":return n("Dispute");case"disabled":return n("Disabled");case"beta":return n("Beta");default:return q.headline(e)}}}},Er={class:"fct-customer-dashboard-table"},Lr={class:"subscription-only-mobile"},Ir={class:"item-header"},Vr={key:0,class:"text","aria-live":"polite"},xr={class:"item-body"},Br=["onClick","aria-label"],Nr={class:"fct-customer-orders-items-title"},Ur={class:"item-footer"},Hr={class:"item-footer-content"},Fr={key:1,class:"text-center p-5",role:"alert","aria-live":"polite"},Or=["onClick","aria-label"],qr={class:"fct-customer-orders-items-title"},Rr={class:"fct-customer-orders-items-meta-wrap"},zr={key:0,class:"text-meta","aria-live":"polite"},jr={class:"fct-customer-payment-meta-info"};function Yr(e,s,r,b,t,i){const u=h("CardInfo"),p=h("Badge"),_=h("PaymentInfo"),y=h("el-table-column"),k=h("el-table");return l(),c("div",Er,[a("div",Lr,[r.subscriptions.length>0?(l(!0),c(T,{key:0},V(r.subscriptions,f=>(l(),c("div",{class:"subscription-only-mobile-item",key:f.id},[a("div",Ir,[d(u,{data:f,"show-payment-info":e.showPaymentInfo},null,8,["data","show-payment-info"]),f.status!=="expired"&&f.status!=="canceled"&&f.status!=="completed"?(l(),c("div",Vr,o(e.$t("Auto renews on %s",i.dateTimeI18(f.next_billing_date))),1)):g("",!0)]),a("div",xr,[a("div",{class:"fct-customer-orders-items fct-customer-sub-orders-items cursor-pointer",onClick:v=>e.$router.push({name:"view_subscription",params:{subscription_uuid:f.uuid}}),"aria-label":e.$t("View subscription details for")+" "+f.item_name},[a("div",Nr,o(f.item_name),1)],8,Br)]),a("div",Ur,[a("div",Hr,[d(p,{status:i.subscriptionStatus(f),"hide-icon":!0,size:"small"},null,8,["status"]),d(_,{data:f},null,8,["data"])])])]))),128)):(l(),c("div",Fr,o(i.translate("No subscription plans found!")),1))]),d(k,{class:"subscription-only-desktop",data:r.subscriptions,"show-header":!r.hideHeader,role:"table"},{default:m(()=>[d(y,{"min-width":200,label:e.$t("Item")},{default:m(f=>[a("div",{class:"fct-customer-orders-items fct-customer-sub-orders-items cursor-pointer",onClick:v=>e.$router.push({name:"view_subscription",params:{subscription_uuid:f.row.uuid}}),"aria-label":e.$t("View subscription details for")+" "+f.row.item_name},[a("div",qr,o(f.row.item_name),1),a("div",Rr,[d(p,{"hide-icon":!0,type:f.row.status,size:"small","aria-hidden":"true"},{default:m(()=>[w(o(i.getStatusText(f.row.status)),1)]),_:2},1032,["type"]),f.row.status!=="expired"&&f.row.status!=="canceled"&&f.row.status!=="completed"?(l(),c("div",zr,o(e.$t("Auto renews on %s",i.dateTimeI18(f.row.next_billing_date,"DD MMM, YYYY"))),1)):g("",!0)])],8,Or)]),_:1},8,["label"]),d(y,{"min-width":"200",label:e.$t("Plan"),align:"right"},{default:m(f=>[a("div",jr,[d(_,{data:f.row},null,8,["data"]),d(u,{data:f.row},null,8,["data"])])]),_:1},8,["label"])]),_:1},8,["data","show-header"])])}const ht=E(Tr,[["render",Yr]]),Kr={name:"SubscriptionPlans",components:{OrderTableLoader:K,Badge:B,Pagination:se,SubscriptionTable:ht,EmptyState:te},props:{showLimit:{type:Number,default:10},showViewAllLink:{type:Boolean,default:!1}},data(){return{loading:!1,appLoaded:!1,subscriptions:[],canceling_subscription:!1,paginate:{current_page:1,per_page:10,total:0}}},methods:{subscriptionStatus(e){return e!=null&&e.overridden_status?e==null?void 0:e.overridden_status:e==null?void 0:e.status},modifySubscriptionResponse(e){return e.map(s=>{var r,b;return{...s,card_last_4:(b=(r=s==null?void 0:s.billingInfo)==null?void 0:r.card)==null?void 0:b.last_4}})},fetchSubscriptions(){this.loading=!0,this.$get("customer-profile/subscriptions",{per_page:this.paginate.per_page,page:this.paginate.current_page}).then(e=>{this.subscriptions=e.subscriptions.data,this.paginate.total=e.subscriptions.total}).finally(()=>{this.appLoaded=!0,this.loading=!1})},cancelSubscription(e,s,r){ElMessageBox.confirm(n("It will permanently cancel the active subscription from your payment provider. Are you sure to do that?"),n("Warning"),{type:"warning",cancelButtonText:n("No, keep this!"),confirmButtonText:n("Yes cancel this subscription!")}).then(()=>{this.canceling_subscription=!0,this.$put(`orders/${r}/subscriptions/${e}/cancel`,{data:{vendor_charge_id:s}}).then(()=>{this.canceling_subscription=!1,this.fetchSubscriptions()}).catch(b=>{this.canceling_subscription=!1,console.log(b)})})}},mounted(){this.fetchSubscriptions()}},Wr={class:"fct-customer-dashboard-subscriptions",role:"main","aria-labelledby":"subscriptions-title"},Zr={class:"fct-customer-dashboard-subscriptions-inner"},Gr={class:"fct-customer-dashboard-header"},Jr={id:"subscriptions-title",class:"fct-customer-dashboard-title"},Qr={key:1,class:"fct-customer-dashboard-loading","aria-live":"polite","aria-busy":"true"};function Xr(e,s,r,b,t,i){const u=h("SubscriptionTable"),p=h("OrderTableLoader"),_=h("EmptyState"),y=h("pagination");return l(),c("div",Wr,[a("div",Zr,[a("header",Gr,[a("h4",Jr,o(e.$t("Subscription Plans")),1)]),t.subscriptions.length?(l(),M(u,{key:0,subscriptions:t.subscriptions,"aria-label":e.$t("Subscription plans table")},null,8,["subscriptions","aria-label"])):t.loading?(l(),c("div",Qr,[d(p,{"rows-range":[1,2,3,4,5]})])):(l(),M(_,{key:2,title:e.$t("No subscriptions yet"),text:e.$t("Once you subscribe to a plan, it will appear here."),role:"status"},{icon:m(()=>s[0]||(s[0]=[a("svg",{xmlns:"http://www.w3.org/2000/svg",width:"40",height:"40",viewBox:"0 0 40 40",fill:"none","aria-hidden":"true"},[a("path",{d:"M33.5429 11.9789C34.291 11.4426 35.3322 11.6143 35.8685 12.3624C37.4175 14.5232 38.3297 17.1585 38.3297 20.0001C38.3297 27.4066 32.172 33.3335 24.6727 33.3335H14.349V35C14.3491 35.419 14.1921 35.8383 13.8769 36.1623C13.235 36.8221 12.1798 36.8365 11.5201 36.1946L9.84873 34.5685C9.53043 34.259 9.11337 33.8536 8.86883 33.5373C8.65405 33.2595 8.03432 32.3905 8.48888 31.3226C8.93338 30.2785 9.96332 30.1015 10.3062 30.0543C10.7031 29.9996 11.2015 29.9998 11.6536 30.0001H11.7377H24.6727C30.4177 30.0001 34.9963 25.4803 34.9963 20.0001C34.9963 17.8841 34.3197 15.9231 33.1593 14.3045C32.623 13.5564 32.7949 12.5152 33.5429 11.9789Z",fill:"black"}),a("path",{opacity:"0.4",d:"M6.45682 28.0212C5.7087 28.5575 4.66751 28.3857 4.13121 27.6377C2.58217 25.4768 1.66992 22.8415 1.66992 20C1.66992 12.5934 7.82769 6.66658 15.327 6.66658H25.6507V5.00005C25.6507 4.58106 25.8075 4.16166 26.1228 3.83765C26.7647 3.17793 27.8198 3.16348 28.4797 3.8054L30.151 5.43163C30.4692 5.741 30.8863 6.1464 31.1308 6.46268C31.3457 6.74053 31.9653 7.60961 31.5108 8.67741C31.0663 9.72158 30.0363 9.89861 29.6935 9.94578C29.2965 10.0004 28.7982 10.0002 28.3462 9.99995L28.262 9.99991H15.327C9.58204 9.99991 5.00326 14.5198 5.00326 20C5.00326 22.1158 5.67996 24.0768 6.84032 25.6955C7.37662 26.4437 7.20492 27.4848 6.45682 28.0212Z",fill:"black"})],-1)])),_:1},8,["title","text"])),t.paginate.total?(l(),M(y,{key:3,hide_on_single:!0,pagination:t.paginate,onFetch:i.fetchSubscriptions,"aria-label":e.$t("Subscription pagination")},null,8,["pagination","onFetch","aria-label"])):g("",!0)])])}const en=E(Kr,[["render",Xr]]),tn=["id"],sn=["for"],an=["id","type","aria-describedby","aria-required"],rn=["src","id"],_t={__name:"InputField",props:{id:String,label:String,type:{type:String,default:"text"},imageUrl:{type:String,default:""},modelValue:{type:[String,Number],default:null}},emits:["update:modelValue","change","input"],setup(e,{emit:s}){const r=kt().ctx,b=N(!1);N();const t=e,i=s,u=N(t.modelValue),p=f=>{b.value=f},_=f=>{r.$refs.input.value?b.value=!0:b.value=f},y=()=>{i("update:modelValue",u.value),i("change",u.value)},k=()=>{i("update:modelValue",u.value),i("input",u.value)};return ne(()=>t.modelValue,f=>{u.value=f}),ie(()=>{b.value=!!u.value}),ie(()=>{b.value=!!u.value}),(f,v)=>(l(),c("div",{class:H(["form-input-group",{"is-focused":b.value}]),id:e.id,role:"group"},[e.label?(l(),c("label",{key:0,for:e.id},o(e.label),9,sn)):g("",!0),R(a("input",{id:e.id,type:e.type,ref:"input","onUpdate:modelValue":v[0]||(v[0]=C=>u.value=C),onFocus:v[1]||(v[1]=C=>p(!0)),onBlur:v[2]||(v[2]=C=>_(!1)),onChange:y,onInput:k,"aria-describedby":e.imageUrl?`${e.id}-icon`:null,"aria-required":f.required||!1},null,40,an),[[Ct,u.value]]),e.imageUrl?(l(),c("img",{key:1,src:e.imageUrl,alt:"",id:`${e.id}-icon`,"aria-hidden":"true"},null,8,rn)):g("",!0)],10,tn))}},nn=["id"],ln={disabled:"",value:""},on=["value"],dn={__name:"SelectField",props:{id:String,options:{type:Array,required:!0,default:()=>[]},modelValue:{type:[String,Number],default:null},placeholder:{type:String,default:"Please select an option"}},emits:["update:modelValue"],setup(e,{emit:s}){const r=e,b=s,t=N(r.modelValue);ne(()=>r.modelValue,u=>{t.value=u});const i=()=>{b("update:modelValue",t.value)};return(u,p)=>(l(),c("div",{class:"form-input-group",id:e.id},[R(a("select",{"onUpdate:modelValue":p[0]||(p[0]=_=>t.value=_),onChange:i},[a("option",ln,o(e.placeholder),1),(l(!0),c(T,null,V(e.options,(_,y)=>(l(),c("option",{key:y,value:_.value},o(_.label),9,on))),128))],544),[[Pt,t.value]])],8,nn))}},cn=()=>new Promise((e,s)=>{if(window.Stripe)e(window.Stripe);else{const r=document.createElement("script");r.src="https://js.stripe.com/v3/",r.async=!0,document.head.appendChild(r),r.onload=()=>{e(window.Stripe)},r.onerror=()=>{s(new Error("Failed to load Stripe script"))}}}),un={components:{InputField:_t,SelectField:dn,ArrowDown:Ft,ArrowUp:Ot},props:{subscription:{type:Object,required:!0},updateMethod:{type:Boolean,required:!0,default:!0}},data(){var e;return{currentPaymentMethod:"",cardNumber:null,cardExpiry:null,cardCvc:null,selectedAddress:"",updating:!1,switching:!1,reactivating:!1,invalidCard:!1,elementStates:{cardNumber:!1,cardExpiry:!1,cardCvc:!1},elementStyle:{base:{fontSize:"16px",color:"#32325d","::placeholder":{color:"#aab7c4"}},invalid:{color:"#fa755a"}},editing:!0,stripe:null,stripePubKey:(e=window.fluentcart_customer_profile_vars)==null?void 0:e.stripe_pub_key,loading:!1,errorMessage:"",successMessage:""}},computed:{getBillingAddresses(){return this.subscription.billing_addresses||[{}]}},methods:{translate:n,handleElementChange(e){this.elementStates[e.elementType]=e.complete,this.invalidCard=!(this.elementStates.cardNumber&&this.elementStates.cardExpiry&&this.elementStates.cardCvc)},async loadAndMountStripeElements(){this.loading=!0;let e=null;try{e=await cn()}catch(r){this.handleError((r==null?void 0:r.message)||n("Error in loading stripe")),this.loading=!1}this.stripe=e(this.stripePubKey);const s=this.stripe.elements();this.cardNumber=s.create("cardNumber",{style:this.elementStyle,showIcon:!0}),this.cardNumber.mount("#card-number"),this.cardExpiry=s.create("cardExpiry",{style:this.elementStyle}),this.cardExpiry.mount("#card-expiry"),this.cardCvc=s.create("cardCvc",{style:this.elementStyle}),this.cardCvc.mount("#card-cvc"),this.loading=!1,this.cardNumber.on("change",this.handleElementChange),this.cardExpiry.on("change",this.handleElementChange),this.cardCvc.on("change",this.handleElementChange)},processNewPaymentMethod(){this.save()},async save(){this.updating=!0;const e=await this.createPaymentMethod();e&&this.currentPaymentMethod=="stripe"?this.updatePaymentMethodInStripe(e,"verify"):e&&this.currentPaymentMethod!="stripe"&&this.switchPaymentMethod(e,"verify")},async switchPaymentMethod(e,s="verify",r=""){var b;this.switching=!0,this.errorMessage="";try{const t=await this.$post("customer-profile/subscriptions/"+((b=this.subscription)==null?void 0:b.uuid)+"/switch-payment-method",{data:{newPaymentMethod:"stripe",currentPaymentMethod:this.currentPaymentMethod,vendorPaymentMethod:e,verification_status:s,customer_id:r},_fluentCart_rest_nonce:window.fluentCartRestVars.rest.nonce});if((t==null?void 0:t.status)==="requires_action"){const{setupIntent:i,error:u}=await this.stripe.confirmCardSetup(t==null?void 0:t.client_secret,{payment_method:e.id});if(u){this.errorMessage=u.message||n("Card verification failed"),this.switching=!1;return}i.status==="succeeded"?await this.switchPaymentMethod(e,"verified",t==null?void 0:t.customer_id):(this.errorMessage=n("Card verification failed"),this.switching=!1)}else(t==null?void 0:t.status)==="failed"?(this.resetData(),this.errorMessage=(t==null?void 0:t.message)||n("Card verification failed"),this.switching=!1,this.handleError(this.errorMessage)):(t==null?void 0:t.status)==="success"?(this.resetData(),this.handleSuccess(n("Payment method updated Successfully!")),this.successMessage=n("Payment method updated Successfully!"),this.closeUpdatePaymentModal(),this.$emit("fetchSubscription")):(this.resetData(),this.errorMessage=(t==null?void 0:t.message)||n("Something went wrong"),this.handleError((error==null?void 0:error.message)||n("Error in switching payment method")))}catch(t){this.resetData(),this.errorMessage=(t==null?void 0:t.message)||n("Something went wrong"),this.handleError((t==null?void 0:t.message)||n("Error in switching payment method")),this.switching=!1}finally{this.switching=!1}},async createPaymentMethod(){const e=this.getBillingAddresses.find(s=>s.id==this.selectedAddress);try{const{paymentMethod:s,error:r}=await this.stripe.createPaymentMethod({type:"card",card:this.cardNumber,billing_details:{name:e.name,email:e.email,phone:e.phone,address:{country:e.country,line1:e.address_1,line2:e.address_2,city:e.city,state:e.state,postal_code:e.postcode}}});return s}catch(s){this.errorMessage=(s==null?void 0:s.message)||n("Error in creating payment method"),this.resetData(),this.handleError(this.errorMessage)}},async updatePaymentMethodInStripe(e,s="verify"){this.updating=!0,this.errorMessage="";try{console.log("update...payment method",this.updateMethod,this.subscription);const r=await this.$post(`customer-profile/subscriptions/${this.subscription.uuid}/update-payment-method`,{data:{newPaymentMethod:e,method:"stripe",vendor_subscription_id:this.subscription.vendor_subscription_id,verification_status:s},_fluentCart_rest_nonce:window.fluentCartRestVars.rest.nonce});if((r==null?void 0:r.status)==="requires_action"){const{setupIntent:b,error:t}=await this.stripe.confirmCardSetup(r==null?void 0:r.client_secret,{payment_method:e.id});if(t){this.errorMessage=t.message||n("Card verification failed"),this.updating=!1;return}b.status==="succeeded"?await this.updatePaymentMethodInStripe(e,"verified"):(this.errorMessage=n("Card verification failed"),this.updating=!1)}else(r==null?void 0:r.status)==="failed"?(this.errorMessage=(r==null?void 0:r.message)||n("Card verification failed"),this.resetData(),this.handleError(this.errorMessage)):(r==null?void 0:r.status)==="success"?(this.handleSuccess(n("Payment method updated Successfully!")),this.resetData(),this.closeUpdatePaymentModal(),this.$emit("fetchSubscription")):(this.errorMessage=(r==null?void 0:r.message)||n("Something went wrong"),this.resetData(),this.handleError((error==null?void 0:error.message)||n("Error in updating payment method")))}catch(r){this.errorMessage=(r==null?void 0:r.message)||n("Something went wrong"),this.handleError((r==null?void 0:r.message)||n("Error in updating payment method")),this.updating=!1}},resetData(){this.cardNumber.clear(),this.cardExpiry.clear(),this.cardCvc.clear(),this.updating=!1,this.switching=!1,this.reactivating=!1,this.editing=!1,this.errorMessage=""},closeUpdatePaymentModal(){this.resetData(),this.$emit("close")}},mounted(){var s,r;this.$nextTick(()=>{this.loadAndMountStripeElements()}),console.log("update...payment method mounted",this.updateMethod),this.invalidCard=!0,this.currentPaymentMethod=(s=this.subscription)==null?void 0:s.current_payment_method;const e=(r=this.getBillingAddresses)==null?void 0:r.find(b=>b.is_primary);e&&(this.selectedAddress=e.id)}},mn={role:"form","aria-labelledby":"stripe-payment-heading"},hn={id:"stripe-payment-heading",class:"sr-only"},_n={class:"stripe-card-form"},pn={class:"form-group"},fn={class:"form-row col-2"},bn={class:"form-group"},gn={for:"card-expiry"},yn={class:"form-group"},vn={for:"card-cvc"},wn={class:"fct-update-payment-form-item"},kn={class:"form-heading"},Cn={class:"form-input-container"},Pn={for:"billing-select",class:"sr-only"},$n={id:"billing-help",class:"sr-only"},An={key:1},Sn={class:"text-red-500"},Mn={key:0,class:"error-message",role:"alert","aria-live":"assertive"},Dn={key:1,class:"success-message",role:"alert","aria-live":"assertive"},Tn={class:"dialog-footer"};function En(e,s,r,b,t,i){const u=h("el-option"),p=h("el-select"),_=h("el-button"),y=Y("loading");return l(),c("div",mn,[a("h2",hn,o(i.translate("Stripe Payment Method")),1),R((l(),c("div",_n,[a("div",pn,[a("label",null,o(i.translate("Card Number")),1),s[2]||(s[2]=a("div",{id:"card-number",class:"stripe-element","aria-describedby":"card-errors"},null,-1))]),a("div",fn,[a("div",bn,[a("label",gn,o(i.translate("MM/YY")),1),s[3]||(s[3]=a("div",{id:"card-expiry",class:"stripe-element","aria-describedby":"card-errors"},null,-1))]),a("div",yn,[a("label",vn,o(i.translate("CVC")),1),s[4]||(s[4]=a("div",{id:"card-cvc",class:"stripe-element","aria-describedby":"card-errors"},null,-1))])]),s[5]||(s[5]=a("div",{id:"card-errors",class:"sr-only",role:"alert","aria-live":"assertive"},null,-1))])),[[y,t.loading]]),a("div",wn,[a("h3",kn,o(i.translate("Billing Address")),1),a("div",Cn,[i.getBillingAddresses.length?(l(),c(T,{key:0},[a("label",Pn,o(i.translate("Select billing address")),1),d(p,{id:"billing-select",modelValue:t.selectedAddress,"onUpdate:modelValue":s[0]||(s[0]=k=>t.selectedAddress=k),placeholder:i.translate("Select"),"aria-describedby":"billing-help"},{default:m(()=>[(l(!0),c(T,null,V(i.getBillingAddresses,k=>(l(),M(u,{key:k.id,label:e.getAddress(k.formatted_address),value:k.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"]),a("small",$n,o(i.translate("Choose an existing billing address or add a new one in profile settings.")),1)],64)):(l(),c("span",An,[a("span",Sn,o(i.translate("No billing address found,")),1),w(" "+o(i.translate("please add a new address from"))+" ",1),a("span",{class:"cursor-pointer text-system-dark underline font-medium",onClick:s[1]||(s[1]=k=>e.$router.push({name:"profile"})),role:"link",tabindex:"0"},o(i.translate("here")),1)]))])]),t.errorMessage?(l(),c("div",Mn,o(t.errorMessage),1)):g("",!0),t.successMessage?(l(),c("div",Dn,o(t.successMessage),1)):g("",!0),a("div",Tn,[d(_,{size:"small",onClick:i.closeUpdatePaymentModal,"aria-label":i.translate("Cancel")},{default:m(()=>[w(o(i.translate("Cancel")),1)]),_:1},8,["onClick","aria-label"]),d(_,{size:"small",type:"primary",onClick:i.processNewPaymentMethod,loading:t.updating||t.switching,disabled:t.updating||t.switching||t.invalidCard,"aria-disabled":t.updating||t.switching||t.invalidCard,"aria-label":r.updateMethod?i.translate("Update"):i.translate("Reactivate")},{default:m(()=>[w(o(r.updateMethod?i.translate("Update"):i.translate("Reactivate")),1)]),_:1},8,["onClick","loading","disabled","aria-disabled","aria-label"])])])}const Ln=E(un,[["render",En],["__scopeId","data-v-a3b00835"]]),In=()=>new Promise((e,s)=>{var r;if(window.paypal)e(window.paypal);else{const b=document.createElement("script");b.src=`https://www.paypal.com/sdk/js?client-id=${(r=window.fluentcart_customer_profile_vars)==null?void 0:r.paypal_client_id}&vault=true&intent=subscription`,b.async=!0,b.setAttribute("data-partner-attribution-id","FLUENTCART_SP_PPCP"),document.head.appendChild(b),b.onload=()=>{e(window.paypal)},b.onerror=()=>{s(new Error("Failed to load PayPal script"))}}}),Vn={name:"Paypal",props:{subscription:{type:Object,required:!0},updateMethod:{type:Boolean,required:!0,default:!0}},emits:["close","fetchSubscription"],data(){var e;return{updatePaymentUrl:"",paypalClientId:(e=window.fluentcart_customer_profile_vars)==null?void 0:e.paypal_client_id,selectedAddress:"",loading:!1,planId:null,switching:!1,reactivating:!1,reason:"",errorMessage:"",successMessage:""}},computed:{getBillingAddresses(){return this.subscription.billing_addresses}},methods:{translate:n,closeUpdatePaymentModal(){this.$emit("close")},async loadPaypal(){this.loading=!0;let e=null;try{e=await In()}catch(s){this.handleError((s==null?void 0:s.message)||"Error in loading paypal"),this.loading=!1}this.paypal=e,await this.loadPaypalButtons(),this.loading=!1},async getPlanId(){return this.updateMethod?await this.getPlanIdForUpdate():""},async getPlanIdForUpdate(){try{const e=await this.$post("customer-profile/subscriptions/"+this.subscription.uuid+"/get-or-create-plan",{data:{method:"paypal",reason:this.reason},_fluentCart_rest_nonce:window.fluentCartRestVars.rest.nonce});return(!e||!e.plan||!e.plan.id)&&(this.errorMessage=n("Invalid plan ID response!"),this.handleError(this.errorMessage)),e}catch(e){throw this.errorMessage=(e==null?void 0:e.message)||"Error in getPlanId",this.handleError(this.errorMessage),e}},async confirmNewPaypalSubscriptionSwitch(e,s){this.loading=!0,this.$post("customer-profile/subscriptions/"+this.subscription.uuid+"/confirm-subscription-switch",{data:{newVendorSubscriptionId:e,vendorOrderId:s,method:"paypal"},_fluentCart_rest_nonce:window.fluentCartRestVars.rest.nonce}).then(r=>{(r==null?void 0:r.status)==="success"?(this.handleSuccess(n("PayPal subscription updated successfully")),this.loading=!1,this.$emit("close"),this.$emit("fetchSubscription")):(r!=null&&r.message&&(this.errorMessage=r==null?void 0:r.message),this.loading=!1,this.handleError(this.errorMessage))}).catch(r=>{this.errorMessage=(r==null?void 0:r.message)||n("Error in confirming new paypal subscription"),this.handleError(this.errorMessage),this.loading=!1,this.$emit("close")})},async loadPaypalButtons(){const e=this.$refs.paypalButtonContainer;let s=null,r=null,b=null;e.innerHTML="";let t=this;try{await window.paypal.Buttons({style:{shape:"pill",layout:"vertical",label:"paypal",size:"responsive",disableMaxWidth:!0},createSubscription:async function(u,p){return p.subscription.create({plan_id:s,custom_id:t.subscription.uuid})},onApprove:function(u,p){u.subscriptionID&&(r=u.subscriptionID,b=u.orderID,t.confirmNewPaypalSubscriptionSwitch(r,b))},onClick:async function(u,p){try{const _=await t.getPlanId();if(!_||!_.plan||!_.plan.id)return p.reject();s=_.plan.id}catch{return p.reject()}},onError:u=>{var p,_;(p=this.paymentLoader)==null||p.changeLoaderStatus("error"),(_=this.paymentLoader)==null||_.hideLoader(),alert("PayPal error: "+u.toString())}}).render(e)}catch(i){console.error("PayPal Buttons failed to render:",i)}finally{this.loading=!1}}},mounted(){var s;this.$nextTick(()=>{this.loadPaypal()});const e=(s=this.getBillingAddresses)==null?void 0:s.find(r=>r.is_primary);e&&(this.selectedAddress=e.id),this.updateMethod&&(this.reason="update_payment_method")}},xn={role:"region","aria-labelledby":"paypal-section-heading"},Bn={id:"paypal-section-heading",class:"sr-only"},Nn=["aria-label"],Un={key:0,class:"error-message",role:"alert","aria-live":"assertive"},Hn={key:1,class:"success-message",role:"status","aria-live":"polite"},Fn={class:"dialog-footer"};function On(e,s,r,b,t,i){const u=h("el-button"),p=Y("loading");return l(),c("div",xn,[a("h2",Bn,o(i.translate("PayPal Payment")),1),a("div",null,[R(a("div",{id:"paypal-button-container",ref:"paypalButtonContainer","aria-live":"polite","aria-label":i.translate("PayPal payment button")},null,8,Nn),[[p,t.loading]])]),t.errorMessage?(l(),c("div",Un,o(t.errorMessage),1)):g("",!0),t.successMessage?(l(),c("div",Hn,o(t.successMessage),1)):g("",!0),a("div",Fn,[d(u,{size:"small",onClick:i.closeUpdatePaymentModal,"aria-label":i.translate("Cancel")},{default:m(()=>[w(o(i.translate("Cancel")),1)]),_:1},8,["onClick","aria-label"])])])}const qn=E(Vn,[["render",On],["__scopeId","data-v-4b354d7c"]]),Rn={name:"UpdatePaymentInfos",components:{InputField:_t,Stripe:Ln,Paypal:qn},props:{subscription:{type:Object,required:!0},updateMethod:{type:Boolean,required:!0,default:!0},buttonText:{type:String,default:"Update Payment Method"}},data(){return{updatePaymentModal:!1,selectedPaymentMethod:this.subscription.current_payment_method,selectedAddress:"",stripePubKey:window.fluentcart_customer_profile_vars.stripe_pub_key,stripe:null,cardNumber:null,cardExpiry:null,cardCvc:null,loading:!1,error:"",updating:!1,invalidInput:!1}},computed:{getAllPaymentMethods(){var e;return((e=window.fluentcart_customer_profile_vars)==null?void 0:e.payment_methods)||[]},filteredPaymentMethods(){return this.subscription.can_switch_payment_method===!0?(this.getAllPaymentMethods||[]).filter(e=>{var s;return e&&((s=e.supported_features)==null?void 0:s.includes("switch_payment_method"))}):methods.filter(e=>e.slug===this.subscription.current_payment_method)}},methods:{translate:n,showUpdatePaymentModal(){this.updatePaymentModal=!0},closeUpdatePaymentModal(){this.updatePaymentModal=!1},fetchSubscription(){this.$emit("fetch")}},mounted(){}},zn={id:"update-payment-title",class:"sr-only"},jn={class:"fct-update-payment-method"},Yn={class:"fct-update-payment-method-header"},Kn={id:"payment-methods-label",class:"sr-only"},Wn=["src","alt","title"],Zn={id:"update-payment-description",class:"sr-only"},Gn={class:"fct-update-payment-method-body"},Jn={class:"fct-update-payment-method-form"},Qn={key:0,class:"fct-update-payment-method-stripe"},Xn={key:1,class:"fct-update-payment-method-paypal"};function el(e,s,r,b,t,i){const u=h("el-button"),p=h("el-radio"),_=h("el-radio-group"),y=h("Stripe"),k=h("Paypal"),f=h("el-dialog");return l(),c("div",null,[r.updateMethod?(l(),M(u,{key:0,onClick:i.showUpdatePaymentModal,text:"",class:"underline-link-button","aria-label":r.buttonText},{default:m(()=>[w(o(r.buttonText),1)]),_:1},8,["onClick","aria-label"])):(l(),M(u,{key:1,onClick:i.showUpdatePaymentModal,text:"",class:"underline-link-button","aria-label":i.translate("Reactivate")},{default:m(()=>[w(o(i.translate("Reactivate")),1)]),_:1},8,["onClick","aria-label"])),d(f,{modelValue:t.updatePaymentModal,"onUpdate:modelValue":s[1]||(s[1]=v=>t.updatePaymentModal=v),title:i.translate("Update Payment"),role:"dialog","aria-modal":"true","aria-labelledby":"update-payment-title","aria-describedby":"update-payment-description"},{default:m(()=>[a("h2",zn,o(i.translate("Update Payment")),1),a("div",jn,[a("div",Yn,[a("label",Kn,o(i.translate("Select payment method")),1),d(_,{class:"fct-update-payment-method-radio",modelValue:t.selectedPaymentMethod,"onUpdate:modelValue":s[0]||(s[0]=v=>t.selectedPaymentMethod=v),role:"radiogroup","aria-labelledby":"payment-methods-label"},{default:m(()=>[(l(!0),c(T,null,V(i.filteredPaymentMethods,(v,C)=>(l(),M(p,{value:v.slug,key:v.slug,border:"","aria-label":`${v.title} payment method`},{default:m(()=>[a("img",{src:v.logo,alt:`${v.title} logo`,class:H(v.slug),title:v.title},null,10,Wn),w(" "+o(v.title),1)]),_:2},1032,["value","aria-label"]))),128))]),_:1},8,["modelValue"])]),a("div",Zn,o(i.translate("Update your payment method to continue with the subscription.")),1),a("div",Gn,[a("div",Jn,[t.selectedPaymentMethod=="stripe"?(l(),c("div",Qn,[d(y,{subscription:r.subscription,onClose:i.closeUpdatePaymentModal,onFetchSubscription:i.fetchSubscription,updateMethod:r.updateMethod},null,8,["subscription","onClose","onFetchSubscription","updateMethod"])])):g("",!0),t.selectedPaymentMethod=="paypal"?(l(),c("div",Xn,[d(k,{subscription:r.subscription,onClose:i.closeUpdatePaymentModal,onFetchSubscription:i.fetchSubscription,updateMethod:r.updateMethod},null,8,["subscription","onClose","onFetchSubscription","updateMethod"])])):g("",!0)])])])]),_:1},8,["modelValue","title"])])}const tl=E(Rn,[["render",el]]),sl={name:"TransactionPaymentMethod",props:{transaction:{type:Object,required:!0}},computed:{assetUrl(){return this.appVars.assets_path}}},al={class:"fct-transaction-payment-method",role:"status"},il={key:0,class:"flex gap-2 items-center"},rl=["src","alt"],nl=["aria-label"],ll=["aria-label"],ol=["src","alt"],dl={key:0,class:"text"},cl=["aria-label"],ul={key:2,class:"text text-capitalize","aria-label":"Payment method: {{ transaction.payment_method }}"};function ml(e,s,r,b,t,i){return l(),c("div",al,[r.transaction.payment_method==="paypal"?(l(),c("div",il,[a("img",{src:`${i.assetUrl}images/payment-methods/paypal-icon.svg`,alt:e.$t("PayPal logo")},null,8,rl),a("span",{class:"text-gray-700 text-sm","aria-label":e.$t("Transaction ID:")+r.transaction.vendor_charge_id||""},o(r.transaction.vendor_charge_id||""),9,nl)])):parseInt(r.transaction.card_last_4)?(l(),c("div",{key:1,class:"flex gap-2 items-center",role:"img","aria-label":e.$t("Credit card payment method")},[a("img",{src:`${i.assetUrl}images/credit-card/card.svg`,alt:e.$t("Credit Card logo")},null,8,ol),r.transaction.card_brand?(l(),c("span",dl,o(r.transaction.card_brand),1)):g("",!0),a("span",{class:"text","aria-label":e.$t("Credit card ending in")+" "+r.transaction.card_last_4}," **** "+o(r.transaction.card_last_4),9,cl)],8,ll)):(l(),c("span",ul,o(r.transaction.payment_method),1))])}const hl=E(sl,[["render",ml]]),_l={class:"fct-global-address-component"},pl={class:"fct-global-address-component-row"},fl={class:"city"},bl={class:"postcode"},pt={__name:"AddressComponent",props:$t({use_additional_address_fields:{type:Boolean,required:!1,default:!1},validationErrors:{type:Object,default:()=>({})}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const s=At(e,"modelValue"),r=N([]),b=()=>{j.get("address-info/countries").then(C=>{r.value=C.data}).catch(C=>{console.log(C,"errors")}).finally(()=>{})},t=N({}),i=N(!1),u=N(!0),p=N(!0),_=N(n("Zip Code")),y=N(n("State")),k=C=>{if(s.state="",i.value=!0,!C){i.value=!1;return}if(t.value[C]){v(t.value[C]),i.value=!1;return}j.get("address-info/get-country-info",{country_code:C}).then(S=>{t.value[C]=S,v(S)}).catch(S=>{console.log(S,"errors")}).finally(()=>{i.value=!1})},f=N([]),v=C=>{var S,D,$,I,P,x;f.value=(C==null?void 0:C.states)||[],p.value=((D=(S=C==null?void 0:C.address_locale)==null?void 0:S.state)==null?void 0:D.hidden)!==!0,u.value=f.value.length>1,_.value=((I=($=C==null?void 0:C.address_locale)==null?void 0:$.postcode)==null?void 0:I.label)||n("Zip Code"),y.value=((x=(P=C==null?void 0:C.address_locale)==null?void 0:P.state)==null?void 0:x.label)||n("State")};return ne(()=>s.value.country,(C,S)=>{k(C)}),ie(()=>{b(),setTimeout(()=>{s.value.country&&k(s.value.country)},400)}),(C,S)=>(l(),c("div",_l,[d(_e,{class:H(e.validationErrors.hasOwnProperty("country")?"is-error":""),required:"",options:r.value,modelValue:s.value.country,"onUpdate:modelValue":S[0]||(S[0]=D=>s.value.country=D),filterable:"",onOnChange:S[1]||(S[1]=D=>{s.value.state="",k(D)}),clearable:!0,label:A(n)("Select Country")},null,8,["class","options","modelValue","label"]),d(Nt,{visible:!i.value&&p.value,accordion:"",class:"address_locale"},{default:m(()=>[u.value?(l(),M(_e,{key:0,filterable:"",modelValue:s.value.state,"onUpdate:modelValue":S[2]||(S[2]=D=>s.value.state=D),options:f.value,label:A(n)(y.value),clearable:!0},null,8,["modelValue","options","label"])):(l(),M(O,{key:1,modelValue:s.value.state,"onUpdate:modelValue":S[3]||(S[3]=D=>s.value.state=D),label:A(n)(y.value)},null,8,["modelValue","label"]))]),_:1},8,["visible"]),e.use_additional_address_fields?(l(),c(T,{key:0},[d(O,{modelValue:s.value.address_1,"onUpdate:modelValue":S[4]||(S[4]=D=>s.value.address_1=D),class:H(e.validationErrors.hasOwnProperty("address_1")?"is-error":""),label:A(n)("Street address")},null,8,["modelValue","class","label"]),d(O,{modelValue:s.value.address_2,"onUpdate:modelValue":S[5]||(S[5]=D=>s.value.address_2=D),label:A(n)("Apt, suite, unit")},null,8,["modelValue","label"])],64)):g("",!0),a("div",pl,[a("div",fl,[d(O,{modelValue:s.value.city,"onUpdate:modelValue":S[6]||(S[6]=D=>s.value.city=D),class:H(e.validationErrors.hasOwnProperty("city")?"is-error":""),label:A(n)("City/Town")},null,8,["modelValue","class","label"])]),a("div",bl,[d(O,{class:H(e.validationErrors.hasOwnProperty("postcode")?"is-error":""),required:"",modelValue:s.value.postcode,"onUpdate:modelValue":S[7]||(S[7]=D=>s.value.postcode=D),label:A(n)(_.value)},null,8,["class","modelValue","label"])])])]))}},gl={name:"TransactionsTable",components:{AddressComponent:pt,MaterialInput:O,Badge:B,DynamicIcon:U,TransactionPaymentMethod:hl},props:{transactions:{type:Array,default:()=>[]},showTableHeader:{type:Boolean,default:!0}},data(){return{isEditingBillingAddressModal:!1,validationErrors:{},billingAddressData:{name:"",address_1:"",address_2:"",city:"",state:"",postcode:"",country:"",vat_tax_id:""},formFields:[{key:"name",label:n("Name/Business Name"),required:!0}],selectedTransaction:null,updatingAddress:!1,address_id:null}},methods:{translate:n,handleTransactionCommand(e,s){e==="edit_billing_address"&&(this.selectedTransaction=s,this.isEditingBillingAddressModal=!0)},fetchBillingAddress(){this.$get(`customer-profile/orders/${this.selectedTransaction.uuid}/billing-address`).then(e=>{this.billingAddressData=e.data,this.billingAddressData.address_1=e.data.address_1,this.billingAddressData.address_2=e.data.address_2,this.billingAddressData.city=e.data.city,this.billingAddressData.state=e.data.state,this.billingAddressData.postcode=e.data.postcode,this.billingAddressData.country=e.data.country,this.billingAddressData.name=e.data.name,this.billingAddressData.vat_tax_id=e.data.vat_tax_id,this.address_id=e.data.address_id}).catch(e=>{e.message&&this.handleError(e)}).finally(()=>{})},updateBillingAddress(){this.updatingAddress=!0,this.$put(`customer-profile/orders/${this.selectedTransaction.uuid}/billing-address`,{name:this.billingAddressData.name,address_1:this.billingAddressData.address_1,address_2:this.billingAddressData.address_2,city:this.billingAddressData.city,state:this.billingAddressData.state,postcode:this.billingAddressData.postcode,country:this.billingAddressData.country,vat_tax_id:this.billingAddressData.vat_tax_id,transaction_uuid:this.selectedTransaction.uuid,address_id:this.address_id}).then(e=>{this.handleSuccess(e.message),this.isEditingBillingAddressModal=!1,this.$emit("billing-address-updated",e.formatted_address)}).catch(e=>{this.handleError(e),this.validationErrors=e}).finally(()=>{this.updatingAddress=!1})},handleCloseModal(){this.isEditingBillingAddressModal=!1,this.selectedTransaction=null},getStatusText(e){switch(e){case"completed":return n("Completed");case"paid":return n("Paid");case"active":return n("Active");case"publish":return n("Published");case"draft":return n("Draft");case"shipped":return n("Shipped");case"success":return n("Success");case"licensed":return n("Licensed");case"succeeded":return n("Succeeded");case"failed":return n("Failed");case"error":return n("Error");case"canceled":return n("Canceled");case"expired":return n("Expired");case"partially_paid":return n("Partially Paid");case"intended":return n("Intended");case"scheduled":return n("Scheduled");case"on-hold":return n("On Hold");case"pending":return n("Pending");case"unpaid":return n("Unpaid");case"warning":return n("Warning");case"processing":return n("Processing");case"future":return n("Future");case"inactive":return n("Inactive");case"dispute":return n("Dispute");case"disabled":return n("Disabled");case"beta":return n("Beta");case"subscription":return n("Subscription");case"renewal":return n("Renewal");case"payment":return n("Payment");default:return q.headline(e)}}}},yl=["aria-label"],vl=["datetime"],wl=["innerHTML","aria-label"],kl={class:"flex items-center gap-2 justify-between"},Cl=["href","aria-label"],Pl=["aria-label"],$l={class:"fct-customer-dashboard-add-address-form-wrap"},Al={class:"fct-compact-form"},Sl={class:"dialog-footer"};function Ml(e,s,r,b,t,i){const u=h("el-table-column"),p=h("Badge"),_=h("TransactionPaymentMethod"),y=h("DynamicIcon"),k=h("el-dropdown-item"),f=h("el-dropdown-menu"),v=h("el-dropdown"),C=h("el-table"),S=h("MaterialInput"),D=h("AddressComponent"),$=h("el-button"),I=h("el-dialog");return l(),c("div",null,[d(C,{data:r.transactions,"aria-label":e.$t("Transactions Table")},{default:m(()=>[d(u,{label:"#",width:150},{default:m(P=>[a("span",{class:"text truncate","aria-label":e.$t("Invoice Number")+" "+P.row.invoice_no},"#"+o(P.row.invoice_no),9,yl)]),_:1}),d(u,{label:e.$t("Date"),width:120},{default:m(P=>[a("time",{class:"text truncate",datetime:P.row.created_at},o(e.formatDate(P.row.created_at)),9,vl)]),_:1},8,["label"]),d(u,{label:e.$t("Amount"),width:"90"},{default:m(P=>[a("span",{class:"text",innerHTML:e.formatNumber(P.row.total,!0,!1,P.row.currency),"aria-label":e.$t("Amount")},null,8,wl)]),_:1},8,["label"]),d(u,{label:e.$t("Status"),width:110},{default:m(P=>[d(p,{type:P.row.status,size:"small","aria-label":e.$t("Status")+": "+P.row.status},{default:m(()=>[w(o(i.getStatusText(P.row.status)),1)]),_:2},1032,["type","aria-label"])]),_:1},8,["label"]),d(u,{label:e.$t("Type"),width:100},{default:m(P=>[d(p,{type:P.row.order_type,size:"small","aria-label":e.$t("Order Type")+": "+P.row.order_type},{default:m(()=>[w(o(i.getStatusText(P.row.order_type)),1)]),_:2},1032,["type","aria-label"])]),_:1},8,["label"]),d(u,{label:e.$t("Payment Method"),"min-width":160},{default:m(P=>[d(_,{transaction:P.row},null,8,["transaction"])]),_:1},8,["label"]),d(u,{width:125},{default:m(P=>[a("div",kl,[a("a",{href:P.row.receipt_url,target:"_blank",class:"underline-link-button","aria-label":e.$t("Download Receipt for Invoice")+" "+P.row.invoice_no,rel:"noopener noreferrer"},[d(y,{name:"Download",class:"w-4 h-4","aria-hidden":"true"}),w(" "+o(e.$t("Receipt")),1)],8,Cl),d(v,{trigger:"click",class:"fct-more-option-wrap","popper-class":"fct-dropdown",onCommand:x=>i.handleTransactionCommand(x,P.row),"aria-label":e.$t("More Actions")},{dropdown:m(()=>[d(f,null,{default:m(()=>[d(k,{command:"edit_billing_address"},{default:m(()=>[w(o(i.translate("Edit Billing Address")),1)]),_:1})]),_:1})]),default:m(()=>[a("span",{class:"more-btn w-4 h-4 flex items-center justify-center cursor-pointer","aria-haspopup":"true","aria-label":e.$t("More Actions")},[d(y,{name:"More",class:"w-1","aria-hidden":"true"})],8,Pl)]),_:2},1032,["onCommand","aria-label"])])]),_:1})]),_:1},8,["data","aria-label"]),d(I,{modelValue:t.isEditingBillingAddressModal,"onUpdate:modelValue":s[2]||(s[2]=P=>t.isEditingBillingAddressModal=P),title:i.translate("Edit Billing Address"),"append-to-body":!0,"modal-class":"fct-transaction-billing-address-modal",onOpen:i.fetchBillingAddress,class:"fluent-cart-customer-profile-app fct-customer-root-container","aria-modal":"true",role:"dialog"},{footer:m(()=>[a("div",Sl,[d($,{type:"info",soft:"",onClick:i.handleCloseModal},{default:m(()=>[w(o(i.translate("Cancel")),1)]),_:1},8,["onClick"]),d($,{type:"primary",loading:t.updatingAddress,onClick:i.updateBillingAddress},{default:m(()=>[w(o(i.translate("Update Address")),1)]),_:1},8,["loading","onClick"])])]),default:m(()=>[a("div",$l,[a("div",Al,[(l(!0),c(T,null,V(t.formFields,(P,x)=>(l(),M(S,{key:x,required:P.required,label:P.label,modelValue:t.billingAddressData[P.key],"onUpdate:modelValue":F=>t.billingAddressData[P.key]=F,class:H(t.validationErrors[P.key]?"is-error":"")},null,8,["required","label","modelValue","onUpdate:modelValue","class"]))),128)),d(D,{use_additional_address_fields:"",modelValue:t.billingAddressData,"onUpdate:modelValue":s[0]||(s[0]=P=>t.billingAddressData=P),validationErrors:t.validationErrors},null,8,["modelValue","validationErrors"]),d(S,{label:i.translate("Vat Tax ID"),modelValue:t.billingAddressData.vat_tax_id,"onUpdate:modelValue":s[1]||(s[1]=P=>t.billingAddressData.vat_tax_id=P),class:H(t.validationErrors.vat_tax_id?"is-error":"")},null,8,["label","modelValue","class"])])])]),_:1},8,["modelValue","title","onOpen"])])}const ft=E(gl,[["render",Ml]]),Dl={name:"SingleSubscription",props:{subscription_uuid:String},components:{TransactionsTable:ft,IconButton:ee,UpdatePaymentInfos:tl,UpgradePlan:mt,DynamicIcon:U,Badge:B,LicenseTable:de},data(){return{subscription:null,loading:!0,cancelling:!1}},computed:{isCancelable(){var e,s;return!(((e=this.subscription)==null?void 0:e.bill_times)>1||((s=this.subscription)==null?void 0:s.status)==="canceled")},ArrowRight(){return dt}},methods:{fetchSubscription(){this.loading=!0,this.$get(`customer-profile/subscriptions/${this.subscription_uuid}`).then(e=>{this.subscription=e.subscription}).catch(e=>{this.handleError(e)}).finally(()=>{this.loading=!1})},pluralizeTranslate:J,cancelSubscription(){this.cancelling=!0,this.$post(`customer-profile/subscriptions/${this.subscription.uuid}/cancel-auto-renew`,{method:this.subscription.current_payment_method}).then(e=>{this.$notify.success(e.message)}).catch(e=>{this.handleError(e)}).finally(()=>{this.cancelling=!1,this.fetchSubscription()})},subscriptionStatus(){var e,s,r;return(e=this.subscription)!=null&&e.overridden_status?(s=this.subscription)==null?void 0:s.overridden_status:(r=this.subscription)==null?void 0:r.status}},mounted(){this.fetchSubscription()}},Tl={class:"fct-customer-dashboard-single-subcription-wrap fct-customer-dashboard-layout-width",role:"main","aria-labelledby":"subscription-overview-title"},El={class:"fct-customer-dashboard-single-subscription"},Ll={class:"fct-customer-dashboard-breadcrumb mb-8"},Il={key:0,class:"fct-renew-box mb-4"},Vl={class:"text-center p-4"},xl={class:"p-0 m-0 mb-3"},Bl=["href","aria-label"],Nl={class:"p-0 m-0 mb-3"},Ul=["href","aria-label"],Hl={class:"fct-single-order-box mb-11 lg:mb-6",role:"region","aria-labelledby":"subscription-details-title"},Fl={class:"fct-single-order-header"},Ol={id:"subscription-details-title",class:"title"},ql={class:"fct-single-order-body"},Rl={class:"fct-single-order-box-inner"},zl={class:"fct-customer-dashboard-content-table-item border-0 pb-0"},jl={class:"left-content"},Yl={class:"fct-product-info-card"},Kl={class:"fct-product-info-card-inner"},Wl={class:"product-info-content"},Zl={class:"title truncate-none"},Gl={class:"variation-title"},Jl={class:"right-content !w-auto"},Ql={id:"cancel-popover-title",class:"sr-only"},Xl={class:"flex justify-end gap-2"},eo=["aria-label"],to={class:"fct-customer-dashboard-content-table-item border-0 pb-0"},so={class:"left-content"},ao={class:"title"},io=["aria-label","innerHTML"],ro={key:0,class:"fct-customer-dashboard-content-table-item border-0 pb-0"},no={class:"left-content"},lo={class:"title"},oo=["aria-label"],co={class:"fct-customer-dashboard-content-table-item border-0 pb-0"},uo={class:"left-content"},mo={class:"title"},ho=["aria-label"],_o=["aria-label"],po={key:1},fo={class:"fct-single-order-footer mt-3"},bo={class:"flex items-center gap-3"},go={key:1,class:"fct-single-order-box",role:"region","aria-labelledby":"licenses-title"},yo={class:"fct-single-order-header"},vo={id:"licenses-title",class:"title"},wo={class:"fct-single-order-box",role:"region","aria-labelledby":"transactions-title"},ko={class:"fct-single-order-header"},Co={id:"transactions-title",class:"title"},Po={class:"fct-customer-dashboard-table"},$o={key:1,"aria-live":"polite"};function Ao(e,s,r,b,t,i){var ce,ue,me,he;const u=h("el-breadcrumb-item"),p=h("el-breadcrumb"),_=h("el-alert"),y=h("Badge"),k=h("DynamicIcon"),f=h("IconButton"),v=h("el-button"),C=h("el-popover"),S=h("el-dropdown-item"),D=h("el-dropdown-menu"),$=h("el-dropdown"),I=h("UpgradePlan"),P=h("UpdatePaymentInfos"),x=h("router-link"),F=h("LicenseTable"),W=h("TransactionsTable"),Z=h("el-skeleton");return l(),c("div",Tl,[a("div",El,[a("div",Ll,[d(p,{"separator-icon":i.ArrowRight,role:"navigation","aria-label":e.$t("Breadcrumb")},{default:m(()=>[d(u,{class:"cursor-pointer",to:{path:"/subscriptions"}},{default:m(()=>[w(o(e.$t("Subscription Plans")),1)]),_:1}),d(u,{"aria-current":"page"},{default:m(()=>[w(o(e.$t("Overview")),1)]),_:1})]),_:1},8,["separator-icon","aria-label"])]),t.subscription?(l(),c(T,{key:0},[t.subscription.reactivate_url?(l(),c("div",Il,[d(_,{type:"error",closable:!1,role:"alert"},{default:m(()=>[a("div",Vl,[t.subscription.status==="expired"?(l(),c(T,{key:0},[a("p",xl,o(e.$t("Your subscription has expired at %s. Please renew to keep things running smoothly.",e.formatDate(t.subscription.expire_at))),1),a("a",{href:t.subscription.reactivate_url,class:"el-button el-button--primary","aria-label":e.$t("Renew Subscription Plan")},o(e.$t("Renew Subscription Plan")),9,Bl)],64)):(l(),c(T,{key:1},[a("p",Nl,o(e.$t("Your subscription status is now: %s. Please reactivate to keep things running smoothly.",t.subscription.status)),1),a("a",{href:t.subscription.reactivate_url,class:"el-button el-button--primary","aria-label":e.$t("Reactivate Subscription Plan")},o(e.$t("Reactivate Subscription Plan")),9,Ul)],64))])]),_:1})])):g("",!0),a("article",Hl,[a("header",Fl,[a("h1",Ol,o(e.$t("Subscription Plan Details")),1)]),a("div",ql,[a("div",Rl,[a("div",zl,[a("div",jl,[a("div",Yl,[a("div",Kl,[a("div",Wl,[a("div",Zl,[w(o(t.subscription.title)+" ",1),d(y,{status:i.subscriptionStatus(),size:"small"},null,8,["status"])]),a("div",Gl,o(t.subscription.subtitle),1)])])])]),a("div",Jl,[i.isCancelable?(l(),M($,{key:0,trigger:"click","hide-on-click":!1,"popper-class":"fct-dropdown",role:"menu","aria-haspopup":"true","aria-expanded":"false"},{dropdown:m(()=>[d(D,{role:"menu"},{default:m(()=>[d(S,{role:"menuitem"},{default:m(()=>[d(C,{"popper-class":"fluent-cart-customer-profile-app",trigger:"click",placement:"bottom",width:260,ref:"popoverRef",role:"dialog","aria-modal":"true","aria-labelledby":"cancel-popover-title"},{reference:m(()=>[a("span",{"aria-label":e.$t("Cancel Subscription")},o(e.$t("Cancel Subscription")),9,eo)]),default:m(()=>[a("h3",Ql,o(e.$t("Cancel Subscription")),1),a("div",null,o(e.$t("Confirm cancellation? Your access stays active until current billing cycle ends.")),1),a("div",Xl,[d(v,{class:"el-button--x-small",text:"",onClick:s[0]||(s[0]=Zc=>e.$refs.popoverRef.hide()),"aria-label":e.$t("Cancel")},{default:m(()=>[w(o(e.$t("Cancel")),1)]),_:1},8,["aria-label"]),d(v,{class:"el-button--x-small",type:"primary",loading:t.cancelling,onClick:i.cancelSubscription,"aria-label":e.$t("Yes, Proceed")},{default:m(()=>[w(o(e.$t("Yes, Proceed")),1)]),_:1},8,["loading","onClick","aria-label"])])]),_:1},512)]),_:1})]),_:1})]),default:m(()=>[d(f,{tag:"button",size:"x-small",class:"simple-icon-btn","aria-label":e.$t("Subscription options")},{default:m(()=>[d(k,{name:"More",class:"w-[5px]","aria-hidden":"true"})]),_:1},8,["aria-label"])]),_:1})):g("",!0)])]),a("div",to,[a("div",so,[a("div",ao,o(e.$t("Billing Terms")),1),a("span",{class:"text","aria-label":e.$t("Billing Terms"),innerHTML:t.subscription.payment_info},null,8,io)])]),t.subscription.status=="active"||t.subscription.status=="trialing"?(l(),c("div",ro,[a("div",no,[a("div",lo,o(e.$t("Next Charge")),1),a("span",{class:"text","aria-label":e.$t("Next Charge")},o(e.formatDate(t.subscription.next_billing_date)),9,oo)])])):g("",!0),a("div",co,[a("div",uo,[a("div",mo,o(e.$t("Payment Method")),1),a("span",{class:"text","aria-label":e.$t("Payment Method")},[(ce=t.subscription.billing_info.details)!=null&&ce.last_4?(l(),c("span",{key:0,"aria-label":e.$t("Credit Card ending in")+" "+((ue=t.subscription.billing_info.details)==null?void 0:ue.last_4)}," **** "+o((me=t.subscription.billing_info.details)==null?void 0:me.last_4),9,_o)):(l(),c("span",po,o(t.subscription.current_payment_method),1))],8,ho)])])])]),a("footer",fo,[a("div",bo,[(he=t.subscription)!=null&&he.can_upgrade?(l(),M(I,{key:0,"button-type":"primary","button-text":e.$t("Upgrade Plan"),variation_id:t.subscription.variation_id,order_hash:t.subscription.order.uuid},null,8,["button-text","variation_id","order_hash"])):g("",!0),t.subscription.can_update_payment_method?(l(),M(P,{key:1,subscription:t.subscription,buttonText:e.$t("Update Payment Method"),onFetch:i.fetchSubscription,updateMethod:!0},null,8,["subscription","buttonText","onFetch"])):g("",!0),d(x,{class:"underline-link-button",to:{name:"view_order",params:{order_id:t.subscription.order.uuid}},"aria-label":e.$t("View Order")},{default:m(()=>[w(o(e.$t("View Order")),1)]),_:1},8,["to","aria-label"])])])]),t.subscription.licenses&&t.subscription.licenses.length?(l(),c("article",go,[a("header",yo,[a("h2",vo,o(i.pluralizeTranslate("Connected License","Connected Licenses",t.subscription.licenses.length)),1)]),d(F,{is_simple:!0,licenses:t.subscription.licenses,showTableHeader:!1},null,8,["licenses"])])):g("",!0),a("article",wo,[a("header",ko,[a("h2",Co,o(e.$t("Related Transactions")),1)]),a("div",Po,[d(W,{transactions:t.subscription.transactions,"show-table-header":!0},null,8,["transactions"])])])],64)):t.loading?(l(),c("div",$o,[d(Z,{rows:5,animated:!0})])):g("",!0)])])}const So=E(Dl,[["render",Ao]]),Mo={class:"fct-purchase-history-route-wrap"},Do=Object.assign({name:"PurchaseHistoryRoute"},{__name:"PurchaseHistoryRoute",setup(e){return(s,r)=>{const b=h("router-view");return l(),c("div",Mo,[d(b)])}}}),To={name:"AccountDetails.vue",props:["profileDetails"],components:{MaterialInput:O},data(){return{accountDetailsDescId:"account-details-desc"}},methods:{translate:n}},Eo={class:"fct-form-container",role:"region","aria-labelledby":"account-details-heading"},Lo={class:"form-left"},Io={id:"account-details-heading",class:"form-heading"},Vo=["id"],xo={class:"form-right"},Bo={class:"sr-only"},No={class:"fct-compact-form",id:"account-details"};function Uo(e,s,r,b,t,i){const u=h("MaterialInput");return l(),c("div",Eo,[a("div",Lo,[a("h3",Io,o(i.translate("Account Details")),1),a("p",{id:t.accountDetailsDescId,class:"form-desc"},o(i.translate("Manage and update your personal information.")),9,Vo)]),a("div",xo,[a("span",Bo,o(i.translate("Account Details")),1),a("div",No,[d(u,{"aria-describedby":t.accountDetailsDescId,label:i.translate("First Name"),modelValue:r.profileDetails.first_name,"onUpdate:modelValue":s[0]||(s[0]=p=>r.profileDetails.first_name=p)},null,8,["aria-describedby","label","modelValue"]),d(u,{"aria-describedby":t.accountDetailsDescId,label:i.translate("Last Name"),modelValue:r.profileDetails.last_name,"onUpdate:modelValue":s[1]||(s[1]=p=>r.profileDetails.last_name=p)},null,8,["aria-describedby","label","modelValue"]),d(u,{"aria-describedby":t.accountDetailsDescId,label:i.translate("Email"),disabled:"",modelValue:r.profileDetails.email,"onUpdate:modelValue":s[2]||(s[2]=p=>r.profileDetails.email=p)},null,8,["aria-describedby","label","modelValue"])])])])}const Ho=E(To,[["render",Uo]]),Fo={name:"AddressModal",props:["modalAction","newAddressData","showModal","profileDetails","isEditAddress"],emits:["fetch"],components:{DynamicIcon:U,AddressComponent:pt,MaterialInput:O},data(){return{addressModalTitleId:"address-modal-title",validationErrors:{},addAddressLoading:!1,addNewAddressModalVisible:!1,localIsEditAddress:!1,localAddressData:{label:"",name:"",email:"",phone:"",address_1:"",address_2:"",city:"",state:"",postcode:"",country:""},formRules:{name:[n("Name is required.")],email:[n("Email is required.")],country:[n("Country is required.")],postcode:[n("Postcode is required.")]},formFields:[{key:"label",label:n("Address label e.g Home, Office"),required:!1},{key:"name",label:n("Name"),required:!0},{key:"email",label:n("Email"),required:!0},{key:"phone",label:n("Phone"),required:!1}]}},watch:{showModal(){this.addNewAddressModalVisible=this.showModal},newAddressData:{handler(e){e&&this.isEditAddress&&(this.localAddressData={...e})},deep:!0,immediate:!0},isEditAddress:{handler(e){e||this.resetFormDataAndValidation()},immediate:!0}},methods:{translate:n,validateForm(){const e={};return Object.keys(this.formRules).forEach(s=>{(!this.localAddressData[s]||this.localAddressData[s].trim()==="")&&(e[s]={required:this.formRules[s][0]})}),this.validationErrors=e,Object.keys(e).length===0},addAddress(){if(this.validateForm()){this.addAddressLoading=!0;let e={type:this.modalAction,customer_id:this.profileDetails.id},s={...this.localAddressData,...e};this.$post("customer-profile/create-address",{type:s.type,label:s.label,name:s.name,phone:s.phone,email:s.email,country:s.country,state:s.state,address_1:s.address_1,address_2:s.address_2,city:s.city,postcode:s.postcode}).then(r=>{L.success(r),this.closeModal(),this.addAddressLoading=!1,this.resetFormDataAndValidation(),this.$emit("fetch")}).catch(r=>{r.status_code=="422"?L.validationErrors(r):L.error(r==null?void 0:r.data),this.validationErrors=r==null?void 0:r.data}).finally(()=>{this.addAddressLoading=!1})}else L.error(n("Please fill in all the required fields."))},editAddress(){if(this.validateForm()){this.addAddressLoading=!0;let e={...this.localAddressData};this.$post("customer-profile/edit-address",{id:e.id,label:e.label,name:e.name,phone:e.phone,email:e.email,country:e.country,state:e.state,address_1:e.address_1,address_2:e.address_2,city:e.city,postcode:e.postcode,type:e.type}).then(s=>{L.success(s),this.closeModal(),this.addAddressLoading=!1,this.resetFormDataAndValidation(),this.$emit("fetch")}).catch(s=>{L.error(s)}).finally(()=>{this.addAddressLoading=!1})}else L.error(n("Please fill in all the required fields."))},openModal(){this.addNewAddressModalVisible=!0},closeModal(){this.addNewAddressModalVisible=!1},getModalTitle(){return this.localIsEditAddress?n("Edit address"):this.modalAction==="billing"?n("Add new billing address"):this.modalAction==="shipping"?n("Add new shipping address"):n("Add new address")},handleAddNewAddressModal(e,s=null){e==="edit"&&s?(this.localAddressData={...s},this.localIsEditAddress=!0):(this.resetFormDataAndValidation(),this.localIsEditAddress=!1),this.addNewAddressModalVisible=!0},resetFormDataAndValidation(){Object.keys(this.localAddressData).forEach(e=>{this.localAddressData[e]=""}),this.validationErrors={}}}},Oo={class:"fct-customer-dashboard-add-address-form-wrap"},qo=["id"],Ro={class:"fct-compact-form"},zo={id:"addressFormDescId",class:"sr-only"},jo={key:0,class:"form-error-wrap",role:"alert","aria-live":"assertive","aria-atomic":"true"},Yo={class:"dialog-footer"};function Ko(e,s,r,b,t,i){const u=h("el-button"),p=h("MaterialInput"),_=h("AddressComponent"),y=h("el-dialog");return l(),c(T,null,[d(u,{size:"small",onClick:s[0]||(s[0]=k=>i.handleAddNewAddressModal()),"aria-label":i.translate("Add New Address"),"aria-haspopup":"dialog"},{default:m(()=>[w(o(i.translate("Add New Address")),1)]),_:1},8,["aria-label"]),d(y,{modelValue:t.addNewAddressModalVisible,"onUpdate:modelValue":s[3]||(s[3]=k=>t.addNewAddressModalVisible=k),"append-to-body":!0,title:i.getModalTitle(),onClosed:i.resetFormDataAndValidation,class:"fluent-cart-customer-profile-app fct-customer-root-container",role:"dialog","aria-modal":"true","aria-labelledby":t.addressModalTitleId,"aria-describedby":e.addressFormDescId,tabindex:"-1"},{footer:m(()=>[a("div",Yo,[d(u,{type:"info",soft:"",onClick:s[2]||(s[2]=k=>t.addNewAddressModalVisible=!1),"aria-label":i.translate("Cancel")},{default:m(()=>[w(o(i.translate("Cancel")),1)]),_:1},8,["aria-label"]),t.localIsEditAddress?(l(),M(u,{key:0,type:"primary",loading:t.addAddressLoading,onClick:i.editAddress,"aria-label":i.translate("Update Address")},{default:m(()=>[w(o(i.translate("Update Address")),1)]),_:1},8,["loading","onClick","aria-label"])):(l(),M(u,{key:1,type:"primary",loading:t.addAddressLoading,onClick:i.addAddress,"aria-label":i.translate("Add Address")},{default:m(()=>[w(o(i.translate("Add Address")),1)]),_:1},8,["loading","onClick","aria-label"]))])]),default:m(()=>[a("div",Oo,[a("h2",{id:t.addressModalTitleId,class:"sr-only"},o(i.getModalTitle()),9,qo),a("form",Ro,[(l(!0),c(T,null,V(t.formFields,(k,f)=>(l(),M(p,{key:f,required:k.required,label:k.label,modelValue:t.localAddressData[k.key],"onUpdate:modelValue":v=>t.localAddressData[k.key]=v,class:H(t.validationErrors[k.key]?"is-error":""),"aria-invalid":!!t.validationErrors[k.key],"aria-describedby":t.validationErrors[k.key]?`${k.key}-error`:null},null,8,["required","label","modelValue","onUpdate:modelValue","class","aria-invalid","aria-describedby"]))),128)),d(_,{use_additional_address_fields:"",modelValue:t.localAddressData,"onUpdate:modelValue":s[1]||(s[1]=k=>t.localAddressData=k),validationErrors:t.validationErrors},null,8,["modelValue","validationErrors"])]),a("div",zo,o(i.translate("Form to add or edit address. Required fields are marked with an asterisk.")),1),Object.keys(t.validationErrors).length?(l(),c("div",jo,[(l(!0),c(T,null,V(t.validationErrors,k=>(l(),c("p",null,o(k.required||k.email||k.max),1))),256))])):g("",!0)])]),_:1},8,["modelValue","title","onClosed","aria-labelledby","aria-describedby"])],64)}const Wo=E(Fo,[["render",Ko]]),Zo={name:"AddressSection",props:{profileDetails:Object,addressType:String,title:String,description:String},emits:["fetch","setAddressPrimary","deleteAddress"],data(){return{addressSectionTitleId:`address-section-title-${this.addressType}`,isEditAddress:!1,newAddressData:{label:"",name:"",email:"",phone:"",address_1:"",address_2:"",city:"",state:"",postcode:"",country:""}}},components:{DynamicIcon:U,Badge:B,AddressModal:Wo},computed:{addresses(){return this.profileDetails[`${this.addressType}_address`]||[]},sortedAddresses(){return this.addresses.sort((e,s)=>s.is_primary-e.is_primary)}},methods:{translate:n,handleAddressCommand(e){const{action:s,data:r}=e;s==="edit"?(this.isEditAddress=!0,this.newAddressData={...r},this.$refs.modalRef.handleAddNewAddressModal("edit",r)):s==="default"?this.$emit("setAddressPrimary",r):s==="remove"&&oe.confirm(n("Are you sure want to delete this address?"),n("Warning"),{customClass:"fluent-cart-customer-profile-app",confirmButtonText:n("Yes, Delete!"),cancelButtonText:n("Cancel"),cancelButtonClass:"el-button--small",confirmButtonClass:"el-button--small",type:"warning"}).then(()=>{this.$emit("deleteAddress",r)}).catch(()=>{})}}},Go=["aria-labelledby"],Jo={class:"form-left"},Qo=["id"],Xo={class:"form-desc"},ed={class:"form-right"},td=["aria-label"],sd={class:"title"},ad={class:"text"},id={class:"fct-address-action"},rd=["aria-label"],nd={key:1,class:"text-sm text-system-mid",role:"status","aria-live":"polite"};function ld(e,s,r,b,t,i){const u=h("AddressModal"),p=h("Badge"),_=h("DynamicIcon"),y=h("el-dropdown-item"),k=h("el-dropdown-menu"),f=h("el-dropdown");return l(),c("div",{class:"fct-form-container",role:"region","aria-labelledby":t.addressSectionTitleId},[a("div",Jo,[a("h3",{id:t.addressSectionTitleId,class:"form-heading"},o(r.title),9,Qo),a("p",Xo,o(r.description),1),d(u,{ref:"modalRef",modalAction:r.addressType,onFetch:s[0]||(s[0]=v=>e.$emit("fetch")),isEditAddress:t.isEditAddress,newAddressData:t.newAddressData,profileDetails:r.profileDetails},null,8,["modalAction","isEditAddress","newAddressData","profileDetails"])]),a("div",ed,[i.addresses.length?(l(),c("ul",{key:0,class:"fct-customer-address-list",role:"list","aria-label":`${r.addressType} addresses`},[(l(!0),c(T,null,V(i.sortedAddresses,v=>(l(),c("li",{class:H(`fct-customer-address-block ${v.is_primary==="1"?"default-address":""}`),key:v.id,role:"listitem"},[a("div",sd,[w(o(v.label)+" ",1),v.is_primary==="1"?(l(),M(p,{key:0,"hide-icon":!0,highContrast:"",size:"small","aria-label":i.translate("Default")},{default:m(()=>[w(o(i.translate("Default")),1)]),_:1},8,["aria-label"])):g("",!0)]),a("p",ad,o(e.getAddress(v.formatted_address,"")),1),a("div",id,[d(f,{trigger:"click",class:"fct-more-option-wrap","popper-class":"fct-dropdown",onCommand:i.handleAddressCommand},{dropdown:m(()=>[d(k,{role:"menu"},{default:m(()=>[d(y,{command:{action:"edit",data:v},role:"menuitem"},{default:m(()=>[w(o(i.translate("Edit")),1)]),_:2},1032,["command"]),v.is_primary!=="1"?(l(),c(T,{key:0},[d(y,{command:{action:"default",data:v},role:"menuitem"},{default:m(()=>[w(o(i.translate("Set as default")),1)]),_:2},1032,["command"]),d(y,{command:{action:"remove",data:v},class:"item-destructive",role:"menuitem"},{default:m(()=>[w(o(i.translate("Delete")),1)]),_:2},1032,["command"])],64)):g("",!0)]),_:2},1024)]),default:m(()=>[a("button",{class:"more-btn","aria-label":i.translate("Address options"),"aria-haspopup":"true","aria-expanded":"false"},[d(_,{name:"More","aria-hidden":"true"})],8,rd)]),_:2},1032,["onCommand"])])],2))),128))],8,td)):(l(),c("div",nd,o(i.translate("No %1$s address found, please add a new address.",r.addressType)),1))])],8,Go)}const bt=E(Zo,[["render",ld]]),od={name:"BillingAddress",props:["profileDetails"],emits:["fetch","setAddressPrimary","deleteAddress"],components:{AddressSection:bt}};function dd(e,s,r,b,t,i){const u=h("AddressSection");return l(),M(u,{profileDetails:r.profileDetails,addressType:"billing",title:e.$t("Billing Address"),description:e.$t("Provide or update the address where your billing statements and invoices will be sent."),onFetch:s[0]||(s[0]=p=>e.$emit("fetch")),onSetAddressPrimary:s[1]||(s[1]=p=>e.$emit("setAddressPrimary",p)),onDeleteAddress:s[2]||(s[2]=p=>e.$emit("deleteAddress",p))},null,8,["profileDetails","title","description"])}const cd=E(od,[["render",dd]]),ud={name:"ShippingAddress",props:["profileDetails"],emits:["fetch","setAddressPrimary","deleteAddress"],components:{AddressSection:bt}};function md(e,s,r,b,t,i){const u=h("AddressSection");return l(),M(u,{profileDetails:r.profileDetails,addressType:"shipping",title:e.$t("Shipping Address"),description:e.$t("Provide or update the address where your orders will be delivered."),onFetch:s[0]||(s[0]=p=>e.$emit("fetch")),onSetAddressPrimary:s[1]||(s[1]=p=>e.$emit("setAddressPrimary",p)),onDeleteAddress:s[2]||(s[2]=p=>e.$emit("deleteAddress",p))},null,8,["profileDetails","title","description"])}const hd=E(ud,[["render",md]]),_d={name:"UserProfile",components:{DynamicIcon:U,Badge:B,MaterialInput:O,AddressComponent:Ut,AccountDetails:Ho,BillingAddress:cd,ShippingAddress:hd},data(){return{validationErrors:{},isProfileChanged:!1,originalProfileDetails:{},loading:!1,addAddressLoading:!1,profileDetails:null,billingAddress:null,shippingAddress:null,addNewAddressModalVisible:!1,isEditAddress:!1,modalAction:"billing",newEmail:"",emailConfirmationData:{},emailChangeTokenExpiry:""}},watch:{"profileDetails.first_name":{handler(e,s){this.checkProfileChanges()}},"profileDetails.last_name":{handler(e,s){this.checkProfileChanges()}}},methods:{translate:n,updateCustomerProfile(){this.loading=!0,this.$post("customer-profile/update",{first_name:this.profileDetails.first_name,last_name:this.profileDetails.last_name,email:this.profileDetails.email}).then(e=>{this.isProfileChanged=!1,L.success(e.message),this.fetch()}).catch(e=>{L.error(e)}).finally(()=>{this.loading=!1})},setAddressPrimary(e){let s=e;s.customer_id,this.$post("customer-profile/make-primary-address",{addressId:s.id,type:s.type}).then(r=>{L.success(r),this.fetch()}).catch(r=>{L.success(r)})},deleteAddress(e){let s=e;s.customer_id,this.$post("customer-profile/delete-address",{addressId:s.id}).then(r=>{L.success(r),this.fetch()}).catch(r=>{L.error(r)})},fetch(){this.loading=!0,this.$get("customer-profile/profile").then(e=>{var s,r;this.originalProfileDetails=JSON.parse(JSON.stringify(e.data)),this.profileDetails=e==null?void 0:e.data,this.newEmail=(s=e==null?void 0:e.data)==null?void 0:s.new_email,this.emailChangeTokenExpiry=(r=e==null?void 0:e.data)==null?void 0:r.email_change_token_expiry,this.isProfileChanged=!1}).finally(()=>{this.loading=!1})},editAddress(){if(this.validateForm()){this.addAddressLoading=!0;let e={...this.newAddressData};this.$post("customer-profile/edit-address",{id:e.id,label:e.label,name:e.name,phone:e.phone,email:e.email,country:e.country,state:e.state,address_1:e.address_1,address_2:e.address_2,city:e.city,postcode:e.postcode,type:e.type}).then(s=>{L.success(s),this.fetch(),this.addAddressLoading=!1}).catch(s=>{L.error(s)}).finally(()=>{this.addNewAddressModalVisible=!1,this.resetFormDataAndValidation()})}else L.error(n("Please fill in all the required fields."))},checkProfileChanges(){if(this.profileDetails&&this.originalProfileDetails&&Object.keys(this.originalProfileDetails).length>0){const e=this.profileDetails.first_name!==this.originalProfileDetails.first_name,s=this.profileDetails.last_name!==this.originalProfileDetails.last_name;this.isProfileChanged=e||s}}},mounted(){this.fetch()}},pd={key:0,"aria-live":"polite","aria-hidden":"true",class:"border border-solid border-gray-outline rounded fct-customer-dashboard-layout-width"},fd={class:"fct-form-container"},bd={class:"form-left"},gd={class:"form-right"},yd={class:"fct-form-container"},vd={class:"form-left"},wd={class:"form-right"},kd={class:"fct-form-container"},Cd={class:"form-left"},Pd={class:"form-right"},$d={key:1,class:"fct-customer-dashboard-user-profile fct-customer-dashboard-layout-width","aria-live":"polite"},Ad={class:"fct-form-footer text-right"};function Sd(e,s,r,b,t,i){const u=h("el-skeleton-item"),p=h("el-skeleton"),_=h("AccountDetails"),y=h("BillingAddress"),k=h("ShippingAddress"),f=h("el-button");return l(),c(T,null,[t.loading?(l(),c("div",pd,[d(p,{class:"px-5 py-5",loading:t.loading,rows:2,animated:""},{template:m(()=>[a("div",fd,[a("div",bd,[d(u,{variant:"p",class:"w-[200px] mr-5"}),d(u,{variant:"p",class:"w-[240px] mr-5"})]),a("div",gd,[d(u,{variant:"p",class:"w-[200px]"}),d(u,{variant:"p",class:"w-[300px]"})])]),a("div",yd,[a("div",vd,[d(u,{variant:"p",class:"w-[200px] mr-5"}),d(u,{variant:"p",class:"w-[240px] mr-5"})]),a("div",wd,[d(u,{variant:"p",class:"w-[200px]"}),d(u,{variant:"p",class:"w-[300px]"})])]),a("div",kd,[a("div",Cd,[d(u,{variant:"p",class:"w-[200px] mr-5"}),d(u,{variant:"p",class:"w-[240px] mr-5"})]),a("div",Pd,[d(u,{variant:"p",class:"w-[200px]"}),d(u,{variant:"p",class:"w-[300px]"})])])]),_:1},8,["loading"])])):g("",!0),t.profileDetails&&!t.loading?(l(),c("div",$d,[d(_,{profileDetails:t.profileDetails},null,8,["profileDetails"]),t.profileDetails.not_a_customer?g("",!0):(l(),c(T,{key:0},[d(y,{profileDetails:t.profileDetails,onFetch:i.fetch,onSetAddressPrimary:i.setAddressPrimary,onDeleteAddress:i.deleteAddress},null,8,["profileDetails","onFetch","onSetAddressPrimary","onDeleteAddress"]),d(k,{profileDetails:t.profileDetails,onFetch:i.fetch,onSetAddressPrimary:i.setAddressPrimary,onDeleteAddress:i.deleteAddress},null,8,["profileDetails","onFetch","onSetAddressPrimary","onDeleteAddress"]),a("footer",Ad,[d(f,{type:"primary",size:"small",onClick:i.updateCustomerProfile,disabled:!t.isProfileChanged,"aria-label":i.translate("Save Profile")},{default:m(()=>[w(o(i.translate("Save Profile")),1)]),_:1},8,["onClick","disabled","aria-label"])])],64))])):g("",!0)],64)}const Md=E(_d,[["render",Sd]]),Dd={name:"SingleOrderDetails",props:{order_id:{type:[String,Number],required:!0}},watch:{order_id(){this.fetchOrder()}},components:{OrderTableLoader:K,TransactionsTable:ft,LicenseTable:de,SubscriptionTable:ht,Badge:B,DownloadsTable:ut},data(){return{orderTitleId:"order-title",order:null,loading:!0,placeholderImage:window.fluentcart_customer_profile_vars.placeholder_image,sectionParts:{}}},computed:{ArrowRight(){return dt}},methods:{orderBillingAddressUpdated(e){this.order.billing_address_text=e},getImage(e){return e.variant_image?e.variant_image:e.image?e.image:this.placeholderImage},fetchOrder(){this.$get("customer-profile/orders/"+this.order_id).then(e=>{this.order=e.order,e.section_parts&&(this.sectionParts=e.section_parts)}).catch(e=>{var s,r,b;if((s=e==null?void 0:e.data)!=null&&s.parent_order&&((b=(r=e==null?void 0:e.data)==null?void 0:r.parent_order)!=null&&b.uuid)){this.$router.push({name:"view_order",params:{order_id:e.data.parent_order.uuid}});return}this.handleError(e)}).finally(()=>{this.loading=!1})},pluralizeTranslate:J,getStatusText(e){switch(e){case"completed":return n("Completed");case"paid":return n("Paid");case"active":return n("Active");case"publish":return n("Published");case"draft":return n("Draft");case"shipped":return n("Shipped");case"success":return n("Success");case"licensed":return n("Licensed");case"succeeded":return n("Succeeded");case"failed":return n("Failed");case"error":return n("Error");case"canceled":return n("Canceled");case"expired":return n("Expired");case"partially_paid":return n("Partially Paid");case"intended":return n("Intended");case"scheduled":return n("Scheduled");case"on-hold":return n("On Hold");case"pending":return n("Pending");case"unpaid":return n("Unpaid");case"warning":return n("Warning");case"processing":return n("Processing");case"future":return n("Future");case"inactive":return n("Inactive");case"dispute":return n("Dispute");case"disabled":return n("Disabled");case"beta":return n("Beta");case"subscription":return n("Subscription");case"renewal":return n("Renewal");case"payment":return n("Payment");case"unshipped":return n("Unshipped");default:return q.headline(e)}}},mounted(){this.fetchOrder()}},Td=["aria-labelledby","aria-busy"],Ed=["aria-label"],Ld=["id"],Id={key:0},Vd={class:"fct-single-order-box",role:"region","aria-labelledby":"order-summary-title"},xd=["innerHTML"],Bd={class:"fct-single-order-body"},Nd={class:"fct-customer-dashboard-order-items","aria-labelledby":"order-summary-title"},Ud={class:"fct-order-summary-wrap"},Hd={class:"fct-order-summary-header"},Fd={id:"order-summary-title",class:"fct-order-summary-header-title"},Od=["aria-label"],qd={class:"fct-order-summary-body"},Rd={class:"fct-order-summary-items",role:"list"},zd={class:"fct-product-info-card"},jd={class:"fct-product-info-card-inner"},Yd={class:"media"},Kd=["href","aria-label"],Wd=["src","alt"],Zd={class:"product-info-content"},Gd={class:"title"},Jd=["href","aria-label"],Qd={key:0,class:"text-gray-600"},Xd={class:"variation-title"},ec={key:0,class:"product-subscription-info flex flex-col gap-1 mt-1"},tc=["innerHTML","aria-label"],sc=["aria-label"],ac={key:0,class:"text-sm"},ic={key:0,class:"fct-order-summary-order-calculation"},rc={key:0,class:"tr"},nc={key:1,class:"tr"},lc={key:2,class:"tr"},oc={key:3,class:"tr"},dc={key:4,class:"tr"},cc={key:5,class:"tr"},uc={class:"fct-order-summary-footer"},mc={class:"fct-order-summary-footer-inner"},hc=["aria-level"],_c=["innerHTML"],pc={key:0,class:"fct-single-order-box",role:"region","aria-labelledby":"subscription-title"},fc={class:"fct-single-order-header"},bc={id:"subscription-title",class:"title"},gc=["innerHTML"],yc={key:1,class:"fct-single-order-box",role:"region","aria-labelledby":"downloads-title"},vc={class:"fct-single-order-header"},wc={id:"downloads-title",class:"title"},kc=["innerHTML"],Cc={key:2,class:"fct-single-order-box",role:"region","aria-labelledby":"licenses-title"},Pc={class:"fct-single-order-header"},$c={id:"licenses-title",class:"title"},Ac=["innerHTML"],Sc={key:3,class:"fct-single-order-box",role:"region","aria-labelledby":"transactions-title"},Mc=["innerHTML"],Dc={class:"fct-single-order-header"},Tc={id:"transactions-title",class:"title"},Ec={class:"fct-customer-dashboard-table"},Lc=["innerHTML"],Ic={key:4,class:"fct-single-order-box pb-5 lg:pb-0",role:"region","aria-labelledby":"addresses-title"},Vc={id:"addresses-title",class:"sr-only"},xc={class:"fct-customer-dashboard-address mb-5 lg:mb-0","aria-labelledby":"billing-title"},Bc={id:"billing-title",class:"title"},Nc=["innerHTML"],Uc={class:"fct-customer-dashboard-address","aria-labelledby":"shipping-title"},Hc={id:"shipping-title",class:"title"},Fc=["innerHTML"],Oc=["innerHTML"],qc={key:1,"aria-live":"polite"};function Rc(e,s,r,b,t,i){const u=h("el-breadcrumb-item"),p=h("el-breadcrumb"),_=h("Badge"),y=h("SubscriptionTable"),k=h("DownloadsTable"),f=h("LicenseTable"),v=h("TransactionsTable"),C=h("el-col"),S=h("el-row"),D=h("OrderTableLoader");return l(),c("div",{class:"fct-customer-dashboard-single-order-wrap",role:"main","aria-labelledby":t.orderTitleId,"aria-busy":t.loading},[a("div",{class:"fct-customer-dashboard-breadcrumb mb-4",role:"navigation","aria-label":e.$t("Breadcrumb navigation")},[d(p,{"separator-icon":i.ArrowRight},{default:m(()=>[d(u,{to:{name:"purchase-history"}},{default:m(()=>[w(o(e.$t("Purchase History")),1)]),_:1}),d(u,{"aria-current":"page"},{default:m(()=>{var $;return[w("#"+o(($=t.order)==null?void 0:$.invoice_no),1)]}),_:1})]),_:1},8,["separator-icon"])],8,Ed),t.order?(l(),c(T,{key:0},[a("h1",{id:t.orderTitleId,class:"sr-only"},[w(o(e.$t("Order Details"))+" ",1),t.order.invoice_no?(l(),c("span",Id,"#"+o(t.order.invoice_no),1)):g("",!0)],8,Ld),a("article",Vd,[t.sectionParts.before_summary?(l(),c("div",{key:0,innerHTML:t.sectionParts.before_summary},null,8,xd)):g("",!0),a("div",Bd,[a("section",Nd,[a("div",Ud,[a("header",Hd,[a("h2",Fd,o(e.$t("Summary")),1),t.order?(l(),c("div",{key:0,"aria-label":e.$t("Order status information"),class:"fct-order-status-badges"},[d(_,{type:t.order.payment_status},{default:m(()=>[w(o(i.getStatusText(t.order.payment_status)),1)]),_:1},8,["type"]),t.order.fulfillment_type=="physical"?(l(),c(T,{key:0},[d(_,{class:"ml-2",type:t.order.status},{default:m(()=>[w(o(i.getStatusText(t.order.status)),1)]),_:1},8,["type"]),d(_,{class:"ml-2",type:t.order.shipping_status},{default:m(()=>[w(o(i.getStatusText(t.order.shipping_status)),1)]),_:1},8,["type"])],64)):g("",!0)],8,Od)):g("",!0)]),a("div",qd,[a("ul",Rd,[(l(!0),c(T,null,V(t.order.order_items,($,I)=>(l(),c("li",{key:I,class:"fct-order-summary-item",role:"listitem"},[a("div",zd,[a("div",jd,[a("div",Yd,[a("a",{target:"_blank",href:$.url,rel:"noopener noreferrer","aria-label":e.$t("View product")+" "+$.title},[a("img",{src:i.getImage($),alt:e.$t("Product image for")+" "+$.title,loading:"lazy"},null,8,Wd)],8,Kd)]),a("div",Zd,[a("div",Gd,[a("a",{target:"_blank",href:$.url,rel:"noopener noreferrer","aria-label":e.$t("View product")+" "+$.title},[$.quantity>1?(l(),c("span",Qd,o($.quantity)+" x",1)):g("",!0),w(" "+o($.post_title),1)],8,Jd)]),a("div",Xd,o($.title),1),$.meta_lines&&$.meta_lines.length>0?(l(),c("div",ec,[(l(!0),c(T,null,V($.meta_lines,P=>(l(),c("span",{class:"block leading-none text-xs",innerHTML:P.label+": "+P.value,"aria-label":P.label+": "+P.value},null,8,tc))),256))])):g("",!0)])])]),a("div",{class:"fct-order-total text-right","aria-label":e.$t("Subtotal for this item")},[w(o(e.formatNumber($.subtotal))+" ",1),$.extra_amount?(l(),c("span",ac,[s[0]||(s[0]=a("br",null,null,-1)),w(" + "+o(e.formatNumber($.extra_amount)),1)])):g("",!0)],8,sc)]))),128))]),t.order.manual_discount_total+t.order.coupon_discount_total>0||t.order.shipping_total>0||t.order.manual_discount_total+t.order.coupon_discount_total>0||t.order.tax_total>0?(l(),c("div",ic,[t.order.manual_discount_total+t.order.coupon_discount_total||t.order.subtotal>0?(l(),c("div",rc,[w(o(e.$t("Subtotal"))+" ",1),a("span",null,o(e.formatNumber(t.order.subtotal))+" "+o(parseInt(t.order.tax_behavior)==2?e.$t("(Inc. Tax)"):""),1)])):g("",!0),t.order.shipping_total>0?(l(),c("div",nc,[w(o(e.$t("Shipping"))+" ",1),a("span",null,o(e.formatNumber(t.order.shipping_total)),1)])):g("",!0),t.order.tax_total>0?(l(),c("div",lc,[w(o(e.$t("Tax"))+" "+o(t.order.tax_behavior==2?e.$t("(Included)"):e.$t("(Excluded)"))+" ",1),a("span",null,o(e.formatNumber(t.order.tax_total)),1)])):g("",!0),t.order.shipping_tax>0?(l(),c("div",oc,[w(o(e.$t("Shipping Tax"))+" "+o(t.order.tax_behavior==2?e.$t("(Included)"):e.$t("(Excluded)"))+" ",1),a("span",null,o(e.formatNumber(t.order.shipping_tax)),1)])):g("",!0),t.order.coupon_discount_total>0?(l(),c("div",dc,[w(o(e.$t("Coupon Discount"))+" ",1),a("span",null,"-"+o(e.formatNumber(t.order.coupon_discount_total)),1)])):g("",!0),t.order.manual_discount_total>0?(l(),c("div",cc,[w(o(e.$t("Upgrade Discount"))+" ",1),a("span",null,"-"+o(e.formatNumber(t.order.manual_discount_total)),1)])):g("",!0)])):g("",!0)]),a("footer",uc,[a("div",mc,[a("div",{class:"tr","aria-level":e.$t("Total amount for the order")},[w(o(e.$t("Total"))+" ",1),a("span",null,o(e.formatNumber(t.order.total_amount)),1)],8,hc)])])])])]),t.sectionParts.after_summary?(l(),c("div",{key:1,innerHTML:t.sectionParts.after_summary},null,8,_c)):g("",!0)]),t.order.subscriptions&&t.order.subscriptions.length&&t.order.payment_status!=="pending"?(l(),c("article",pc,[a("header",fc,[a("h2",bc,o(e.$t("Subscription Plan")),1)]),d(y,{hideHeader:!0,subscriptions:t.order.subscriptions},null,8,["subscriptions"]),t.sectionParts.after_subscriptions?(l(),c("div",{key:0,innerHTML:t.sectionParts.after_subscriptions},null,8,gc)):g("",!0)])):g("",!0),t.order.downloads&&t.order.downloads.length&&t.order.payment_status!=="pending"?(l(),c("article",yc,[a("header",vc,[a("h2",wc,o(i.pluralizeTranslate("Download","Downloads",t.order.downloads.length)),1)]),d(k,{"show-table-header":!1,downloads:t.order.downloads},null,8,["downloads"]),t.sectionParts.after_downloads?(l(),c("div",{key:0,innerHTML:t.sectionParts.after_downloads},null,8,kc)):g("",!0)])):g("",!0),t.order.licenses&&t.order.licenses.length?(l(),c("article",Cc,[a("header",Pc,[a("h2",$c,o(i.pluralizeTranslate("License","Licenses",t.order.licenses.length)),1)]),d(f,{licenses:t.order.licenses,is_simple:!0,showTableHeader:!1},null,8,["licenses"]),t.sectionParts.after_licenses?(l(),c("div",{key:0,innerHTML:t.sectionParts.after_licenses},null,8,Ac)):g("",!0)])):g("",!0),t.order.transactions&&t.order.transactions.length?(l(),c("article",Sc,[t.sectionParts.before_transactions?(l(),c("div",{key:0,innerHTML:t.sectionParts.before_transactions},null,8,Mc)):g("",!0),a("header",Dc,[a("h2",Tc,o(e.$t("Related Transactions")),1)]),a("div",Ec,[d(v,{transactions:t.order.transactions,"show-table-header":!0,onBillingAddressUpdated:i.orderBillingAddressUpdated},null,8,["transactions","onBillingAddressUpdated"])]),t.sectionParts.after_transactions?(l(),c("div",{key:1,innerHTML:t.sectionParts.after_transactions},null,8,Lc)):g("",!0)])):g("",!0),t.order.billing_address_text||t.order.shipping_address_text?(l(),c("article",Ic,[a("h2",Vc,o(e.$t("Order addresses")),1),d(S,{gutter:30},{default:m(()=>[d(C,{md:12,sm:24},{default:m(()=>[a("section",xc,[a("h3",Bc,o(e.$t("Billing Address")),1),a("div",{class:"text",innerHTML:t.order.billing_address_text},null,8,Nc)])]),_:1}),t.order.fulfillment_type=="physical"?(l(),M(C,{key:0,md:12,sm:24},{default:m(()=>[a("section",Uc,[a("h3",Hc,o(e.$t("Shipping Address")),1),a("div",{class:"text",innerHTML:t.order.shipping_address_text},null,8,Fc)])]),_:1})):g("",!0)]),_:1})])):g("",!0),t.sectionParts.end_of_order?(l(),c("div",{key:5,innerHTML:t.sectionParts.end_of_order},null,8,Oc)):g("",!0)],64)):t.loading?(l(),c("div",qc,[d(D,{class:"mb-4","rows-range":[1,2,3]}),d(D,{class:"mb-4","rows-range":[1,2]}),d(D,{"rows-range":[1,2,3]})])):g("",!0)],8,Td)}const zc=E(Dd,[["render",Rc]]),jc={class:"fct-customer-app"},Yc=Object.assign({name:"CustomerDashboardApp"},{__name:"App",setup(e){return(s,r)=>{const b=h("router-view");return l(),c("div",jc,[d(b)])}}});function Kc(e){e.component(G.name,G),e.component(ve.name,ve),e.component(we.name,we),e.component(ke.name,ke),e.component(pe.name,pe),e.component(Ce.name,Ce),e.component(fe.name,fe),e.component(Pe.name,Pe),e.component(be.name,be),e.component($e.name,$e),e.component(Ae.name,Ae),e.component(Se.name,Se),e.component(Me.name,Me),e.component(De.name,De),e.component(Te.name,Te),e.component(Ee.name,Ee),e.component(Le.name,Le),e.component(Ie.name,Ie),e.component(Ve.name,Ve),e.component(xe.name,xe),e.component(ge.name,ge),e.component(Be.name,Be),e.component(Ne.name,Ne),e.component(Ue.name,Ue),e.component(He.name,He),e.component(Fe.name,Fe),e.component(Oe.name,Oe),e.component(qe.name,qe),e.component(Re.name,Re),e.component(ze.name,ze),e.component(je.name,je),e.component(Ye.name,Ye),e.component(Ke.name,Ke),e.component(We.name,We),e.component(Ze.name,Ze),e.component(Ge.name,Ge),e.component(Je.name,Je),e.component(Qe.name,Qe),e.component(Xe.name,Xe),e.component(et.name,et),e.component(tt.name,tt),e.component(st.name,st),e.component(at.name,at),e.component(it.name,it),e.component(rt.name,rt),e.component(nt.name,nt),e.component(ye.name,ye),e.component(lt.name,lt),e.config.globalProperties.$notify=G,e.config.globalProperties.$confirm=oe.confirm,e.config.globalProperties.$message=Ht}const Wc=[{path:"/",name:"dashboard",component:xs,meta:{active_menu:"dashboard",title:"dashboard"}},{path:"/purchase-history",name:"purchase-history",component:na,meta:{active_menu:"purchase-history",title:"Purchase History"}},{path:"/order",component:Do,children:[{name:"view_order",path:":order_id",component:zc,props:!0,meta:{active_menu:"purchase-history",title:"View Order"}}]},{path:"/subscriptions",name:"subscriptions",component:en,meta:{active_menu:"subscriptions",title:"Subscriptions"}},{name:"view_subscription",path:"/subscription/:subscription_uuid",component:So,props:!0,meta:{active_menu:"subscriptions",title:"View Subscription"}},{path:"/downloads",name:"downloads",component:ai,meta:{active_menu:"downloads",title:"Downloads"}},{path:"/licenses",name:"licenses",component:Oa,meta:{active_menu:"licenses",title:"Licenses"}},{name:"manage_license",path:"/licenses/:license_key/view",component:br,props:!0,meta:{active_menu:"licenses",title:"Manage License"}},{name:"profile",path:"/profile",component:Md,meta:{active_menu:"profile",title:"Profile"}}],X=Vt({routes:Wc,history:xt(window.fluentcart_customer_profile_vars.app_slug)});X.afterEach(e=>{var r;const s=(r=e.meta)==null?void 0:r.active_menu;if(document.querySelectorAll(".fct-customer-navs li").forEach(b=>{b.classList.remove("active_customer_menu")}),s){const b=document.querySelector(".fct-customer-nav-item-"+s);b&&b.classList.add("active_customer_menu")}});const ae=document.querySelectorAll("[data-fluent-cart-customer-profile-app]");if(ae&&ae.length>0){const e=ae[0],s=St({});Kc(s),s.config.globalProperties.$notify=G,s.config.globalProperties.$confirm=oe.confirm,s.config.globalProperties.appVars=window.fluentcart_customer_profile_vars,s.directive("loading",qt),s.mixin({methods:{$get:j.get,$post:j.post,$put:j.put,$del:j.delete,formatNumber(t,i=!0,u=!1){if(!t&&u)return"";if(t?t=(t/100).toFixed(2):t="0.00",!i)return t;let p=window.fluentcart_customer_profile_vars.wp_locale.replace("_","-");t=new Intl.NumberFormat(p).format(t);let _=window.fluentcart_customer_profile_vars.shop.currency_position,y=window.fluentcart_customer_profile_vars.shop.currency_sign;return _==="before"?y+t:t+y},$t:n,handleError(t){let i="";typeof t=="string"?i=t:t&&t.message&&(i=t.message),i||(i="Something is wrong!"),this.$notify({type:"error",title:"Error",offset:30,message:i,dangerouslyUseHTMLString:!0,duration:1e3})},handleSuccess(t){let i="Success";typeof t=="string"?i=t:t&&t.message?i=t.message:i=convertToText(t),i||(i="Success!"),this.$notify({type:"success",title:"Success",offset:30,message:i,dangerouslyUseHTMLString:!0,duration:1e3})},registerCopyAction(){Mt(()=>{document.querySelectorAll(".copyable-content").forEach(u=>{u.addEventListener("click",function(){const p=this.textContent;navigator.clipboard&&window.isSecureContext?navigator.clipboard.writeText(p).then(()=>{}).catch(_=>{console.error("Failed to copy text: ",_),i(p)}):i(p)})});function i(u){let p=document.createElement("input");p.value=u,document.body.appendChild(p),p.select(),p.setSelectionRange(0,99999);try{document.execCommand("copy")}catch(_){console.error("Fallback: Could not copy text: ",_)}document.body.removeChild(p)}})},getAddress(t,i="billing",u=!1){if(!t)return"";let p=[];return!u&&t.name&&p.push(t.name),t.address_1&&p.push(t.address_1),t.address_2&&p.push(t.address_2),t.city&&p.push(t.city),t.state&&p.push(t.state),t.postcode&&p.push(t.postcode),t.country&&p.push(t.country),t.phone&&p.push(t.phone),p.join(", ")||"No "+i+" address provided"},readableFileSize(t){if(!t&&t!==0)return"";const i=["Bytes","KB","MB","GB","TB"],u=Math.floor(Math.log2(t)/10);return`${+(t/1024**u).toFixed(2)} ${i[u]}`},formatDate:Et}});const r=window.fluentcart_customer_profile_vars.el_strings,b=window.fluentcart_customer_profile_vars.datei18;r.el.datepicker.weeks=Object.values(b.weekdaysShort),r.el.datepicker.months=Object.values(b.monthsShort),s.use(Rt,{locale:r}),s.use(X).component("app",Yc).mount(e)}document.addEventListener("DOMContentLoaded",()=>{let e=window.fluentcart_customer_profile_vars.app_url;document.querySelectorAll("a.fct_route").forEach(s=>{s.addEventListener("click",r=>{const b=s.getAttribute("href");if(!b)return;const t=b.replace(e,"");try{if(X.resolve(t).matched.length>0)return r.preventDefault(),X.push(t),!0}catch(i){console.error("Navigation error:",i)}})})});
