import{P as U}from"./payment-loader-rBHbdlEj.js";const r=jQuery;r(()=>{const a=window.fluentcart_checkout_info;a.baseUrl;const E=a.paymentMode,M=a.orderHash;a.rest_url;const $=a==null?void 0:a.rest.nonce;a.ajaxurl;const b=a.variationId;a.order_information_url;const j=a.custom_checkout_url,d=window.fluentcart.$t;let u=r(r("form[data-fluent-cart-checkout-page-checkout-form]")[0]);const m=async _=>{_!==void 0&&_.preventDefault();const l=jQuery(".fct-loader"),i=f.getPaymentMethod(),x=window["is_"+i+"_ready"];if(i!=="offline_payment"&&!x)return console.warn("Dev Warn FCT: Payment method is not ready yet!"),window.dispatchEvent(new CustomEvent("fluent_cart_validate_checkout_"+i)),!1;const H=j,y=new URLSearchParams(window.location.search);let L=y.get("license_key")||"",Q=y.get("coupon")||"";return l.addClass("active"),await jQuery.post(H,{order_hash:M,mode:E,payment_method:i,variation_id:b,license_key:L,coupon:Q,_wpnonce:$}).then(t=>{var o;return t.actionName==="custom"?window.dispatchEvent(new CustomEvent("fluent_cart_payment_next_action_"+t.nextAction,{detail:{response:t}})):t.redirect_to?((void 0).buttonState("order_processing",d("Please wait..."),(o=t.data)==null?void 0:o.buttonState),window.location.href=t==null?void 0:t.redirect_to):(t==null?void 0:t.status)==="failed"?alert((t==null?void 0:t.message)||d("Payment failed. Please try again.")):l.removeClass("active"),t}).catch(t=>{var o,h,w,g,v,k,P,S,O,N,J,C;if(l.removeClass("active"),(h=(o=t==null?void 0:t.responseJSON)==null?void 0:o.data)!=null&&h.message)console.log((g=(w=t==null?void 0:t.responseJSON)==null?void 0:w.data)==null?void 0:g.message);else if((v=t==null?void 0:t.responseJSON)!=null&&v.message)console.log((k=t==null?void 0:t.responseJSON)==null?void 0:k.message);else if((S=(P=t==null?void 0:t.responseJSON)==null?void 0:P.data)!=null&&S.errors){const e=(N=(O=t==null?void 0:t.responseJSON)==null?void 0:O.data)==null?void 0:N.errors;let n="";for(const c in e)e.hasOwnProperty(c)&&(n+=`${c}: ${e[c]}
`);console.log(n)}else if((J=t==null?void 0:t.responseJSON)!=null&&J.errors){const e=(C=t==null?void 0:t.responseJSON)==null?void 0:C.errors;let n="";for(const c in e)e.hasOwnProperty(c)&&(n+=`${c}: ${e[c]}
`);console.log(n)}else console.log("An error occurred while processing the payment. Please try again.")})};u.on("submit",m);const f=new U({form:u[0],orderHandler:m,customPayment:!0});f.load()});
