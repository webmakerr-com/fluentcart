var I=Object.defineProperty;var V=o=>{throw TypeError(o)};var R=(o,t,e)=>t in o?I(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e;var E=(o,t,e)=>R(o,typeof t!="symbol"?t+"":t,e),b=(o,t,e)=>t.has(o)||V("Cannot "+e);var d=(o,t,e)=>(b(o,t,"read from private field"),e?e.call(o):t.get(o)),p=(o,t,e)=>t.has(o)?V("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(o):t.set(o,e),l=(o,t,e,a)=>(b(o,t,"write to private field"),a?a.call(o,e):t.set(o,e),e),f=(o,t,e)=>(b(o,t,"access private method"),e);class j{static init(){document.addEventListener("click",function(t){var g;const e=t.target.closest("[data-fluent-cart-add-to-cart-button]");if(!e||(t.preventDefault(),e.classList.contains("fct-loading")))return;e.classList.add("fct-loading");const a=e.getAttribute("data-cart-id");if(!a)return;let c=parseInt(e.getAttribute("data-quantity"),10)||1;const n=e.getAttribute("data-action-name"),u=e.getAttribute("data-error-action-name");e.setAttribute("data-quantity","1"),(g=window.fluentCartCart)==null||g.addProduct(a,c,!1,!0).then(h=>{setTimeout(()=>{e.classList.remove("fct-loading")},300),document.dispatchEvent(new Event(n))}).catch(h=>{console.log(h,"error"),e.classList.remove("fct-loading"),document.dispatchEvent(new Event(u))})})}}class H{static init(){document.addEventListener("click",function(t){const e=window.FluentCartSingleProductModal;if(!e)return;const a=t.target.closest("[data-fluent-cart-product-details-button]");if(a){t.preventDefault();const c=a.getAttribute("data-product-id");e.openModal(c,a)}})}}var m,C,M,v,r,s,U,B,N,P,O,D,$,x;const i=class i{constructor(){p(this,s);p(this,m,!1);p(this,C,window.fluentCartRestVars.rest.url);p(this,M,"/public/single-product-views");p(this,v,700);p(this,r,null);f(this,s,B).call(this),f(this,s,D).call(this),f(this,s,N).call(this)}async openModal(t,e){var S,T;const a=this;if(d(a,m))return;l(a,m,!0),e&&e.classList.add("loading");let c=document.createElement("div"),n=document.createElement("div");n.className="fluent-cart-shop-app-single-product-modal",n.setAttribute("data-fluent-cart-shop-app-single-product-modal","");const u=document.createElement("div");u.className="fluent-cart-shop-app-single-product-modal-overlay",u.setAttribute("data-fluent-cart-shop-app-single-product-modal-overlay",""),n.appendChild(u);const g=document.createElement("div");g.className="fluent-cart-shop-app-single-product-modal-body";const h=document.createElement("div");h.className="fct-cart-drawer-loader show",h.setAttribute("data-fluent-cart-cart-drawer-loader","");const k=document.createElement("div");k.className="fct-cart-drawer-loader-spin-wrap",h.appendChild(k),g.appendChild(h),n.appendChild(g),c.style.opacity="1",c.style.pointerEvents="auto",c.appendChild(n),document.body.appendChild(c),l(a,r,n);const q=await f(S=a,s,O).call(S,t);q&&(n.innerHTML=q,l(a,r,n),f(this,s,$).call(this,n,d(a,v)),f(T=a,s,P).call(T,n),window.dispatchEvent(new CustomEvent("fluentCartSingleProductModalOpened",{detail:{productId:t}}))),document.body.style.overflow="hidden"}closeModal(t){f(this,s,x).call(this,t,d(this,v),()=>{t.remove(),document.body.style.overflow="",l(this,r,null)})}};m=new WeakMap,C=new WeakMap,M=new WeakMap,v=new WeakMap,r=new WeakMap,s=new WeakSet,U=function(){const t=document.querySelector("[data-fluent-cart-shop-app-single-product-modal-close]"),e=document.querySelector(".fluent-cart-shop-app-single-product-modal-body");if(t&&e){const a=()=>{const c=e.getBoundingClientRect(),n=e.scrollTop;t.style.right=`${window.innerWidth-c.right+5}px`,t.style.top=`${c.top+5}px`,n>=100?t.classList.add("hovered"):t.classList.remove("hovered")};a(),e.addEventListener("scroll",a),window.addEventListener("resize",a),window.addEventListener("scroll",a)}},B=function(){const t=this;document.addEventListener("click",async function(e){const a=e.target.closest("[data-fluent-cart-single-product-card-view-button]");if(!a)return;a.classList.add("fct-loading");const c=a.dataset.productId;await t.openModal(c,a),a.classList.remove("fct-loading")})},N=function(){const t=this;document.addEventListener("keydown",function(e){e.key==="Escape"&&d(t,r)&&d(t,r).querySelector("[data-fluent-cart-shop-app-single-product-modal]")&&t.closeModal(d(t,r))})},P=function(t){t.querySelectorAll("[data-fluent-cart-single-product-page]").forEach(a=>{new window.FluentCartSingleProduct().init(a,0)})},O=async function(t){if(i.cachedView[t])return l(this,m,!1),i.cachedView[t];l(this,m,!0);const{request:e,controller:a}=window.fluentCartAjax.get({action:"fluent_cart_checkout_routes",fc_checkout_action:"get_product_modal_view",product_id:t},!0),n=(await e).view;i.cachedView[t]=n;const u=Object.keys(i.cachedView);return u.length>i.cacheThreshold&&delete i.cachedView[u[0]],l(this,m,!1),n},D=function(){const t=this;document.addEventListener("click",function(e){const a=document.querySelector("[data-fluent-cart-shop-app-single-product-modal-overlay]"),c=document.querySelector("[data-fluent-cart-shop-app-single-product-modal-close]"),n=e.target.closest("[data-fluent-cart-shop-app-single-product-modal]");a&&a.contains(e.target)&&t.closeModal(n.parentElement),c&&c.contains(e.target)&&t.closeModal(n.parentElement)})},$=function(t,e){t.style.opacity="0",t.style.transition=`opacity ${e}ms ease-in-out`,t.offsetHeight,t.style.opacity="1",setTimeout(()=>{t.style.pointerEvents="auto"},e)},x=function(t,e,a){t.style.transition=`opacity ${e}ms ease-in-out`,t.style.opacity="0",setTimeout(()=>{a&&a()},e)},E(i,"cachedView",{}),E(i,"cacheThreshold",10);let L=i;var y;const w=class w{static init(){return d(w,y)!==null?d(w,y):(j.init(),H.init(),l(w,y,this),this)}};y=new WeakMap,p(w,y,null);let A=w;window.addEventListener("load",function(){A.init(),window.FluentCartSingleProductModal=new L,console.log("called")});
